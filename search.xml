<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Python Project Management - poetry</title>
      <link href="/2023/02/23/python-framework-poetry/"/>
      <url>/2023/02/23/python-framework-poetry/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> Coding Language </category>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Poetry </tag>
            
            <tag> Project Management </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C++ 技巧</title>
      <link href="/2023/02/04/C-%E6%8A%80%E5%B7%A7/"/>
      <url>/2023/02/04/C-%E6%8A%80%E5%B7%A7/</url>
      
        <content type="html"><![CDATA[<h2 id="C-技巧"><a href="#C-技巧" class="headerlink" title="C++ 技巧"></a>C++ 技巧</h2><p>C++ 技巧这个话题很大， 对于练习时长不足两年半的我根本没法表述清楚，但是在日常的工作中，又会频繁得跟 C++ 打交道，这使我迫切得需要开这样一篇话题，记录并提炼出通过从书籍和日常工作中得到的知识和经验。好好利用好 C++ 这个强大的武器，使未来的工作或学习更加一帆风顺。</p><p>以下记录的，都是我在日常工作中「经常使用到的」，或者在「优化时发现能提升效率」的技巧。很可能技巧都比较简单，但是从我微不足道的经验来看，令人受益匪浅。</p><h3 id="P2-编译期-Assertions（断言）"><a href="#P2-编译期-Assertions（断言）" class="headerlink" title="P2 编译期 Assertions（断言）"></a>P2 编译期 Assertions（断言）</h3><p>随着泛型编程的大量使用，我们越来越需要更好的静态检查（static checking）以及更个性化的错误信息输出。</p><p>假使我们想要设计一个做 safe casting 的函数，也就是想要在讲一个类型转变成另一个类型时，所有的信息都能被保留。或者说，大类型不能被 cast 成小类型。</p><p>我们可以先简单设计出如下的模板函数：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">To</span>, <span class="keyword">class</span> <span class="title">From</span>&gt;</span></span><br><span class="line"><span class="function">To <span class="title">safe_reinterpret_cast</span><span class="params">(From from)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">assert</span>(<span class="built_in"><span class="keyword">sizeof</span></span>(From) &lt;= <span class="built_in"><span class="keyword">sizeof</span></span>(To));</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">reinterpret_cast</span>&lt;To&gt;(from);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>假使我们使用同样的语法调用这个函数：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> i = ...;</span><br><span class="line"><span class="keyword">char</span>* p = safe_reinterpret_cast&lt;<span class="keyword">char</span>*&gt;(i);</span><br></pre></td></tr></table></figure><p>显然，这段代码是想将 <code>int</code> 类型的数据 safe cast 成 <code>char*</code> 类型。不过这里有<strong>几个</strong>可以优化的地方：<code>assert()</code> 内部的结果其实是一个<strong>编译期常量</strong>，但是 <code>assert()</code> 函数只有在<strong>运行期</strong>才会报错，这可能会导致我们在将代码迁移到其他系统时，无法发现并定位错误。我们可以</p><ol><li><p>考虑如何将报错提前到编译期。</p></li><li><p>考虑编译期报错时如何输出有效信息。 </p></li></ol><p>Van Horn  曾经就考虑过这个问题，他依赖长度为 0 的数组是非法的原则，设计了一种编译期报错的方法：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STATIC_CHECK(expr) &#123;char unnamed[(expr) ? 1: 0]&#125;</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">To</span>, <span class="keyword">class</span> <span class="title">From</span>&gt;</span></span><br><span class="line"><span class="function">To <span class="title">safe_reinterpret_cast</span><span class="params">(From from)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">STATIC_CHECK</span>(<span class="built_in"><span class="keyword">sizeof</span></span>(From) &lt;= <span class="built_in"><span class="keyword">sizeof</span></span>(To));</span><br><span class="line">    <span class="keyword">return</span> interpret_cast&lt;To&gt;(From);</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line"><span class="keyword">void</span>* somePointer = ...;</span><br><span class="line"><span class="keyword">char</span> c = safe_reinterpret_cast&lt;<span class="keyword">char</span>&gt;(somePointer);</span><br></pre></td></tr></table></figure><p>如果系统指针比 char 要大，编译器就会报错，说我们尝试创造一个长度为 0 的数组。</p><p>不过这样问题也比较明显：错误信息太模糊了，而且很难提供可移植性的个性化错误信息。错误信息没有一定需要遵循的规则，这些规则都是由编译器决定。</p><p>更好的解决方法是去依赖一个有信息名字的模板，幸运的话，编译器会在错误信息中提到模板的名字。我们可以设计成如下情况</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">bool</span>&gt; <span class="class"><span class="keyword">struct</span> <span class="title">CompileTimeChecker</span> &#123;</span></span><br><span class="line">    <span class="built_in">CompileTimeChecker</span>(...);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">template</span>&lt;&gt; <span class="class"><span class="keyword">struct</span> <span class="title">CompileTimeChecker</span>&lt;</span><span class="literal">false</span>&gt; &#123; &#125;;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STATIC_CHECK(expr, msg) \</span></span><br><span class="line"><span class="meta">&#123;\</span></span><br><span class="line"><span class="meta">    class ERROR_##msg &#123;&#125;; \</span></span><br><span class="line"><span class="meta">    (void)sizeof(CompileTimeChecker<span class="meta-string">&lt;(expr) != 0&gt;</span>((ERROR_##msg()))); \</span></span><br><span class="line"><span class="meta">&#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">To</span>, <span class="keyword">class</span> <span class="title">From</span>&gt;</span></span><br><span class="line"><span class="function">To <span class="title">safe_reinterpret_cast</span><span class="params">(From from)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">STATIC_CHECK</span>(<span class="built_in"><span class="keyword">sizeof</span></span>(From) &lt;= <span class="built_in"><span class="keyword">sizeof</span></span>(To),</span><br><span class="line">        Destination_Type_Too_Narrow);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">reinterpret_cast</span>&lt;To&gt;(from);</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line"><span class="keyword">void</span>* somePointer = ...;</span><br><span class="line"><span class="keyword">char</span> c = safe_reinterpret_cast&lt;<span class="keyword">char</span>&gt;(somePointer);</span><br></pre></td></tr></table></figure><p>这样的话，报错信息就可能变成：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Error: Cannot convert ERROR_Destination_Type_Too_Narrow to CompileTimeChecker&lt;<span class="literal">false</span>&gt;</span><br></pre></td></tr></table></figure><h3 id="P0-模板偏特化"><a href="#P0-模板偏特化" class="headerlink" title="P0 模板偏特化"></a>P0 模板偏特化</h3><p>模板偏特化允许我们对模板可实例化集合中的一个子集进行特化。这也是在泛型编程中经常使用的技术。</p><p>下面通过一个例子去简单介绍什么是模板偏特化。</p><p>首先，我们假设有一个模板 <code>Widget</code>，它有两个类型参数，如下式：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">Window</span>, <span class="keyword">class</span> <span class="title">Controller</span>&gt;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Widget</span> &#123;</span></span><br><span class="line">    <span class="comment">// 泛型实现</span></span><br><span class="line">    ...</span><br><span class="line">&#125;；</span><br></pre></td></tr></table></figure><p>而后，我们可以对这个类进行显式的特化：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;&gt;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Widget</span>&lt;</span>ModalDialog, MyController&gt; &#123;</span><br><span class="line">    <span class="comment">// 特化实现</span></span><br><span class="line">    ...</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>在看到如上的特化定义后，无论我们在哪里定义一个类型为 <code>Widget&lt;ModalDialog, MyController&gt;</code> 的对象，编译器都会使用特化实现的版本，而对<code>Widget</code> 的其他实现，编译器则会使用泛型的实现。</p><p>然后，我们有时候想对任意的 <code>Window</code> 和 特定的 <code>Controller</code>(这里假设是 <code>MyController</code>) 进行特化实现，这时，我们就会使用到模板的偏特化：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">Window</span>&gt;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Widget</span>&lt;</span>Window, MyController&gt; &#123;</span><br><span class="line">    <span class="comment">// 模板偏特化</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>特别地，在一个类模板的偏特化中，你只会指定一部分模板参数，而保持另一部分模板参数的泛化性。当我们实例化程序中的类模板时，编译器会尝试找到最匹配的。这个匹配算法是复杂且准确的，这意味着，即使我们已经有一个 <code>Widget</code> 在任意 <code>Window</code> 和指定的 <code>MyContorller</code> 的偏特化模板，我们还可以偏特化下面的类模板，且在编译时依然能保证准确性。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">ButtonArg</span>&gt;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Widget</span>&lt;</span>Button&lt;ButtonArg&gt;, MyController&gt; &#123;</span><br><span class="line">    <span class="comment">// 进一步的模板偏特化</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这确保了我们在实例化模板时的灵活性，但需要注意一点，我们不能偏特化函数：无论是成员函数还是非成员函数：</p><ul><li><p>即使我们能完全特化一个类模板的成员函数，我们不能偏特化类成员函数（这里的为什么，等后续补充）</p></li><li><p>对命名空间级别的(非成员的)模板函数，我们也不能偏特化，但是我们可以做一个非常接近的操作，就是重载（overloading），在实际应用中，这意味着我们只能对函数的参数做细粒度的特化，而不是对返回值或内部使用类型，比如</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>, <span class="keyword">class</span> <span class="title">U</span>&gt;</span> <span class="function">T <span class="title">Fun</span><span class="params">(U obj)</span></span>; <span class="comment">// 原始模板</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">U</span>&gt;</span> <span class="keyword">void</span> Fun&lt;<span class="keyword">void</span>, U&gt;(U obj); <span class="comment">// 非法偏特化, 不能对返回值做细粒度特化</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span> <span class="function">T <span class="title">Fun</span><span class="params">(Window obj)</span></span>; <span class="comment">// 合法重载</span></span><br></pre></td></tr></table></figure></li></ul><p>对编译器编写者而言，偏特化缺乏粒度的特性，显然让生活更容易，但是对开发者来说，却有不好的影响，后面的一个工具特别是为了减少这种偏特化的限制。</p><h3 id="P1-局部类"><a href="#P1-局部类" class="headerlink" title="P1 局部类"></a>P1 局部类</h3><p>我们能在函数里定义类，比如：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Fun</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Local</span> &#123;</span></span><br><span class="line">        ... 成员变量 member variables ...</span><br><span class="line">        ... 成员函数定义 member function definitions ...</span><br><span class="line">    &#125;;</span><br><span class="line">    ... 使用 Local 这个类的代码 ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>需要注意，局部类有一些限制：</p><ol><li>不能定义静态成员变量</li><li>无法使用统一命名空间里的非静态局部变量</li></ol><p>不过，这个局部类有趣的地方是：你能在模板函数中使用他们。特别的，在模板函数中定义的局部类能使用 enclosing 函数的模板变量。</p><p>下面这个模板函数 <code>MakeAdapter</code> 目的是让一个接口适用于另一个。有了局部类的帮助，<code>MakeAdapter</code> 及时实现了一个接口。局部类存储了泛型的成员。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Interface</span> &#123;</span></span><br><span class="line"> <span class="keyword">public</span>:</span><br><span class="line">     <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Fun</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">    ...</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>, <span class="keyword">class</span> <span class="title">P</span>&gt;</span></span><br><span class="line"><span class="function">Interface* <span class="title">MakeAdapter</span><span class="params">(<span class="keyword">const</span> T&amp; obj, <span class="keyword">const</span> P&amp; arg)</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Local</span> :</span> <span class="keyword">public</span> Interface &#123;</span><br><span class="line">     <span class="keyword">public</span>:</span><br><span class="line">         <span class="built_in">Local</span>(<span class="keyword">const</span> T&amp; obj, <span class="keyword">const</span> P&amp; arg)</span><br><span class="line">            : <span class="built_in">obj_</span>(obj), <span class="built_in">arg_</span>(arg) &#123;&#125;</span><br><span class="line">        <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Fun</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            obj_.<span class="built_in">Call</span>(arg_);</span><br><span class="line">        &#125;</span><br><span class="line">     <span class="keyword">private</span>:</span><br><span class="line">        T obj_；</span><br><span class="line">        P arg_;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Local</span>(obj, arg);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>局部类有一个独特的特征：他们是 final 的。外部用户不能从一个函数内部的类继承。如果没有局部类，我们不得不在一个隔离的翻译单元中增加一个未命名的命名空间。</p><h3 id="P1-将实常数映射成类型"><a href="#P1-将实常数映射成类型" class="headerlink" title="P1 将实常数映射成类型"></a>P1 将实常数映射成类型</h3><p>有一个非常简单的模板，对许多泛型编程 idioms（习语）有用：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">int</span> v&gt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Int2Type</span> &#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">enum</span> &#123;</span>value = v&#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><code>Int2Type</code> 对输入的不同常实数会生成不同的类型，这是因为不同的模板实例化是不同的类型。另外，产生这个类型的值，会被保存在枚举成员 <code>value</code> 中</p><p>这个模板为什么被广泛应用呢？无论何时我们需要给一个常实数附以类型时，我们都可以使用它。通过这个方式，我们可以依赖编译期计算的结果，去选择不同的函数，从而可以有效得依赖一个常实数实现静态分派（static dispatch）</p><p>典型的，在如下两个情况都满足的时候，我们应该使用 <code>Int2Type</code> ：</p><ol><li><p>取决于一个编译期常数，我们会去挑选几个不同函数中的一个</p></li><li><p>我们需要在编译期做这样的分派</p></li></ol><p>对于运行期的分派，我们可以简单地使用 <code>if-else</code> 语句或者 <code>switch</code> 的语句。运行期的消耗在大多数情况下可忽略不计。但是，我们通常不这么做。（不这么做的原因不是运行期更耗时）<code>if-else</code> 语句要求两个分支都得成功编译，即使我们在编译期时就可以知道 <code>if</code> 条件的选择情况。</p><p>下面通过一个例子来解释上面这句话的意思。</p><p>假设我们正在设计一个泛型容器 <code>NiftyContainer</code>，这个容器被包含的类型模板化：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span> <span class="class"><span class="keyword">class</span> <span class="title">NiftyContainer</span> &#123;</span></span><br><span class="line">    ...</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>假使 <code>NiftyContainer</code> 容器包含了指向类型 <code>T</code> 的对象的指针。为了复制包含在容器中的对象，我们要么调用它自身的拷贝构造函数，要么调用一个为多态类型（polymorhic types）准备得虚函数 <code>Clone()</code>。至于选择哪种函数，我们可以通过一个布尔类型的模板参数获得信息。</p><p>为此，我们很容易想到以下的实现方法：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">bool</span> isPolymorphic&gt;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NiftyContainer</span> &#123;</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">DoSomething</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        T* pSomeObj = ...;</span><br><span class="line">        <span class="keyword">if</span> (isPolymorphic) &#123;</span><br><span class="line">            T* pNewObj = pSomeObj-&gt;<span class="built_in">Clone</span>();</span><br><span class="line">            <span class="comment">// ...多态算法...</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            T* pNewObj = <span class="keyword">new</span> <span class="built_in">T</span>(*pSomeObj);</span><br><span class="line">            <span class="comment">// ...非多态算法...</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;  </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>这样实现可能让编译器通不过编译。比如，多态算法要求使用 <code>Clone</code> 成员函数，如果任何类型没有定义一个这样的成员函数，<code>NiftyContainer::DoSomething</code> 将不能编译。的确我们在编译的时候已经能决定执行哪个 if 状态了，但是，编译器不会管这些，他会尝试编译两个分支，即使优化器后面会删除无用的代码。也就是说，我们可能会出现这样的情况：我们尝试调用 <code>NiftyContainer&lt;int, false&gt;</code> 的 <code>DoSomething</code> 函数，编译器却在 <code>pObj-&gt;Clone()</code> 处报错了。</p><p>另外，非多态分支的代码也可能编译失败，如果 <code>T</code> 是一个多态类型并且非多态代码分支尝试 <code>new</code> 一个 <code>T(*pObj)</code> ，这也可能导致代码编译失败：如果 <code>T</code> 禁用了拷贝构造函数或者让拷贝构造函数变成私有的。PS. 好的多态类就应该做这些考虑。</p><p>让编译器不用操心代码是否是无用，这个想法是好的，但是有更让人满意的解决方法，在使用这个简洁的解决方法的时候，我们会用到 <code>Int2Type</code>：它会根据布尔值 <code>isPolymorphic</code> 的不同，将其即时得转变成两个不同的类型，然后我们就可以利用简单的重载去使用 <code>Int2Type&lt;isPolymorhic&gt;</code> 啦。代码重构如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">bool</span> isPolymorphic&gt;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NiftyContainer</span> &#123;</span></span><br><span class="line"> <span class="keyword">private</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">DoSomething</span><span class="params">(T* pObj, Int2Type&lt;<span class="literal">true</span>&gt;)</span> </span>&#123;</span><br><span class="line">        T* pNewObj = pObj-&gt;<span class="built_in">Clone</span>();</span><br><span class="line">        <span class="comment">// ...多态算法...</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">DoSomething</span><span class="params">(T* pObj, Int2Type&lt;<span class="literal">false</span>&gt;)</span> </span>&#123;</span><br><span class="line">        T* pNewObj = <span class="keyword">new</span> <span class="built_in">T</span>(*pSomeObj);</span><br><span class="line">        <span class="comment">// ...非多态算法...</span></span><br><span class="line">    &#125;</span><br><span class="line"> <span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">DoSomething</span><span class="params">(T* pObj)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">DoSomething</span>(pObj, Int2Type&lt;isPolymorphic&gt;());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>这个重载实现了两个需要的算法，这上面的 trick 点在于，因为编译器不会编译它们不适用的模板函数，它只检查它们语法。这样，我们就在编译期实现了模板代码的分派。</p><h3 id="P1-类型到类型-Type2Type-的映射"><a href="#P1-类型到类型-Type2Type-的映射" class="headerlink" title="P1 类型到类型 Type2Type 的映射"></a>P1 类型到类型 Type2Type 的映射</h3><p>前面已经提到，我们不能对模板函数进行偏特化，但是，有时我们又需要模拟相似的功能。参考下面函数，它会通过将参数传给构造函数的方式，创建一个新的对象。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>, <span class="keyword">class</span> <span class="title">U</span>&gt;</span></span><br><span class="line"><span class="function">T* <span class="title">Create</span><span class="params">(<span class="keyword">const</span> U&amp; arg)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">T</span>(arg);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>现在假设我们的应用中有一个规则：</p><ol><li><p>类型为 <code>Widget</code> 的对象是不能碰的遗留代码，我们想要构建必须传入两个参数，第二个参数必须是一个固定值，比如 -1。</p></li><li><p>从 <code>Widget</code> 继承过来的类，不会有这个问题。</p></li></ol><p>现在的问题是：我们怎么特化 <code>Create</code> 来让它用和其他类型不同的方式处理 <code>Widget</code>? 显而易见的一种方法，是创造一个单独的<code>CreateWidget</code> 函数去解决特殊的问题。但是，你没有一个统一的接口去创建 <code>Widget</code>s 和它的继承对象，从而让 <code>Create</code> 在任何泛型代码中不好用。 </p><p>就像刚开始就提到的，我们不能偏特化一个函数，具体在这个例子中便是：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">U</span>&gt;</span></span><br><span class="line"><span class="function">Widget* <span class="title">Create</span><span class="params">(<span class="keyword">const</span> U&amp; arg)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">T</span>(arg, <span class="number">-1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>解决这一类问题仅有的工具是重载 overloading，一种办法是传一个类型为 T 的 dummy 对象：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>, <span class="keyword">class</span> <span class="title">U</span>&gt;</span></span><br><span class="line"><span class="function">T* <span class="title">Create</span><span class="params">(<span class="keyword">const</span> U&amp; arg, T <span class="comment">/* dummy */</span>)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">T</span>(arg);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">U</span>&gt;</span></span><br><span class="line"><span class="function">Widget* <span class="title">Create</span><span class="params">(<span class="keyword">const</span> U&amp; arg, Widget <span class="comment">/* dummy */</span>)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Widget</span>(arg, <span class="number">-1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这样的解决方式很容易让我们创建一个随意的复杂对象，但是我们却永远不会使用它。我们需要个更轻便的载体去将关于 <code>T</code> 的类型信息传给 <code>Create</code>，这时候我们就可以考虑使用 <code>Type2Type</code>，一个类型的代表，一个可以传递给重载函数的轻标识符。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Type2Type</span> &#123;</span></span><br><span class="line">    <span class="keyword">typedef</span> T OriginalType;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以看出 <code>Type2Type</code> 不包含任意值，但是有一个不同的类型引导实例化不同的 <code>Type2Type</code>，这正是我们想要的。有了这个工具，我们就可以轻松写下如下优化：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>, <span class="keyword">class</span> <span class="title">U</span>&gt;</span></span><br><span class="line"><span class="function">T* <span class="title">Create</span><span class="params">(<span class="keyword">const</span> U&amp; arg, Type2Type&lt;T&gt;)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">T</span>(arg);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">U</span>&gt;</span></span><br><span class="line"><span class="function">Widget* <span class="title">Create</span><span class="params">(<span class="keyword">const</span> U&amp; arg, Type2Type&lt;Widget&gt;)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Widget</span>(arg, <span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 使用 Create()</span></span><br><span class="line">String* pStr = <span class="built_in">Create</span>(<span class="string">&quot;Hello&quot;</span>, Type2Type&lt;String&gt;());</span><br><span class="line">Widget* pW = <span class="built_in">Create</span>(<span class="number">100</span>, Type2Type&lt;Widget&gt;());</span><br></pre></td></tr></table></figure><p><code>Create</code> 的第二个参数只是用来选择合理的重载，现在我们能对不同的 <code>Type2Type</code> 实例去特化 <code>Create</code>。</p><h3 id="P2-类型选择"><a href="#P2-类型选择" class="headerlink" title="P2 类型选择"></a>P2 类型选择</h3><p>有些泛型代码会根据一个布尔常数去选择两个类型中的一种。这一章就是要讨论这个的实现。</p><p>举个前面提到的例子 <code>NiftyContainer</code>，假设我们想要在底层存储中使用 <code>std::vector</code>。显然，对多态类型我们必须存储指针而非值本身，而对非多态类型，我们可能想要存储值，因为这更加方便高效。</p><p>首先是 <code>NifityContainer</code> 这个类：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">bool</span> isPolymorphic&gt;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NiftyContainer</span> &#123;</span></span><br><span class="line">    ...</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>我们需要存储要么一个 <code>vector&lt;T*&gt;</code> （<code>isPolymorphic</code> 为 <code>true</code>）要么一个 <code>vector&lt;T&gt;</code> （<code>isPolymorphic</code> 为 <code>false</code>）。总之，我们需要根据 <code>isPolymorphic</code> 的值决定定义的  <code>ValueType</code>要么是 <code>T*</code>，要么是<code>T</code>。</p><p>我们可以定义一个如下的特征类模板解决问题：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">bool</span> isPolymorphic&gt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NiftyContainerValueTraits</span> &#123;</span></span><br><span class="line">    <span class="keyword">typedef</span> T* ValueType;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NiftyContainerValueTraits</span>&lt;</span>T, <span class="literal">false</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">typedef</span> T ValueType;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">bool</span> isPolymorphic&gt;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NiftyContainer</span> &#123;</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">typedef</span> NiftyContainerValueTraits&lt;T, isPolymorphic&gt;</span><br><span class="line">        Traits;</span><br><span class="line">    <span class="keyword">typedef</span> typanme Traits::ValueType ValueType;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>这种处理问题的方式显得不必要的笨重，并且，他没法扩展，每次类型选择，我们都必须定义一个信息的特征类型模板。</p><p>库类模板 <code>Select</code> 给我们提供了一个能完美解决问题的类型选择方法。它的定义使用了模板偏特化：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">bool</span> flag, <span class="keyword">typename</span> T, <span class="keyword">typename</span> U&gt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Select</span> &#123;</span></span><br><span class="line">    <span class="keyword">typedef</span> T Result;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> U&gt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Select</span>&lt;</span><span class="literal">false</span>, T, U&gt; &#123;</span><br><span class="line">    <span class="keyword">typedef</span> U Result;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>这里解释一下这个 <code>Select</code> 怎么工作的。</p><ol><li><p>当 <code>flag</code> 为 <code>true</code> 时，编译器会使用第一个泛型定义因此 <code>Result</code> 等于 <code>T</code></p></li><li><p>当 <code>flag</code> 为 <code>false</code> 时，特化的模板被使用，因此 <code>Result</code> 等于 <code>U</code></p></li></ol><p>现在，我们就能更简单得定义 <code>NiftyContainer::ValueType</code> 了，而且也更容易扩展了</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">bool</span> isPolymorphic&gt;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NiftyContainer</span> &#123;</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">typedef</span> <span class="keyword">typename</span> Select&lt;isPolymorphic, T*, T&gt;::Result</span><br><span class="line">        ValueType;</span><br><span class="line">    ...</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="P1-在编译期检测可转化性和继承性"><a href="#P1-在编译期检测可转化性和继承性" class="headerlink" title="P1 在编译期检测可转化性和继承性"></a>P1 在编译期检测可转化性和继承性</h3><p>我们在实现模板函数和模板类时，经常会想一个问题：给定随意两种类型 <code>T</code> 和 <code>U</code> ，我们该怎么检测是否 <code>U</code> 为 <code>T</code> 的继承呢？在编译期发现这样的关系是在泛型库类实现高级优化的关键。在一个泛型函数中，如果我们能确定这个类实现了某一个特殊的接口，我们就可以根据这个信息去采用最佳算法。在编译器发现这个意味着我们不用使用 在编译期及其耗时的<code>dynamic_cast</code>。</p><p>发现继承关系依赖一个甄别可转化性的更一般化的机制。而更一般的问题是，我们要怎么检测随机的一个类型 <code>T</code> 是否支持向 <code>U</code> 的自动转化。</p><p>有一种解决方法，它会依赖 <code>sizeof</code> 的实现。<code>sizeof</code> 有着许多令人吃惊的力量：我们可以对任何表达式使用<code>sizeof</code>，不管这个表达式多么的复杂，它能返回表达式的大小，且不用拖到运行期。这意味着 <code>sizeof</code> 能意识到重载，模板实例化，转化规则等一切参与 C++ 表达式的东西。事实上，<code>sizeof</code> 背后暗含一个用来推到表达式类型的完整设施。最终，<code>sizeof</code> 会丢弃表达式并且只返回结果的大小。</p><p>检测转换能力 的想法依赖于 <code>sizeof</code> 与 重载函数的共用。我们提供一个函数的两个重载，一个接受类型，并且将其转化成 <code>U</code>，另一个接受其他任何类型。我们用一个临时的类型 <code>T</code> 去调用重载函数，而<code>T</code> 对 <code>U</code> 的可转换能力正式我们想要判断的。如果前一个调用 <code>U</code> 的函数被调用，那我们知道 <code>T</code> 能转化成<code>U</code>，如果的另一个函数被调用，那么 <code>T</code> 就不能被转化成 <code>U</code>。我们设计两个重载函数返回不同大小的类型，然后便可以使用<code>sizeof</code> 去判断了。这两个类型本身不重要，只要它们大小不同就行。</p><p>ok，解释到这里了，我们来具体实现以下它。</p><p>首先，我们创建两个不同大小的类型，显然 <code>char</code> 和 <code>long double</code> 有不同的大小，但是 C++ 标准并不保证一定不同，一个傻瓜式的定义如下</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">char</span> Small;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Big</span> &#123;</span><span class="keyword">char</span> dummy[<span class="number">2</span>]&#125;;</span><br></pre></td></tr></table></figure><p>根据定义，<code>sizeof(Small)</code> 为 1，<code>Big</code> 的大小未知，但一定大于 1，这是我们唯一能保证的东西。</p><p>下一步，我们需要两个重载函数，一个接受 <code>U</code> 并且返回一个 <code>Small</code></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Small <span class="title">Test</span><span class="params">(U)</span></span>;</span><br></pre></td></tr></table></figure><p>我们怎么写一个函数接受其他任何呢？一个模板不是解决方法，因为模板总是要求最佳匹配条件，因此掩盖可转化的类型。我们需要一个匹配，这个匹配会比自动转化更糟糕，也就是，转化只会在没有自动转化时发生。我很快看了一下施行于函数调用的转化规则，然后发现了所谓的省略符匹配规则（ellipsis match），这时最差的匹配了，也是我们正好希望的：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Big <span class="title">Test</span><span class="params">(...)</span></span>;</span><br></pre></td></tr></table></figure><p>传一个 C++ 的对象到有省略符的函数会有未定义的结果，但这不重要。事实上没有东西会真的调用这个函数，它甚至不会实现。想想 <code>sizeof</code> 实际不会衡量函数的入参。</p><p>现在，我们需要实施 <code>sizeof</code> 到 <code>Test</code> 的调用，给它传递一个 <code>T</code> 作为入参。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">bool</span> convExists = <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="built_in">Test</span>(<span class="built_in">T</span>())) == <span class="built_in"><span class="keyword">sizeof</span></span>(Small);</span><br></pre></td></tr></table></figure><p>对，<code>Test</code> 的调用得到一个默认构造对象 <code>T()</code>，然后 <code>sizeof</code> 会分离出表达式结果的大小，它要么是 <code>sizeof(Small)</code> 要么是 <code>sizeof(Big)</code>，这取决于是否编译器能发现一种转化。</p><p>有一个小问题，如果 <code>T</code> 的默认构造函数是私有的，表达式 <code>T()</code> 会在编译时失败，我们的所有努力都会没有回报，不够新云的是，有一个非常简单的解决方法，就是使用一个稻草人函数（strawman function），它返回一个 T 对象（记住，我们在处于 <code>sizeof</code> 的神奇世界中，没有表达式会被实际求值）。因此，编译器和我们都会非常满意。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">T <span class="title">MakeT</span><span class="params">()</span></span>;  <span class="comment">// 没有实现，不止不会做任何是，甚至在运行期都没有真实存在过</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">bool</span> convExists = <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="built_in">Test</span>(<span class="built_in">MakeT</span>())) == <span class="built_in"><span class="keyword">sizeof</span></span>(Small);</span><br></pre></td></tr></table></figure><p>现在我们把这个函数类的所有东西包裹在一起，隐藏类型推导的所有细节，只展现结果：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>, <span class="keyword">class</span> <span class="title">U</span>&gt;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Coversion</span> &#123;</span></span><br><span class="line">    <span class="keyword">typedef</span> <span class="keyword">char</span> Small;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Big</span> &#123;</span><span class="keyword">char</span> dummy[<span class="number">2</span>];&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> Small <span class="title">Test</span><span class="params">(U)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> Big <span class="title">Test</span><span class="params">(...)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> T <span class="title">MakeT</span><span class="params">()</span></span>;</span><br><span class="line"> <span class="keyword">public</span>:</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> &#123;</span></span><br><span class="line">        exists = <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="built_in">Test</span>(<span class="built_in">MakeT</span>())) == <span class="built_in"><span class="keyword">sizeof</span></span>(Small);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>现在，我们可以测试 <code>Coversion</code> 类模板：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line">    cout &lt;&lt; Conversion&lt;<span class="keyword">double</span>, <span class="keyword">int</span>&gt;::exists &lt;&lt; <span class="string">&#x27; &#x27;</span></span><br><span class="line">         &lt;&lt; Conversion&lt;<span class="keyword">char</span>, <span class="keyword">char</span>*&gt;::exists &lt;&lt; <span class="string">&#x27; &#x27;</span></span><br><span class="line">         &lt;&lt; Conversion&lt;<span class="keyword">size_t</span>, vector&lt;<span class="keyword">int</span>&gt;&gt;::exists &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个小程序会打印 <code>1 0 0</code>，注意虽然 <code>vector</code> 的确实现了一个构造函数，这个函数获取一个入参 <code>size_t</code>，但是这个转化测试返回 0，因为那个构造函数时 explicit 的。explicit 构造函数时没法担任转换函数的。</p><p>我们能在 <code>Coversion</code> 中增加一个常数 <code>sameType</code>，如果 <code>T</code> 和 <code>U</code> 表示同一个类型时为 <code>true</code>：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>, <span class="keyword">class</span> <span class="title">U</span>&gt;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Conversion</span> &#123;</span></span><br><span class="line">    ...同上...</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> &#123;</span>sameType = <span class="literal">false</span>&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>我们通过 <code>Conversion</code> 的一个片特护来实现 <code>sameType</code>：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Conversion</span>&lt;</span>T, T&gt;</span><br><span class="line">&#123;</span><br><span class="line"> <span class="keyword">public</span>:</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> &#123;</span>exists = <span class="number">1</span>, sameType = <span class="number">1</span>&#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>最后，有了 <code>Conversion</code> 的帮助，我们现在可以非常容易得定义继承了：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SUPERSUBCLASS(T, U) \</span></span><br><span class="line"><span class="meta">    (Conversion<span class="meta-string">&lt;const U*, const T*&gt;</span>::exists &amp;&amp; \</span></span><br><span class="line"><span class="meta">    !Conversion<span class="meta-string">&lt;const T*, const void*&gt;</span>::sameType)</span></span><br></pre></td></tr></table></figure><p>如果 <code>U</code> 是 public 继承自 <code>T</code>,  或者 <code>T</code> 和 <code>U</code> 是同一类型的，<code>SUPERSUBCLASS(T, U)</code>会传入 <code>true</code>。当 <code>SUPERSUBCLASS</code> 对 <code>const T*</code> 和 <code>const U*</code> 做可转化评估时，只有三种情况 <code>const U*</code> 能隐式转化成 <code>const T*</code>：</p><ol><li><p><code>T</code>  和 <code>U</code> 同类型</p></li><li><p><code>T</code> 是 <code>U</code> 的模糊 public 基类</p></li><li><p><code>T</code> 是 <code>void</code></p></li></ol><p>最后一种情况被第二个测试消除了。实际上，接受第一种情况作为 <code>is-a</code> 的退化情况是非常有用的，因为在实际使用中，我们经常会考虑一个类是它自己的 superclass。如果我们需要更严格的测试，可以这么写：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SUPERSUBCLASS_STRICT(T, U) \</span></span><br><span class="line"><span class="meta">    (SUPERSUBCLASS(T, U) &amp;&amp; \</span></span><br><span class="line"><span class="meta">    !Conversion<span class="meta-string">&lt;const T, const U&gt;</span>::sameType)</span></span><br></pre></td></tr></table></figure><p>为什么代码都加上<code>const</code> 修饰？因为我们不想因为 <code>const</code> 导致转型失败，如果模板代码实施了 两次 <code>const</code>，第二个 <code>const</code> 会被忽略掉，总之，保险起见，我们在 <code>SUPERSUBCLASS</code> 中都是用 <code>const</code>。</p><h3 id="P2-一个关于-type-info-的外覆类（wrapper）"><a href="#P2-一个关于-type-info-的外覆类（wrapper）" class="headerlink" title="P2 一个关于 type_info 的外覆类（wrapper）"></a>P2 一个关于 <code>type_info</code> 的外覆类（wrapper）</h3><p>标准 C++ 提供了一个类：<code>std::type_info</code> ，它能让我们在运行期调查类的类型。通常 <code>type_info</code> 会和 <code>typeid</code> 操作符并用，后者会传一个指向 <code>type_info</code> 对象的引用：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Fun</span><span class="params">(Base* pObj)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 比较两个 type_info 对象，它们分别与 *pObj 和 Derived 有关</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in"><span class="keyword">typeid</span></span>(*pObj) == <span class="built_in"><span class="keyword">typeid</span></span>(Derived)) &#123;</span><br><span class="line">        <span class="comment">// pObj 事实上指向一个 Derived 对象</span></span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>typeid</code> 操作符返回一个指向类型为 <code>type_info</code> 对象的引用。除了支持比较算法 <code>operator==</code> 和 <code>operator!=</code> 以外，<code>type_info</code>提供了额外的两个函数。</p><ul><li><p><code>name</code> 成员函数，以 <code>const char*</code> 的格式，返回一个类型的文本表达。因为没有将类名映射成字符串的标准方法，所以我们不应该期望 <code>typeid(Widget)</code> 返回 “Widget” 这样的字符串。一个比较令人满意的做法是让 <code>type_info:name</code> 对所有类型返回空字符串。</p></li><li><p><code>before</code> 成员函数，它给 <code>type_info</code> 对象带来了一种次序关系。使用 <code>type_info::before</code> ，我们能对 <code>type_info</code> 对象建立索引</p></li></ul><p>不幸的是，<code>type_info</code> 的好用功能被包装得难以使用。<code>type_info</code> 类将拷贝构造函数和拷贝赋值操作符禁用，这使得存储 <code>type_info</code> 对象变得不可能。不过我们可以存储指向 <code>type_info</code> 对象的指针。这个通过 <code>typeid</code> 返回的对象，采用了 static 的存储方式，因此我们不用担心其寿命，但我们得关注指针间的辨识。</p><p>C++ 标准不能保证每次调用 <code>typeid(int)</code> 能返回指向同一个 <code>type_info</code> 对象的引用。如此一来，我们没法比较指向 <code>type_info</code> 对象的指针了。为此，我们必须将指针存储到 <code>type_info</code> 对象中，并且通过运用 <code>type_info::operator==</code> 到解引用的方式，进行指针的比较。</p><p>如果我们想要对 <code>type_info</code> 对象进行排序，我们事实上必须存储指向 <code>type_info</code> 的指针，并且这次我们必须使用 <code>before</code> 这个成员函数。这样一来，如果我们想要使用 STL 的有序容器，必须写一个小的仿函数 <code>functor</code> 并处理指针。</p><p>这些笨拙到足以让我们委派一个关于 <code>type_info</code> 的外覆类来存储指向一个 <code>type_info</code> 的指针，并且，这个外覆类还需要提供：</p><ul><li><p>所有 <code>type_info</code> 的成员函数</p></li><li><p>value 的语义（与 reference 相对），即 public 的拷贝构造函数和拷贝赋值操作符</p></li><li><p>定义 <code>operator&lt;</code> 和 <code>operator==</code> 来保证比较的无暇</p></li></ul><p>Loki 定义了一个外覆类 <code>TypeInfo</code>，它实现了一个与 <code>type_info</code> 有关的，非常方便的外覆类，其大纲如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TypeInfo</span> &#123;</span></span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">TypeInfo</span>();</span><br><span class="line">    <span class="built_in">TypeInfo</span>(<span class="keyword">const</span> std::type_info&amp;);</span><br><span class="line">    <span class="built_in">TypeInfo</span>(<span class="keyword">const</span> TypeInfo&amp;);</span><br><span class="line">    TypeInfo&amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> TypeInfo&amp;);</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">before</span><span class="params">(<span class="keyword">const</span> TypeInfo&amp;)</span> <span class="keyword">const</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">const</span> <span class="keyword">char</span>* <span class="title">name</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line"> <span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">const</span> std::type_info* pInfo_;  </span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 比较操作符</span></span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span>==(<span class="keyword">const</span> TypeInfo&amp;, <span class="keyword">const</span> TypeInfo&amp;);</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span>!=(<span class="keyword">const</span> TypeInfo&amp;, <span class="keyword">const</span> TypeInfo&amp;);</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> TypeInfo&amp;, <span class="keyword">const</span> TypeInfo&amp;);</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span>&gt;(<span class="keyword">const</span> TypeInfo&amp;, <span class="keyword">const</span> TypeInfo&amp;);</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span>&lt;=(<span class="keyword">const</span> TypeInfo&amp;, <span class="keyword">const</span> TypeInfo&amp;);</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span>&gt;=(<span class="keyword">const</span> TypeInfo&amp;, <span class="keyword">const</span> TypeInfo&amp;);</span><br></pre></td></tr></table></figure><p>由于其转换构造函数接受一个 <code>std::type_info</code> 的入参，我们能直接比较类型为 <code>TypeInfo</code> 和 <code>std::type_info</code> 的对象，如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Fun</span><span class="params">(Base* pObj)</span> </span>&#123;</span><br><span class="line">    TypeInfo info = <span class="built_in"><span class="keyword">typeid</span></span>(Derived);</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in"><span class="keyword">typeid</span></span>(*pObj) == info) &#123;</span><br><span class="line">        <span class="comment">// pBase 事实上指向一个 Derived 对象</span></span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>拷贝和比较 <code>TypeInfo</code> 对象在许多情况下都非常重要。</p><h3 id="P2-NullType-和-EmptyType"><a href="#P2-NullType-和-EmptyType" class="headerlink" title="P2 NullType 和 EmptyType"></a>P2 <code>NullType</code> 和 <code>EmptyType</code></h3><p>Loki 定义了两个非常简单的类型: <code>NullType</code> 和 <code>EmptyType</code>，我们能在类型计算中使用它们去编辑边界 case。</p><p><code>NullType</code> 是一个用于作为类型的空标记（null marker）的类：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NullType</span> &#123;</span>&#125;;</span><br></pre></td></tr></table></figure><p>我们通常不创造类型为 <code>NullType</code> 的对象，它只被使用来暗示”我的类型不被人感兴趣”（一般是用作模板特化的终止，有点类似于 <code>enable_if</code> 的使用）。</p><p>而第二个 helper 类型时 <code>EmptyType</code>，它的定义是：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">EmptyType</span> &#123;</span>&#125;;</span><br></pre></td></tr></table></figure><p><code>EmptyType</code> 是一个可被继承的合法类型，且我们可以传递 <code>EmptyType</code> 的对象。同门可以使用这个类型作为模板的默认类型。</p><h3 id="P0-Type-Traits"><a href="#P0-Type-Traits" class="headerlink" title="P0 Type Traits"></a>P0 Type Traits</h3><p>Traits 是一种泛型编程技巧，它允许在编译期做一些基于类型的决策，很像我们想要在运行期基于类做的决策。通过加上这个可以解决许多软件工程难题的间接层，traits 能让我们在「类型确定」以外的地方做类型相关的决策。这可以让最终的代码更简洁，更可读，并且更好维护。</p><p>通常，当我们的泛型程序需要的时候，我们要写自己的 trait 模板和类。可是，有些 traits，可被用于任何类型，它们可以帮助我们根据类别特性去更好地裁剪模板代码。</p><p>比如，设想一下，我们要是想实现一个拷贝算法：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> InIt, <span class="keyword">typename</span> OutIt&gt;</span><br><span class="line"><span class="function">OutIt <span class="title">Copy</span><span class="params">(InIt first, Init last, OutIt result)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(; first != last; ++first, ++result) &#123;</span><br><span class="line">        *result = *first;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>理论上，我们不必实现这样的算法，因为它与 <code>std::copy</code> 功能重复，但我们可能想要对某些特殊的类型特化我们的拷贝链路。</p><p>假设我们为一个多处理器机器开发代码，这台机器有一个非常快的 <code>BitBlast</code> 原生函数，并且我们也想尽可能充分利用好这个原生函数。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Prototype of BitBlast in &quot;SIMD_Primitives.h&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BitBlast</span><span class="params">(<span class="keyword">const</span> <span class="keyword">void</span>* src, <span class="keyword">void</span>* dest, <span class="keyword">size_t</span> bytes)</span></span>;</span><br></pre></td></tr></table></figure><p>当然 <code>BitBlast</code> 这能在拷贝原生类型和简单的旧数据结构时使用。我们不能对一个有 nontrival 拷贝构造函数的类型使用 <code>BitBlast</code>。然后，我们想要实现 <code>Copy</code>  函数，在可能的时候，它可以利用好 <code>BitBlast</code>, 而对于一些精巧类型，该函数会退化到使用更广泛，保守的算法。这样， <code>Copy</code> 操作符在原生类型的范围内就会自动的跑的更快了。</p><p>为了实现这个效果，我们需要对类型做两个测试：</p><ol><li><p><code>InIt</code> 和 <code>OutIt</code> 是通常的指针么？（相比更 fancy 的迭代器类型而言）</p></li><li><p><code>InIt</code> 和 <code>OutIt</code> 指针指向的类型允许 bitwise 的拷贝么？</p></li></ol><p>如果我们能在编译器找到这些问题的答案，并且这两个答案都是 yes，我们就可以使用 <code>BitBlast</code>。否则，我们必须依赖最通常的 <code>for</code> 循环。</p><p>而 Type Traits 就能帮忙解决这个问题。</p><h4 id="实现指针-traits"><a href="#实现指针-traits" class="headerlink" title="实现指针 traits"></a>实现指针 traits</h4><p>Loki 定义了一个类模板 <code>TypeTraits</code> ，它收集了一些列泛型类型的 Traits。<code>TypeTraits</code> 使用内部模板特化，并且将结果暴露出来。</p><p>大部分类型 traits 的实现依赖完全特化或者偏特化，比如，下面的代码决定是否一个类型 <code>T</code> 是否是一个指针：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TypeTraits</span> &#123;</span></span><br><span class="line"> <span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">U</span>&gt;</span> <span class="class"><span class="keyword">struct</span> <span class="title">PointerTraits</span> &#123;</span></span><br><span class="line">        <span class="class"><span class="keyword">enum</span> &#123;</span> result = <span class="literal">false</span> &#125;;</span><br><span class="line">        <span class="keyword">typedef</span> NullType PointeeType;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">U</span>&gt;</span> <span class="class"><span class="keyword">struct</span> <span class="title">PointerTraits</span>&lt;</span>U*&gt; &#123;</span><br><span class="line">        <span class="class"><span class="keyword">enum</span> &#123;</span> result = <span class="literal">true</span> &#125;;</span><br><span class="line">        <span class="keyword">typedef</span> U PointeeType;</span><br><span class="line">    &#125;;</span><br><span class="line"> <span class="keyword">public</span>:</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> &#123;</span> isPointer = PointerTraits&lt;T&gt;::result &#125;;</span><br><span class="line">    <span class="keyword">typedef</span> PointerTraits&lt;T&gt;::PointeeType PointeeType;</span><br><span class="line">    ...</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>第一个定义引入了 <code>PointerTraits</code> 类模板，他表示 <code>T</code> 不是一个指针，并且所谓的被指类型不能被运用。（<code>NullType</code> 是一个在不被运用的情况的占位符行别）</p><p>第二个定义则是介绍了一种 <code>PointerTraits</code> 的偏特化，是一个可以匹配任何指针类型的特化体。对于指向任意东西的指针，这个特化都会被认为是一个比 「针对任何指针类型的泛型模板」更加合适的候选。总之，如果面对指针，则该特化体运行，<code>result</code> 被赋值为 <code>true</code>，而 <code>PointeeType</code> 被合理得定义。</p><p>现在我们可以观察一下 <code>std::vector::iterator</code> 的实现，它是一个简谱的指针呢，还是一个精巧类型？</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">bool</span> IterIsPtr = TypeTraits&lt;vector&lt;<span class="keyword">int</span>&gt;::iterator&gt;::isPointer；</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;vector&lt;int&gt;::iterator is &quot;</span> &lt;&lt; iterIsPtr ? <span class="string">&quot;fast&quot;</span> : <span class="string">&quot;smart&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>相似的，<code>TypeTraits</code> 实现一个 <code>isReference</code> 常数和一个 <code>ReferenceType</code> 类型定义。对于一个引用类型 <code>T</code> ，<code>ReferencedType</code> 是一个 <code>T</code> 指向的类型，如果 <code>T</code> 是一个直接的类型（即非引用），<code>ReferenceType</code> 是 T 自己。</p><p>检测指向成员的指针会有一些不同，需要的特化体如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TypeTraits</span> &#123;</span></span><br><span class="line"> <span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">U</span>&gt;</span> <span class="class"><span class="keyword">struct</span> <span class="title">PToMTraits</span> &#123;</span></span><br><span class="line">        <span class="class"><span class="keyword">enum</span> &#123;</span> result = <span class="literal">false</span> &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">U</span>, <span class="keyword">class</span> <span class="title">V</span>&gt;</span> <span class="class"><span class="keyword">struct</span> <span class="title">PToMTraits</span>&lt;</span>U V::*&gt; &#123;</span><br><span class="line">        <span class="class"><span class="keyword">enum</span> &#123;</span> result = <span class="literal">true</span> &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line"> <span class="keyword">public</span>:</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> &#123;</span> isMemberPointer = PToMTraits&lt;T&gt;::result &#125;;</span><br><span class="line">    ...</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="检测基础类型"><a href="#检测基础类型" class="headerlink" title="检测基础类型"></a>检测基础类型</h4><p><code>TypeTraits&lt;T&gt;</code> 实现了一个 <code>isStdFundamental</code> 编译期常数，这个常数会表明 <code>T</code> 是否是一个 C++ 标准里的基础类型。C++ 标准的基础类型包含类型 <code>type</code> 和所有数字类型，即浮点类型和整型。<code>TypeTraits</code> 定义了一堆常数 用来展现已知类型属于哪种类别的。</p><p>可以简单提一下 <code>typelists</code>，其让检测「是否一个类型属于一系列已知类型」变得简单。目前，我们所需要了解的是一下表达：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TL::IndexOf&lt;T, <span class="built_in">TYPELIST_nn</span>(comman-separated list of types)&gt;::value</span><br></pre></td></tr></table></figure><p>其中，nn 是类型列表中类型的个数，上面的表达式会返回 T 在列表中的位置（以零为 base），如果 T 不再列表中，就返回 -1。比如，当且晋档 T 是一个有符号整型时，表达式</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TL::IndexOf&lt;T,<span class="built_in">TYPELIST_4</span>(<span class="keyword">signed</span> <span class="keyword">char</span>, <span class="keyword">short</span> <span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">long</span> <span class="keyword">int</span>)&gt;::value</span><br></pre></td></tr></table></figure><p>会大于等于 0 。</p><p>针对基本类型， <code>TypeTraits</code> 有如下部分定义</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TypeTraits</span> &#123;</span></span><br><span class="line">    ... as above ...</span><br><span class="line"> <span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">typedef</span> <span class="title">TYPELIST_4</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span>, <span class="keyword">unsigned</span> <span class="keyword">short</span> <span class="keyword">int</span>, <span class="keyword">unsigned</span> in, <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">int</span>)</span> UnsignedInts</span>;</span><br><span class="line">    <span class="function"><span class="keyword">typedef</span> <span class="title">TYPELIST_4</span><span class="params">(<span class="keyword">signed</span> <span class="keyword">char</span>, <span class="keyword">short</span> <span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">long</span> <span class="keyword">int</span>)</span> SignedInts</span>;</span><br><span class="line">    <span class="function"><span class="keyword">typedef</span> <span class="title">TYPELIST_3</span><span class="params">(<span class="keyword">float</span>, <span class="keyword">double</span>, <span class="keyword">long</span> <span class="keyword">double</span>)</span> Floats</span>;</span><br><span class="line">    <span class="function"><span class="keyword">typedef</span> <span class="title">TYPELIST_3</span><span class="params">(<span class="keyword">bool</span>, <span class="keyword">char</span>, <span class="keyword">wchar_t</span>)</span> OtherInts</span>;</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> &#123;</span> isStdUnsignedInt = TL::IndexOf&lt;T, UnsignedInts&gt;::value &gt;= <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> &#123;</span> isStdsignedInt = TL::IndexOf&lt;T, SignedInts&gt;::value &gt;= <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> &#123;</span> isStdIntegral == isStdUnsignedInt || isStdSignedInt ||</span><br><span class="line">        TL::IndexOf&lt;T, OtherInts&gt;::value &gt;= <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> &#123;</span> isStdFloat = TL::IndexOf&lt;T, Floats&gt;::value &gt;= <span class="number">0</span> &#125;; </span><br><span class="line">    <span class="class"><span class="keyword">enum</span> &#123;</span> isStdArith = isStdIntegral || isStdFloat &#125;;</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> &#123;</span> isStdFundamental = isStdArith || isStdFloat ||</span><br><span class="line">          Conversion&lt;T, <span class="keyword">void</span>&gt;::sameType &#125;;</span><br><span class="line">    ...</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>使用类型列表和 <code>TL::IndexOf</code> 给了我们快速推测类型信息的能力，因此我们不用写一个模板特化体多次。</p><p>检测基础类型的真实实现更加复杂，允许更多厂家自行扩展类型（比如 <code>int64</code> 和 <code>long long</code>）</p><h4 id="优化的参数类型"><a href="#优化的参数类型" class="headerlink" title="优化的参数类型"></a>优化的参数类型</h4><p>在模板代码，我们优势需要回答如下问题。已知一个随意的类型 <code>T</code>，用什么办法传递和接收类型 <code>T</code> 的对象作为函数的参数最为高效？通常，最有效地方式是：当对象时精细类型时使用 by reference，而对纯量类型时使用 by value。对于精细类型，我们可以避免额外的临时开销（空间开销 + 时间开销），而对纯量类型，我们避免了使用引用的不直接性（时间开销）。</p><p>需要认真对待的一个细节是：C++  不允许指向引用的引用，因此，如果 <code>T</code> 已经是一个引用，我们不能在它的基础上加一层引用。</p><p>基于大量对函数进行参数优化的分析，我们设计了如下的算法。假设我们正在处理的参数类型为 <code>ParameterType</code>。</p><blockquote><p>如果 <code>T</code> 是某个类型的引用，<code>ParameterType</code> 和 <code>T</code> 一样，保持不变。因为引用的引用不被允许。</p><p>反之，</p><pre><code>如果 `T` 是一个纯量类型 `int`，`float` 等， `ParameterType` 是 `T`。因为基础类型最好通过值传递。如果 `ParameterType` 是 `T` 的一个常量引用 `const T&amp;`，通常，非基础类型最好以引用传递。</code></pre></blockquote><p>这个算法的一个重要成就是：它避免了对引用进行引用的错误。比如，如果我们结合 <code>bind2nd</code> 与 <code>mem_fun</code> 标准库函数，这种错误会出现。</p><p>实现 <code>TypeTraits::ParameterType</code> 非常容易，只要使用我们已经掌握的技巧以及之前定义的 traits - <code>ReferencedType</code> 和 <code>isPrimitive</code> 。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TypeTraits</span> &#123;</span></span><br><span class="line">    ... as above ...</span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">      typdef Select&lt;isStdArith || isPointer || isMemberPointer, T, ReferencedType&amp;&gt;::Result ParameterType;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>不幸的是，这个方案如果遇到「以值传递枚举类型时」会失败，因为没有已知的办法去决定是否一个类型是一个枚举类型。</p><h4 id="去除-strip-装饰词"><a href="#去除-strip-装饰词" class="headerlink" title="去除 strip 装饰词"></a>去除 strip 装饰词</h4><p>已知一个类型 <code>T</code>，我们很容易借助 <code>const T</code> 取得常数版兄弟。但是，做其相反的操作会有点困难。同样的，优势我们可能想要去掉 <code>volatile</code> 这类修饰词 qualifier。</p><p>举个例子，我们考虑构建一个智能指针，对染我们想要允许用户创建指向 <code>const</code> 对象的智能指针，比如 <code>SmartPtr&lt;const Widget&gt;</code>，我们依然需要在内部改变指针，使其指向 <code>Widget</code>。因此，在 <code>SmartPtr</code> 内部，我们需要从 <code>const Widget</code> 里获取到 <code>Widget</code>。</p><p>实现一个 <code>const</code> 去除器比较简单，我们需要再次使用到模板的偏特化:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TypeTraits</span> &#123;</span></span><br><span class="line">    ... as above ...</span><br><span class="line"> <span class="keyword">private</span>:</span><br><span class="line">     <span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">U</span>&gt;</span> <span class="class"><span class="keyword">struct</span> <span class="title">UnConst</span> &#123;</span></span><br><span class="line">        <span class="keyword">typedef</span> U Result;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">U</span>&gt;</span> <span class="class"><span class="keyword">struct</span> <span class="title">UnConst</span>&lt;</span><span class="keyword">const</span> U&gt; &#123;</span><br><span class="line">        <span class="keyword">typedef</span> U Result;</span><br><span class="line">    &#125;;</span><br><span class="line"> <span class="keyword">public</span>:</span><br><span class="line">     <span class="keyword">typedef</span> UnConst&lt;T&gt;::Result NonConstType;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="使用-TypeTraits"><a href="#使用-TypeTraits" class="headerlink" title="使用 TypeTraits"></a>使用 <code>TypeTraits</code></h4><p><code>TypeTraits</code> 能帮我们做许多有趣的事情。比如：我们可以通过前面这章的技巧来实现 Copy 函数，它会使用 <code>BitBlast</code> （和前面章节提到的一样）；我们可以使用 <code>TypeTraits</code> 去辨别两个迭代器的类别信息，并以 <code>Int2Type</code> 模板去分派 Copy 去调用 <code>BitBlast</code> 还是一个典型的 Copy 函数</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">CopyAlgoSelector</span> &#123;</span> Conservative, Fast &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Conservative routine-works for any type</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> InIt, <span class="keyword">typename</span> OutIt&gt;</span><br><span class="line"><span class="function">OutIt <span class="title">CopyImpl</span><span class="params">(InIt first, InIt last, OutIt result,</span></span></span><br><span class="line"><span class="params"><span class="function">   Int2Type&lt;Conservative&gt;)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (; first != last; ++first, ++result) </span><br><span class="line">        *result = *first;</span><br><span class="line">       <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Fast routine-works only for pointers to raw data template &lt;typename InIt, typename OutIt&gt;</span></span><br><span class="line"><span class="function">OutIt <span class="title">CopyImpl</span><span class="params">(InIt first, InIt last, OutIt result,</span></span></span><br><span class="line"><span class="params"><span class="function">   Int2Type&lt;Fast&gt;)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">size_t</span> n = last-first;</span><br><span class="line">    <span class="built_in">BitBlast</span>(first, result, n * <span class="built_in"><span class="keyword">sizeof</span></span>(*first)); </span><br><span class="line">    <span class="keyword">return</span> result + n;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> InIt, <span class="keyword">typename</span> OutIt&gt;</span><br><span class="line"><span class="function">OutIt <span class="title">Copy</span><span class="params">(InIt first, InIt last, OutIt result)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">typedef</span> TypeTraits&lt;InIt&gt;::PointeeType SrcPointee; </span><br><span class="line">    <span class="keyword">typedef</span> TypeTraits&lt;OutIt&gt;::PointeeType DestPointee; </span><br><span class="line">    <span class="class"><span class="keyword">enum</span> &#123;</span> copyAlgo =</span><br><span class="line">        TypeTraits&lt;InIt&gt;::isPointer &amp;&amp; </span><br><span class="line">        TypeTraits&lt;OutIt&gt;::isPointer &amp;&amp; </span><br><span class="line">        TypeTraits&lt;SrcPointee&gt;::isStdFundamental &amp;&amp; </span><br><span class="line">        TypeTraits&lt;DestPointee&gt;::isStdFundamental &amp;&amp; </span><br><span class="line">        <span class="built_in"><span class="keyword">sizeof</span></span>(SrcPointee) == <span class="built_in"><span class="keyword">sizeof</span></span>(DestPointee) ? Fast :</span><br><span class="line">                Conservative &#125;;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">CopyImpl</span>(first, last, result, Int2Type&lt;copyAlgo&gt;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>虽然 Copy 本身没做多少事，有趣的是函数内部的部分，枚举值 <code>copyAlgo</code> 用来选择哪一种实现。逻辑如下：如果两个迭代器是指针，如果两个指向的类型都是基础的，或者如果两个指向的类型 size 相同，那么我们可以使用 <code>BitBlast</code> 。最后一种情况是一种有趣的变形，如果我们这么做：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>* p1 = ...;</span><br><span class="line"><span class="keyword">int</span>* p2 = ...;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span>* p3 = ...;</span><br><span class="line"><span class="built_in">Copy</span>(p1, p2, p3);</span><br></pre></td></tr></table></figure><p>这时 Copy  会也应该调用快速版本，即使源类型和目标类型不同。</p><p><code>Copy</code> 的缺点是它没法加速所有可以加速的东西。比如，我们可能有一个 C 结构，它内部只包含了基本类型数据，即所谓的 <em>plain old data</em> ，或者 POD 结构。C++ 标准允许 POD 结构的按位拷贝，但是 Copy 函数不能检测它是 POD，所以它会使用运行慢的版本。这里我们不但需要依赖 <code>TypeTraits</code>，也需要依赖一些传统的 traits。比如：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="class"><span class="keyword">struct</span> <span class="title">SupportsBitwiseCopy</span> &#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">enum</span> &#123;</span> result = TypeTraits&lt;T&gt;::isStdFundamental &#125;; </span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> InIt, <span class="keyword">typename</span> OutIt&gt;</span><br><span class="line"><span class="function">OutIt <span class="title">Copy</span><span class="params">(InIt first, InIt last, OutIt result,</span></span></span><br><span class="line"><span class="params"><span class="function">   Int2Type&lt;<span class="literal">true</span>&gt;)</span></span>&#123;</span><br><span class="line">    <span class="keyword">typedef</span> TypeTraits&lt;InIt&gt;::PointeeType SrcPointee; </span><br><span class="line">    <span class="keyword">typedef</span> TypeTraits&lt;OutIt&gt;::PointeeType DestPointee; </span><br><span class="line">    <span class="class"><span class="keyword">enum</span> &#123;</span> useBitBlast =</span><br><span class="line">        TypeTraits&lt;InIt&gt;::isPointer &amp;&amp; </span><br><span class="line">        TypeTraits&lt;OutIt&gt;::isPointer &amp;&amp; </span><br><span class="line">        SupportsBitwiseCopy&lt;SrcPointee&gt;::result &amp;&amp; </span><br><span class="line">        SupportsBitwiseCopy&lt;DestPointee&gt;::result &amp;&amp; </span><br><span class="line">        <span class="built_in"><span class="keyword">sizeof</span></span>(SrcPointee) == <span class="built_in"><span class="keyword">sizeof</span></span>(DestPointee) &#125;;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">CopyImpl</span>(first, last, Int2Type&lt;useBitBlast&gt;); &#125;</span><br></pre></td></tr></table></figure><p>现在，想要接触 POD 类型无法使用 <code>BitBlast</code> 的束缚，我们只需要特化 <code>SupportBitwiseCopy</code> 并放进去一个 <code>true</code>;</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;&gt; <span class="class"><span class="keyword">struct</span> <span class="title">SupportsBitwiseCopy</span>&lt;</span>MyType&gt; &#123;</span><br><span class="line">  <span class="class"><span class="keyword">enum</span> &#123;</span> result = <span class="literal">true</span> &#125;;</span><br><span class="line">&#125;；</span><br></pre></td></tr></table></figure><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li>[The C++ in-depth series] Alexandrescu, Andrei_Meyers, Scott_Vlissides, John - Modern C++ design_ generic programming and design patterns applied (2001_2011, Addison-Wesley Professional) </li><li><a href="https://www.cnblogs.com/chmm/p/7469618.html">C++之局部类</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Coding Language </category>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
            <tag> Coding Technique </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Bazel WORKSPACE 学习</title>
      <link href="/2022/09/12/Build-Bazel-WORKSPACE-%E5%AD%A6%E4%B9%A0/"/>
      <url>/2022/09/12/Build-Bazel-WORKSPACE-%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h2 id="场景-I"><a href="#场景-I" class="headerlink" title="场景 I"></a>场景 I</h2><h3 id="new-local-repository-使用"><a href="#new-local-repository-使用" class="headerlink" title="new_local_repository 使用"></a><code>new_local_repository</code> 使用</h3><p>在引入第三方库 openssl 时，我们在 <code>WORKSPACE</code> (<code>~/bazel-workspace</code>) 中通过加入 <code>new_local_repository</code> 的方式引入库。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">new_local_repository(</span><br><span class="line">    name = &quot;openssl&quot;,</span><br><span class="line">    path = &quot;/usr&quot;,</span><br><span class="line">    build_file = &quot;depBUILD/openssl.BUILD&quot;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>首先看看这个 <code>new_local_repository</code> <a href="https://docs.bazel.build/versions/main/be/workspace.html#new_local_repository:~:text=use%20piano.jar.-,Arguments,-Attributes">参数</a>的介绍：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">new_local_repository(name, build_file, build_file_content, path, repo_mapping, workspace_file, workspace_file_content)</span><br></pre></td></tr></table></figure><p>该函数允许一个本地目录被变成 bazel 的仓库，这意味着现在的仓库能定义和使用文件系统任何地方的 target。</p><p>这个规则通过创建一个 <code>WORKSPACE</code>文件和「包含到<code>BUILD</code>文件和路径的 symlinks」的子目录，最终创建一个 Bazel 仓库。对已经包含一个 <code>WORKSPACE</code>  文件和 <code>BUILD</code> 文件的目录，我们可以直接使用 <code>local_repository</code>规则。</p><p>针对这里的情况，我们会创造一个 <code>@openssl</code> 的库，这个库与符号链接<code>symlink</code> 到 /usr 路径。我们的 Targets 可以通过加诸如<code>@openssl:crypto</code> 到目标依赖 (target’s dependencies) 的方式依赖这个库。</p><p>参数 <code>build_file</code> 是相对于主仓库的路径或绝对路径。该路径的 <code>BUILD</code> 文件 (<code>~/bazel-workspace/depBUILD/openssl.BUILD</code>) 为：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">package(</span><br><span class="line">    default_visibility=[&quot;//visibility:public&quot;]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">config_setting(</span><br><span class="line">    name = &quot;macos&quot;,</span><br><span class="line">    values = &#123;</span><br><span class="line">        &quot;cpu&quot;: &quot;darwin&quot;,</span><br><span class="line">    &#125;,</span><br><span class="line">    visibility = [&quot;//visibility:private&quot;],</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">cc_library(</span><br><span class="line">    name = &quot;crypto&quot;,</span><br><span class="line">    srcs = select(&#123;</span><br><span class="line">        &quot;:macos&quot;: [&quot;lib/libcrypto.dylib&quot;],</span><br><span class="line">        &quot;//conditions:default&quot;: []</span><br><span class="line">    &#125;),</span><br><span class="line">    linkopts = select(&#123;</span><br><span class="line">        &quot;:macos&quot; : [],</span><br><span class="line">        &quot;//conditions:default&quot;: [&quot;-lcrypto&quot;],</span><br><span class="line">    &#125;),</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">cc_library(</span><br><span class="line">    name = &quot;ssl&quot;,</span><br><span class="line">    hdrs = select(&#123;</span><br><span class="line">        &quot;:macos&quot;: glob([&quot;include/openssl/*.h&quot;]),</span><br><span class="line">        &quot;//conditions:default&quot;: []</span><br><span class="line">    &#125;),</span><br><span class="line">    srcs = select (&#123;</span><br><span class="line">        &quot;:macos&quot;: [&quot;lib/libssl.dylib&quot;],</span><br><span class="line">        &quot;//conditions:default&quot;: []</span><br><span class="line">    &#125;),</span><br><span class="line">    includes = [&quot;include&quot;],</span><br><span class="line">    linkopts = select(&#123;</span><br><span class="line">        &quot;:macos&quot; : [],</span><br><span class="line">        &quot;//conditions:default&quot;: [&quot;-lssl&quot;],</span><br><span class="line">    &#125;),</span><br><span class="line">    deps = [&quot;:crypto&quot;]</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>由此，继续介绍以上规则的含义</p><h3 id="package"><a href="#package" class="headerlink" title="package"></a><code>package</code></h3><p><a href="https://bazel.build/reference/be/functions">Bazel package function</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">package(default_deprecation, default_testonly, default_visibility, features)</span><br></pre></td></tr></table></figure><p>该函数声明对包中后续的每一个规则的 metadata (元数据) 均适用。它在一个包内（BUILD 文件）中只能使用最多一次。</p><p>package 函数应该在所有 load 声明完成之后，在任何规则之前马上加上。</p><h3 id="config-setting"><a href="#config-setting" class="headerlink" title="config_setting"></a><code>config_setting</code></h3><p><a href="https://bazel.build/reference/be/general#config_setting">Bazel config setting function</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">config_setting(name, constraint_values, define_values, deprecation, distribs, features, flag_values, licenses, tags, testonly, values, visibility)</span><br></pre></td></tr></table></figure><p>为了触发可配置属性，<code>config_setting</code> 被使用来匹配一个期望的配置状态。（被表达为 编译 flags 或平台约束）。可以理解为，对不同平台，可能我们的编译参数不一致，而 <code>config_setting</code> 和 <code>select</code> 的 combo 使用帮助我们完成这一点。</p><h4 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h4><p>第一个例子，它匹配任何设置 <code>--compilation_mode = opt</code> 或者 <code>-c opt</code>的编译，（可能显式得出现在命令行或者 <code>.bazelrc</code> 文件）</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">config_setting(</span><br><span class="line">    name = &quot;simple&quot;,</span><br><span class="line">    values = &#123;&quot;compilation_mode&quot;: &quot;opt&quot;&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>第二个例子，它匹配任意编译，该编译以 ARM 为目标，并且应用自定义的设置<code>FOO=bar</code>。（比如 <code>bazel build --cpu=arm --define FOO-bar ...</code>）：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">config_setting(</span><br><span class="line">    name = &quot;two_conditions&quot;,</span><br><span class="line">    values = &#123;</span><br><span class="line">        &quot;cpu&quot;: &quot;arm&quot;,</span><br><span class="line">        &quot;define&quot;: &quot;FOO=bar&quot;</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Coding Language </category>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Bazel </tag>
            
            <tag> BUILD </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CMake-Into-II</title>
      <link href="/2022/08/07/CMake-Into-II/"/>
      <url>/2022/08/07/CMake-Into-II/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="225093a9af95cbf45a65e3fd77342a99fcede848439a5a500da3108c6994d304">d8d42b59f128a57d0f6a623c69489aeedc58485823473be982eedb9fdbd186309803f9f96f63bdc48a6d53a7a848bd866f5876aea0973632cf73d80b3221872535fba4c4c1b197b1d98518eae5ba82c4edc386083ebd524882b51c397c1747ab6fe54a74091cd9802f5c27303ac4a5e4879f501295d1b9134d0d4c2eec8a742bcee1924ad991d3f988162c254fe5e1b67c98386e7710bccd5d64f9be08bddf5bffff9a942614ed2f5dfc83b6f37db97a6a0e5aab7cdc5907e8c6a119fc8870fe6b73ee564ffc3cb06c5cb0bb0f847cd84cb5e56d740b87f8d156ae32d3ec13525527b8b9a415d7727460d1175816f46a3ae59b61759f340bec4afbe050fd1b0aff7aa2939d041fe0b2b5a44e5867dc334a8f6d45ce6a98fcc5dc0fb1de42d045436e38914e00ef75c827e8282bbffe9e4412119d80953146482400947e08348be3211f611da986b3a0695d9ee2d80801f530ed7779ec373d27ced9f0960ee9e537520eaa12fda25a5d98f7685c57275ed788da44db0fee27819fb43af03ba78df71c53f545a1f72fa390611c21a721cf25d9cc0f1661fbaf199dbc59ed573ce516a0a97aa8b054ccd43ec913764c0e60da288f04b57e9565573dd8301dada06a228748189eb71fb6105ae03d60e893c054d85b96011ee33d25d3d60186835eec03be163a7cd3c6567ac491ef5056ce852673a113fead2f4d1df110b3afb6f8d75bbf2ff018e157c6fa108f0326c0d6afe7bbd09e7c602510b53aab4e5ec0633e0601014b3b106d74ef971ef83c345de3f4a2e0ade05cbcad010f2dbf7cd9c92fe372a99879a21cfb8b299e5e568980a5e173d06f22cae803cef88c027231e8cb822d8d42d1462d179b21d391b050e59ff86fd800743b615f34a649b4777d3b992cfcf0282a747c80793b3a92bf7844dad09de8ff86de1dd11dd200fa953336adb583b470c53e9b921281ddbc462ca1c31679d9e9d637cc6737ae35eb16288b1c2da72917d736aabb6ade41ba62ab6287957b72cb9f9e184f2e2176f3b0ff1f2766d1d38206c7183441c61ee3abb996ba5bd5feef79da25be3216d48de97005e8caefc2d927547a415a2a57a810e0095e4228834976e1b072d1e44fd0e7ca2a6a1378141b59787751ffef7271921fd5c0ce4b1cf0e550e3aa66b5c579f43f5e31ab198519e1cc2defe288264b9d8a4678b2b20f4ac13a26acc43c9364749746183d1a47cb1c62bf6c757b7698402f07fb01ceb094b3889be81f56f2f97600ab50d35d1ed6db050eccc2a6c692e27db6ec13978c82cfe6b43b90ef218bfbfba5c4f97245fa31c8c888a0de0d3b21da8fb0e28d495a06ed375b0a337ab625114d9a6c0483a6a531309a30eb2e502f095ab93883a6f71ef45d8590953e31f35cd9ef31c776b9c7e75869ce0c30186be8e56f2f5f012183aac2b3f5b77ae79d0d306db8b53b6783ae41013a691b99e98e5a79cb7faf89bb717cf1ae301f7a937de78bdd4f619e8af74414c0d5f908d8912963f375b737239f2bb547d5c000dabb9f758e8a00879bc8dc2f0bb894d0df999429b96a69ae74aa2b3abd26aefb029a15563aaf38e99e4b6daacfbaed3ed707c97115f9e957d9f72969f136d3b67022102deaa436644aa5eb60deec5381999ec728273655aa1fc6f260d5db52b2804cb81be1eaa6b63b7da998054a893cde1f82b88de8d093828b9e4228645759133602225e421734f97172d1bb51e4b253fed7622bd4ab9a98233c6de7464df9b4e630bf397dc942d3520d8913a7978cdcf65cb4d7fac374d8a68b731df3a9ef3699f4239d1c15b442002e6ec8e631616affc6841a0c51fa503be3646aa6a251fb03e3579130d3795dd2827cb279ebcf58982beb53a15616bb9451fce9bb8238bd45f56677935fa547e718aa5622662ef824b581ac6410ca4f437b69230b214a1ed50472aeb9f52328997ba7f9b6d13586db26c54d540209f3c10ecbde2c899072494e1ea1400aafc1c4747a829e0696dea090180e76eac3f6be9b87d83b27b06a262b76322d8e1bd446560b8c8d627881a3c4aba4b1d1523f95a6f67224c98916b315b4bd2451d2f6fe08758a6a43f4c79cf7095b02e48eb809f00c6003ac7671cb6d6310f7795bf84866441ea1959d9c89c0514147c359ea24c62b06daaf83950d160e7d82b8f0a9c0888ffba3e84551088db4136f0db392546168b3d4cb8bd542ca84b3e3f9d66a687c27e1375ba51a423f1c6f10ba53f3419507c57a8432c5008fa335168be7980eaf6b08ff02a58d8fb58a2218363c66daa8e65bc7c4efd3d23796a010e4d1c22a9f8528b2b30ac183098a7fb426374bcd1364d7480f38f43fc9d5afb2ca886367436b889eb92c4258596efb24168031563f7a19a68af1922d4477d0ec67e1fe7ac7b0cbf3f9bcb9aa27ebfef96c9fa339b51bf916f57518333d3f3eab4e4cda25516f2b1b8aabf67beb032949ffb2bbed4b4333da00ca7054455da565bdbebf8fe8d7111290be460df516416cdcb12595702cd7c4ecde513c76cc6f08005941b4bd98e8c1cae33cbc44c36a7fb547a97c71a25a39322da4f0beb5beb9619542b917ca2119ec413d827c2b78440e298dc89dffcd40804947d5987bfd728357285c64afd6e31d66342c9ce0dd7e57ca071ad04e0dd856b5e57598f45d4133f93c378058dab13b6c2aef2fe18c12ba99d89b0ed5b659f285779ab9f051de4ae8e7d5f91736c13658457b2621bf2e19357277ccbf141885c4b397c43d5a93d1e79c772de679f48a44b5ed421cbc9e415796114c3564204d4894a287cc3bf4a77a754bf22aa00ea6f241f7f4e1c4ba2176d8bda2275a351c01f42c6009f260f7335c9c99deda3050f29720ab5f5fe904a949bdd53e2b98ee2b2a4333da4042e3094756b4085ba9dcfd895b1f23a6e78c47f7bd576cb252670814090e0abed848fd4443368dfa1d318c7f41bebd4f390b868fddcdcd1529b0500687932ba6c2e71cd514a6280d793b63df4b93a77b3a65a9aa5487ea67d5716898b11ff1a0e4bb3457a6503e3c56d394aa9d919e7dfc5d42fc822707144718f3c92a36d158fcb71de487cc4a6cce9cedc13b214369163e1dccdc6e767c89e6a6da8c163af7023fde2049dadae6dd6be22533ca00e99eacad3682b9f0622695b1d18bbdaf7c907e71fcbca331f7a6e410205d68a8ac10b20d7ff80c2fd54075adb10b9f543ec3b4cd964177a3c4caf043696a2a07c3bf373f5e40a7eee5bfe098869d9a6e298cbcdf32714b994ed2843ea7da8ee9a80e28ec37b42da282d602ac9d09e4abf461528755f844bd0cf2a239578eac8353587b43eb74eb5749cf0a9aa09a28f60a5d5502c9b65d19b3a5634c245073417d1f90c6379fb684cdde5bff412143bfca8225db34559b6c1d7c640e017157700dfab60a73e04dd5672a97e9648da5473b00c6cb082086980910184664a33088a77ed412593a587f56ba3ee1b804f0e83cecc84ccfbf759c325c20fc2857acc79f14aa1b8c48e3b3538caefd35d2cebbdf6632b654a6254dc06ee5caefbe20a48847303c8e8984726503cad937613576fe9666a586c4b60db1cb686dd175870355dbdcb8bbc84037df28cbdcff45b438fdd7138679bb31a132e76e0831a25afb2cd277b80e7062a64427f62bbd4d34d5344a08b09d7b0ba501c7aca0d181e08e2557b69ad48b829d6dc53f383db5341734fd922fb46d44c559c44994d5f5fd6a301c62ef8b1551ac5c4975e48891f2453fe143268b2a39cb49d358b8f9f9d7cadc733664090fe3eb08c309ee55946419e7a1495b3d230cfa0570b39598ccf47a34862508d6419faddabdec3f26daa6613c11680bf67bae70f4c9621bcbb87c75b591b9b3b423e4938e597527d4f769d149fc9ca403c075e5591f4845927f9c97a9064bc62c0c881ea232e0e3969a2f911e288104a55a8dc8d33aef368ada33d12c036c2dade947f80e3cd5258175edb8d9d70b1f50d8ec0ba52f232bb1708504198c84d7b2792f045c03194edce61d360afd20e41401a97cecb0ae3ac436655c0288da58e27835a00ef8cc83ff40f3f4dacd4ef25699ba97dff7ccaa360a71dee714b540b39efc550bd41d905151a069fa29bfd873616a12238ad7a0bb07d5d28d144e31f2fd9703d33c654a29c4cc5c9e2d31b18454180bb0eb0d58f4137c8107e13c728de5cf249728fbeb15da25326f619b39cb54cff4ba765616f7df0271ef9c07ae95c443740fc7abb53ae54fe94af44554ba4c4bb37efb8671fc067328a310aa0d9c8f0498ba8e727c658f7df1ac1d39d9f0f993dca17ad793188d7d4bb2ff0600fc26e482bcd859e65b2fc323ba9fc2b36761ef39ca4a241843201a7a8b321848fc5b6d5274f022a764fd5205b23267e21468c2bb906c7a8c14e562cc6b0c5e30cab6c1eb940cd04be2210e0883e0b9ca5dd7fd762997d031485b3c928beb21236e29dc1f0577f189363632e1ec8bccc4cae33acec30927491934287c8a1de493764491c5c0fe5d7efee8ce064a4768293765b4ee89c49781c15f43f3ab89c74319492dfd7339cbcfe2b81975f68f39dc89a9499fdc303c519dc835418703b38d70a500a28af2e213d5dfe18770ecee297410fc6233c42a26c581925a08ded73da88361eba77d554a24876266dd5b60365b3d1a22ccb2a81801a4d58417a3a206491b524ff1fde857014fd86bf834edf8912cefe472180bf13f19a9dac8e393be9eae948127cddbfcbacbabb299dd914e05bd75b57d883060e8e1fc8fa008abb6cffd22fc5a4c6f8cd5859b6bc1b104b183531689c6f5d47c05a0beefcecc4d619b963ed2f93658413efc706a8d8f1694209680a952331fdfd5e1a6ba35c9779e9b7f9f6a7b12ae47b6d027a00bb415e3e760cc5aa0437dde4fd8d92c4d4a76f069da961f5eccb817f2e867fd42d3eb660cdd3be7e3cce154f2ab02309bb12bfecacfc82695e5c35e6fa3cd7027c175730f46cd0bb6237cf270d7ba0450ad5e7c2c6ca774511a0de9429a6f3977d18ef2a07aa7edb61e28e24ba1726a7493cf2289166373c239e4399d7e50ef76564bae928637373ed7bfdb38af988f85efc705d13db03ac4b5a1b1d2f01455aa24d760fa7eb228512bca2669894a1bbf6c3efc05c87ddc111ecbb2c0b5f03027bccf171c2acbc05d1caf474e17cbe79dc2a6031174e58b2031a5efdd6ec2a026bce7305ba22d9b20649124eb6169f2deb7117d9ef50e8d262cfc5aa59521f3c6af69a45909971c98b5b619eec5ea4e4e88ce55ecb941cd3fc5bcffb6817073a3f07f8535d6288128e7d6bc23af9a21cf86dc5b6630b8887cf30eee1cd8ff877cda534d6cd0f856b1ad40c0abb4cd85d8a8fd85613d20208d5a5ef6525dfae6b1caf658de41b04f08c8ebb89c1781c385ec17a65e8097aa7a57fdf2c92826327cb818e0437a52a1d8d86c15f64a97a11e37acea55df9ec01761f67ae1d11bb2e815c48fb934c35017934f9a4405b9ce640758ac6cc167886bc4f54746acb39ceb06d47664d50f194aed60f7173fd257c8b825c14bf6dab4e07b946d3f65f61e8a550ca4815166067f23d2227472acfe1eb8ec1a3cca90415c21da7dfcf9bd6d61d6b70c9acd8cfe5dff881695c4085e30bfc9ddd4ca2e7271d9bac6391a1de3c5a2af61b0209a8b4ca2fce224b21d6626ffba7ff0697c0b8f4eaf39b3c6bc23991595e5cc8412e630ba6b0679dfd13d8d7dfc67cca0f4162f689baa2733d020a050e48502d3278cd29c4b0a3434b50aaf40ecd4d77e7f4b07d38acd2a94cca2b972b8c9701281dbbf7850d04a3eca48acb943dad0a216925a9ed022671a525db2894322e0386deaec68b6b0ff4915d3356acaf2347a125486b22880b7b7bb923e61578235ba75bb980969dd39db837c01c37c80e1e3d4b9aeb8411295d67f46e399bafbe2a0123c31f78f7af4917414e3618ffa4d28b9bd8ffc4a04e70db0d762a6a0415c916accda7e2c3a28d6a6979216a569f3ae7637e60d3b068743f34dff30acb730790962d7d571b59cc7a862a1dfc38c2e15964b6549620f1900efb89be5140a48bdc893c83de23c97bbe3cab7754686d7078d058f5267cca8667937a9a0d20273585abdd37e8679bfacb54bab2a67cc817f7cdbeeadf4b53cb81a5f6c689ccaf1cbf670ec0c93c4e2cb6a741b6faec729fce912b35d1258dd79cb13bfcc8cb52ceb1c7e30d9d510a907346b679620a1b78e792d23e4c5f778cb841bc80bc11c234d8579d4ede0e0662d02cdf8822242778d568ae5c99031f566ff91261def58bf6aa589cdeaba1abac6497b7db4d029a5069d923965c1e0fb1df2bb50fdac5cd77b36bde5d5cbd7c78bd66d3f3dd66be97f2012af70a764e532f219c043182198046211e885b8bface7cdff5b816415cbcff27bfd20e229e76694e0e11fe56e300ae20627d3c844eaeafcbaef097f17fe779c1ee2b723d15e07e4405022533ab3d7b48568f3ae004b47f94c02d9430ca37136ad14182dd0852468c03f0374b82255e92962a90e7b6c87d46b47628c3a2231717c023a71dae106124ba78fdb38f9807fd593e3b5419d176303595761ba8004669ef69c20ee7f253a0c152d1ca0dbcf6c1a6a0ab23c45d46a39759c9acf06c4d5b5774c1d8d98762a6dffd1bbfb59569d173077b5cdacc6e952d54573be92736bfeff346257cb5810db63577c99bb83d8d4068f40dba55cb52f88c722a0a473e8ee2b60cb73cf8a6245fdbb3f7e1e849ff2f29b17b1e8b09a4acd08cd5fc5d1c12aaf12a3350d2d3b50cdb9f17d9be32d1a344718dec32bc0f939abfd95c148a4a0fdca5183131d11a0cd9a083a2b30bbf95b1ed7f0d864833475a63952d249fd801e90eb1aaffb7911548d366ab41c1063d283c27638429bc2039a1d6c304eaf2205524d98635c256a10ffb56e87629f6f4f211efd5679e8b3a122a712b86317c69f89f4f53969b9724999bff2201b9fb2621c4942cbc5b762a34abbd9c1f75a9d6fd0375c8ed8ff609afd99b97736c195a8930090fab02cebfdfe9421026d5346e7d4390e96af0833efae31b652027315382ce84f605cdeb48c2dafbbaafc0597d2394782c46a74be0bbac1b591e1671eb76cb4978f7b683e4eb856287b4f3c490c55c5b2ae4da7a3641c34e70f9da1140d9fe35ccc79e62540f24996aab80ec9a01669fc447964aa1e0a79f215f0e08c9f7c5d50fdce69287f488186ce74e26397e3e792abc73c548ae4bf81fca4f6e83086285edf7504e7d91c2e7096813b051c80c40dd4afd16139d81499e0e45d67a4c74f7130d6402e5f0e23d8c73f285483936d5b1d6b5940ea4e92b8130c943520c1364cff3f425395fd0c106d20390cf0b6027d4a172d800e5fccaf77aa5c550650e93b88a13091720dc69838959ecae2ce6b6dc0009916c3088df1e05e45b283e1d44877979f04cb082b30ec40b184a0d8a12d759538637c343cf1543125e926d7b70542718b6754b68c7592be3d9ea0292ef3debc479b4007ca28c7bc09a850ddeec07f261e188a0668f88a0b7e61149079675ddab5e81c3aff27f6305314d50515d65efb6b0e1a6fa4a4687a2ffc819764a80e3eda8302453116f51dbcb258d6a819aa4e12aed42639ef24752a7cbee459772e6e2af1eb6af568db9518520691879d2c6462fc35313632c4d8533259245f5fc8e88625eb3b1c079314d0cfda0f7c38f3ed80576116f5dce579475cbc29761490ef56b3be8d3e5e5de03ba63f898c2b904c968a9587bcbd1b2a34e5f13f01fe14cceb0bd43b492d00af107f195e04feb91d4429981ad617cd77b91676a8f02ed5b24d98ffde8cac23a431fda0ee5fea0106bf14</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> Coding Language </category>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CMake </tag>
            
            <tag> Shell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Server Add Member and Passwd</title>
      <link href="/2022/08/05/add-member-to-root-and-add-passwd/"/>
      <url>/2022/08/05/add-member-to-root-and-add-passwd/</url>
      
        <content type="html"><![CDATA[<ol><li><p>登陆机器，进入 root</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">smc toc 10.129.112.84</span><br><span class="line">SSE@10-129-112-84:~$ sudo su -</span><br><span class="line">root@10-129-112-84:~#</span><br></pre></td></tr></table></figure></li><li><p>增加 sudoers</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/sudoers</span><br></pre></td></tr></table></figure><p>显示如下：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> This file MUST be edited with the <span class="string">&#x27;visudo&#x27;</span> <span class="built_in">command</span> as root.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="bash"><span class="comment"># Please consider adding local content in /etc/sudoers.d/ instead of</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> directly modifying this file.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="bash"><span class="comment"># See the man page for details on how to write a sudoers file.</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="bash">Defaults    env_reset</span></span><br><span class="line">Defaults    mail_badpass</span><br><span class="line">Defaults    secure_path=&quot;/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin&quot;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Host <span class="built_in">alias</span> specification</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> User <span class="built_in">alias</span> specification</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Cmnd <span class="built_in">alias</span> specification</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> User privilege specification</span></span><br><span class="line">root    ALL=(ALL:ALL) ALL</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Members of the admin group may gain root privileges</span></span><br><span class="line"><span class="meta">%</span><span class="bash">admin ALL=(ALL) ALL</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Allow members of group sudo to execute any <span class="built_in">command</span></span></span><br><span class="line"><span class="meta">%</span><span class="bash">sudo    ALL=(ALL:ALL) ALL</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> See sudoers(5) <span class="keyword">for</span> more information on <span class="string">&quot;#include&quot;</span> directives:</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">includedir /etc/sudoers.d</span></span><br></pre></td></tr></table></figure></li><li><p>在 <code>User privilege specification</code>  中增加 sudoers 权限</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hang.gao        ALL=(ALL:ALL) ALL</span><br><span class="line">zhenghai.tan    ALL=(ALL:ALL) ALL</span><br><span class="line">dongtf  ALL=(ALL:ALL) ALL</span><br></pre></td></tr></table></figure></li><li><p><code>:wq!</code> 退出，已经加入了我们的 sudoers 了</p></li><li><p>给 sudoers 加密码</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">passwd zijian.zeng</span><br><span class="line">New password: [Add your passwd]</span><br><span class="line">Retype new password: [Retype your passwd]</span><br><span class="line"></span><br><span class="line">passwd: password updated successfully</span><br></pre></td></tr></table></figure></li><li><p>可以愉快得加权限了。</p></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Service </tag>
            
            <tag> Handbook </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cmake-Intro-I -- CMakeLists.txt</title>
      <link href="/2022/08/03/CMake-Intro-I/"/>
      <url>/2022/08/03/CMake-Intro-I/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="2f4457001718a181a254320a6f3430d5f9ff719a00403263e0c2144429fa68fd">288c496f07cd7a970f0e86fc14828c2c00b04f29efba1914917c618c5f232eeb7d37efec4978a686b039fb1ee90f91c7b9f4dbbab0c43828531f4133ee4bbe9fbe380320bce9ee03c7a79a13ee86432de6a58b45992bb2609324650378176de6897e9b84684078cb63458345de717b2d7429c4837262752efe9eb8400cd572d18d4f712359cf3451ea13d32ad7feff9a2ce92847aa1e546dfb75b3dc39eacdd7f31c93b7e79225fbe5119aa6d44966e56359090ad7f462ad135632e5476244bc4da0e2e23ff8c0a7a02d205d844f2aa43d84b4160f076bf6718abce77a81d133853addf48171df91677fa05df2182d0c4717d0e29973d295934c610a75d910c398dff922a37e6c69e54a04069bb1875ef7eacc9852eebb89bf7f174c216ce9cd58003e6fca9fd29ca876a110067c9efaf628006cc80aa2eee1d14605a04564d9477f3c2dee5dab022fcfb1159d41cdcc3a113c3cdf983989867fc24626783b7531b1f58b21f3e8a915d3f1f2a60d679c834c5d591430e47388f32ce9b254f1c2bc14b96e277a140c1f41d23919921ff77d0d4ff69371e4c181c8bae73a1dd1e50efd9db157d92c905f33aa894dbddad0f74255027097347b234bbe4395ff175b2b3ed22054fbd7a1f2927480fe369dfef0058c9b410973d44f6f14ff82f43b46297ed81d4014864a5039128ec8a9297ff1cf9a9fa3c88cc27c48de45ba0528768a468872c2b191a9e1cc12c66db6a195d58d134329be7a2817a546c17ff995714525a55de25c92804da6e15054d7f99b96b588e8436890a9a3287589852721ba475e4600b2cb560ce87b7966a64a41e6720721b65d555807bb753be29e951b44200f7ad6a83ecc03ad7f3f0ed6b18cb74ee3b65c366f8cd32900680d1442828fdb7bf455bbf70ac1248abf8b86ca7c0b36cc24a4f01bb057a6abb0ac45cb945563659fb97b64eeb2b8d641cef3d13dd785503610dd4f90fc4fac6ded2e29f066e8d6c9fd31ad5be7f1dde6dbaea8743b40eb976d5f4cc177316dc6d19b20740608cf2fc03c1c06fbe0db756d7660761250e429ac3a193a7626297d024ef41fda67b8784e92907986f86e4f9458ea4dd7d2d8362914c2a919f67fb5ef52fa62e52c0a7d1c976c6db52291f3939e6cac78eca0ac2af595e1b6bc95157bcbc47f19215fa4e437ddceb49770cdb869acad1da19f833ee6ecd601ac281a6d53df6b153c3f53ddaa9958c2dbe73e762f8420dc45685ae93bf45a95f3a614816ce3b3d274d96dc5186206708260f259e846105f5d4cae21ea8929e376d91a473951a5b39e6cdff85957e8f6b878b9c6a6c001c06d47961c5ba3cf38aff9badb254fc599ed813d909e630bcce6458b244b2ce53663cd6a81593dece564e92e96db07f068372e45fe5390bc1f0c97d3d43fd06c2ff901485bca9c2a72d8a1e8d209318f40564bb59e5b455a1f14128a3093acd563ff1c1f84263ddb52d7178acf805ee1c8be0d8da61c9d1ea86641718e5551f21fe5dc1a084b1af1b5fc3db4e61f47588c86ac1dc2b5a4b050725bb5402f62310a0735910f93a124113acbaca0c3faa464ec6925befbcb8c487702ebc837de5980309eff33d454fe203083b0f705297225901f05e792a9d1513dc24da27b9b8dede9b4e295a6d9fa879ce524a57555f78aa91d4abf82e3a38027bb7843252531cb4cca791b1baceaa59f7c2b232b7f896e5e0bfcbbf41f2cbcc14d08971c877de1e99884aeee91daa826785c0a934ddd3ab567e4d6cb388fb821b180880db181f5bd55a281656fabb0bc00420fb9aca899cf895641ecb940586c7e18ce7a615d17f0c05eb5d3f9b1a79508cdd2f341afb344414bac96f4d2d28434bf2b85433fd8bb47e153eede184fd63f20bff427bc49ee138759671d63ce44925bb4c75eafd6a89927713dce68ace337a70f89d9caaa317552bc62649b2dd6275f1edac60291e5467b6aae984a213b8f3d2a315cab7b53ce87f55ae775ecefa4ae2a89804540d94a4553af035c7673cd3f2e4346cf5f68b16e74a19eaacf2b282c5e21416222bb10497c5ee1f42f95013cf0c5699e147da1d06adea4bd0ee481ef600062ef55d339ae9ea373648f05ebf7d5df2b5bb3c65ecb928504d0c92cb4714a4ec0ee8d36ce9ddf440f7ae3bf06a2e780f883c47ce9b4e7acd4d44cc71168384acf0b97170437eaeacc5cda8de7002642465b5f3b57e9d3a5ffb8b7a0cee6cd6968e24dae47f1f11f0e1bf410bdafaf6bca20f5c8c9dc7d405a651809c91eb5eec2f181b0bbea17a104e5c192dc47dfc167a2d640a93c281f96e0c3f2b29219bc59790ed46f07c214b842adcab4ddddca97c8a29a5f2bf259119b5535644b0894449f9d67495406900d42978051b91f540463d6b34f8d4b1a15ac4ab99924dfa9c9d1daf67705ad8447595d14b95750e03c34463ca7c892ee253012facb92f897654604350a68cf30177898964cb49ec1e724b075a4a083494da744c16afa60f834b745c671ceff88cb89f5c813bd95206527e7aee8a8e1e2b271336bf703e03683c86030f0e32538ff6440a797edb051c48f01c67e887bd93978328858c93818b102d2988214c6961ffdf9c34a8c60c119b0faf06394c7525f389b38401293406333d56ddd13d2035e212df6722b697c3368f70e65d2644c9cda9baa5e27c04523e8c5c3e554a27734a58cc17e1ad3b7f5ef4cfc142512c2c99238764b5b73f14fc4bfac4820d4a683d221518c7d34f90a1b15ce517b20ecb5a05c7b5396f7311d6b3680792cdcd7a82668022d98cfcfbaedd8f81911d228d6206567fde3b1bcc824a9f784b97fe1ad76eeac295b9de51180706a9406124da7977fe6336ad766f0e7cd09a5de0680a343969ac8e78fd3fb5d33ee22e3985049d8bf5c299c9a104435b91bcb86340da9b6467ac8c394f7ecd81a3438842ef055bd51ecb4f198da502b20bc56c52f48245e9d91a7d1af59f8cbf8a72924366ab18927a5142b46e1e7dee60bdc2b4e5c56a1eb89b5327b5ca759eba030128ebc23f13df7ac919d2934bd5b8fed07cbcd0ae1b86da32e96450c56417abf67b0d1f8f2ea3047b693d9f894dd44134b2e52f0d7558d1f15243836d89ee2d5827a505a26e1545fd6d56a894b41b0d0af6e23fe1faff0a2d8622ad78f0b982352d46dcbbce78f95a67d571f7ca8f1879aac949b12110bd51e1e9d4b0114f20a0cae5338bbf62a25c0c88fd841c64ae46580d1ee4def8e2327a4b001fac851439db22a7235dbe1a6d8f689ce55986939aab07062d8ebe33a87167f4827a0d051c916621eadebc232cf7bbac48eb9d9c5ec85f3069e2da4bad1a6d943eb46e4d91d2c760255aefec5d96dfa728845fe0a918cb881a73860dba45d404a44acf3fc919c66f7ac4c1632082bda47790115de8d751a3ee2fa8242ca202a456e7f8acecf4d64c45040f762f561d5f88a091f687c33a2cd217f6446e51ffeb3ad15ac467720f05a8a356cb819aea3c91682ba2b8685083af1b287ea5389c996fc81be05ed3f3b85f4d343c49a7175660881cc478eecd6d33a8d96d2c9bf6c95e02f7a3dc0ae8dfa5b3e409955bfc6a1d94e4e93d74b25c9f6776cfa5322ae0efd6551c59ae5226eefde5067c7ddfa946d5fd935dba3d88adc6eea8b676abc3e4cc11d439fc33a06bdf93061f7be1147d1ddd394992029eeb8855ed3b3d8ca43737454be8b88368e67416aa8d42606258737ffe20bc3377d40d8ad94b6297ccf8edcb23116ec9115a3cad3ce01f43432e5e42f929ca75d0345bf1c48f95656971c03ce1b7fafd24970382d909c498d22aa464ff9f9c318d021da55217a553a2fce2e7b4d38325739bc99b61b0417566c06f3ed29f4999455a563081e7ea7b3d113456ed2ce0a2b13b68fb8695bb8e84467e4b7a9c7f130a2837027ebc4a205ffbfd04330c077205394807674e2aa66b38ac7291f90c18c8f967600c4ea4f0dbbb9167004c77f8e1f8ac844961c6e0c043a8feb5257bc6b2da7c8a71c79a52dcfeae6e7b5cbb87a98e0ca5bfc654da8f0df0c89c92ad6368e836297cb65a99376adf11e5b704450e33d28253a2cb4d3efe19f82d099ba5590e0e53ba5a083219782b629277c1a852b5d402db65f22321129cbb98cad4683a2781b4eaf990daa213dae0a65f2e41287a7fc7ce71c29a3d824dde5eb820bf0d8d336a66ef11528bcc9f33f49741f860924aa2957fa56a9d15361d8a57c12c51c71a81c089b6c388c27b70a9f85f3b7e62d4095a98f6454109bdec30fa98648a8a6d4a6d03911cf3c6331533fe873ce4ad0f5741ecbe1c7e5aac088d17e9b1268c73437eaa330ef8747be4836c7376b102ee861700b62b63408095666751e02b728d38845187d5a2cd9299cb3f434ba7ced3d2042d8d62ecf8143e41c3975d8e9d8897c7756fa2e9d656deae454aed1fe064a3603c3375ed105cdc66228ad91ae1a6af17b829ee49eba90d48d6b84c858b880a78f4d6288e965144accceded8c893cbd58c2f58d55851c5c96215ecbff18633ca9826f7ce06067237fd4228c44fe70948dd03839c670cf93d3e9221586a001ed8aadef3d5e6ca19507ba24bbec22482964a751afe64e8263da15810dccddc35dcaccfe0ef140bce0800ea3233202855f066e47b28a2148b6c17945ab3639c2742d4445c30bca0fab4ed6178a05987be5b1a403937aac4e2e5d812e31e43415ce07c67b9883cc088be405aa8348694859aa4beda964c905198a2f9535e9305162da801a4d8799cb27834c2b13c274491b1855830c5d9d22ca22e8433dfb48c072faddc7c07d6702a8c96a9ace3a8b5a6b374ce9fa8d90808d5b584b20fa8d275f579bcca42a56ba5128b1d7b83bedbd35ca80a78ec6c4a295c120fb888154b841a0e6ac436afc07451d8a0651a700861a478f3af4ee4469c61479459c6f870de44cdbb829ec8f6bee74fdd39b22718d7e7637b0f3fa710f1f36c6b2e4089ff6e5e00ffd5bc9802dcc85028961bcaccce14ec821ef93344a5302e1def7d33e073287b738869fda89d54c01e811f789f23aa56bb58af54e16a55fbe4537c9a8bb412757699ba80b7ad7fa78a98eb306473b374a04b78a156bd051c8282f634e049b1f121625090376bc9ecf1093bf35e4a8b9a0aab85afbdff0a340c46e2e0c104cd6526f5890516da27079308ada27b7279fa0cf52e4dd6f9b00dfdcf2f4e95c6da92449056ef2385f6ed4d5d623c439512d8122c2a42a8fbeebd34dbdca2f590f7c49de1f5d3937610ddbef147eaa11d5624a1469bfa730b6110f12cd27589e6cbfba93747dcbcab8ae04be390d20743e864cd540683979d0a4496720d420b09885f2427c04a3ffa5bd4e823b442108e3e50923afb85098aa500a9d85e66cea52ec8ddfd0a63da7be105b7bc6360b5fa87a6c09be2d99838c1701808da46a0b01043535c25bcb7bd3a091cbe52abf67168a5b81d18664343133b64ec9ff99e466c1bd3ad5d46e1c0c37ece58d884ec28a1edb5892ecfd55471e55250b7d55a955b251f23175686877d61377be66a57257b8fc3df3c74df2c6fef971e67ca61b9fe9c55246b1e5ce1f0783a81df8454ef6bad342e814e03b4f7725bcb46a128df8cea986e75d03f6707b12b4b33c789a2d6360887d7b9b06d0bd12a4c19d15cc3aca0efcce3a46262d24b960f7299b8d7bcaccd5ee0824b213a947a890548ff7cd0ccd357a62c7df1c3f577416b7b77eca5a1ff27c92c01195d38e31ee7a7cce8bef5561d68249137865a3b48694368f59ecf38c9909a07638207b87a00e82cbc07f98005977b5ff2a0cb0a467a14e182fd9c009871c1baf4f1a0bbdabc448c322240377d1251b8b82005fb55379f7b297e279e40140c14c1cc65b1b07c8b422ca74c4af11b1d5a024815179315deb516b4eea738a9d453c056743411facb42e411079175c2efc97500d9d3469c0cbc4984e96a55494c43301f907192d5c2740f3ea565e89952c8cfd266d1f0a16c56a1800f560aabd009c4c87a81bbb9c3c2075cea34214ade7d22064e1fb4b8264b103d11de1ae6dd67deda654913c6c13af66a21e88a514bcfafe193822889cbcf911ee3daa66b187014691ca8e0e2336e48ff5a0367bbf1f744dbf68978b436ff92385ecd3a4f558b12c3c085c4a26f50b164f997dddddd1f2dc08cb2c5c97d93fe8c71dd651b60ab0ddff1f6fe21adbc741d8d4e94d39c5d88c3a8bcb30b904f1ae8ff16fe8b24f46f446fdb62ad6166ecd89ab74b16298f13ed9fd18fad30e93f18097fe6ea5dbbe4aabb5dcb9f4e796dd9a9cb1e1499dfe77ba65d470457074fa9cab9db2bfbb06e838022101b973e851537476eee619bb9c3e86a4390f4a5a228c1637f5adaa9b4da032dbead13ab6efb216c5a25d3c28034f7e26630bdc684c10cca6b506f5e7d2c00c0094bda0a980e179bd8fdec94236ff0f981ace1a7d783da6c970137656deb9d99202b1f60293016b94ce4e7ce9b25fdbb93898e2d63e688cc10c8b61e8f5919bf866aa7c837dce17496f6359e6faab5778bc0b75f2195e97a4e263351aeeb4998c6cc68c4be1e17de6ad63952966e4b117924273182daf6029e8ba53dccdbef17eea95d0338cf3c969dec5752167d461d4071e7a4958f22d96d6e0be72332a666eff1e09a783aef45791240f753ad30b0263422cb521f4702abf30b8f6c4ba77f186664e2249bba1331af91ffc91b4e4707eadfc087de8144deb7cdcc810e73ce41ec7d01aca166c00d48dc7709dd250f6c7a4182835fe1f34700c50a48631aa6f868cae42394cbc58a01732549102b69dbcca17588d6fb5456bd377c1fa7bd6f1303a84c23640540bda2ef787c8e33641756b69365f0eb6563f42b98d388178f1c6d4d27fe5082417ab0b338047f72a59e37b55978f42eae9e3626df6a17267951da6832e433c91abdd7dce2089e617078fa67517463957b38fc5bdecbd1460200ebc83e6d0186a1a187a9ae8b9670c6ade1ab2c538f576ef5e0acf2cd9d4113d21853fbdb75cdf0c9861612cb3d89025dc70a1019ea09c3a9bd42c8bfde26f8ca79adb4c84c70accba2d07716740081bf65d323d9dc622cd3e7b60536e17a2185ac69e97249b7d00afa5cac3a983bdb4691a00794ba42c338c83bbccd4c8db4cc071bea1b651331e67aaa675b20725d33d87f4f84c708fe0799c96a948f11731e3d669b37c347b789726f1503b25db1bbb969ca63fc24b6ec07b9b9e2c23719cf6769a7f421079d39742139f125623bb3cc5b23571b59edcb247a91f0698ae9c90cc8c7ab3feb3cc43ce2c5bc287c0ad437d6084279bbeadaf144bd64728c51b62ff53a3f8104845887bb7f1ebfdb1b5d2835c4925997f041fcbdd039837837b8d0b0b82e3e1a2e72897db9840a7ad8694024cc86b41e543dd935f9f1d60df389fbfd8e7cece9835365dc5aa2d02e8b457292992c4eabb034a2da9fa923026c18d376d1761059e80dae3afb27064825c3ee31bc7fbfb3ba1315bff6266b32337298de8de544a98e2d57e86dd18b55c840d4666a4716bf251df4feeaef853bf73d3c5984a2799dc73e68bd63af0de694bb042d2b4979bff397ffd2231031d2f96245e73ba8f3b746a3c69387aaf9a3a494dfb3edc70217ab9c93f8bf8f62426fbca046656a4bce8c4eb59f896e769dfa533f32eb440a197e2cadba9e0f8f8a414dcf55d9c22f3279de5b87b8d81a81d513deeef9b8dc9ded55a4c4e4f2f4b308702e271dba00214a1cdecd73d7672b8c4c80f5cf39a122cb18bf056b7ae0ec85ef4dbaac1e6dbde3f914934f5c7e48868d9b8b31a194f0d33c4be7616d4fe806ef39394acf4874ebbeb3514e9d1ee2ce8e78bf826502008894f7fc6909170473ea329003e5705c982766bc5744398bf6813f315fb3806c34307fc3c574c49ce6aea3493ecdb2d86eb4ac3dd1c29235f323137acfac9e02d6ce7ae249082e68b652c0954145d916a45e565abdab06aee75bdfda4bcf58e172daa0d61392b97e34ab04f0fe40a308d727558321470a597a9193cc55e2b99e40e17a631ed3e987329480fd065d6f94b3d9d31c7b9b789ef0777f65db38fabb25fd344465510a24e77f633f9211cab70a1a56234aad63f4fee85e938c57d98eb223d5fde29cb1c03fa2a6b3506910101df8b8dfe57db602ee6f6f07ef66891810a1d5f4f4aa2d91064d5f421edbb5e39736546cc3a1fc88ceffce661a2e1c275d19b3377669e2d8224a7d91ba9d5db89d996566863f7c95d428539294cc2ed61ceac9004666c4d39ad692ff7e52826bc6fd5daf66ea970327219f3cbf829269c38a615dfe7e38b3bda3a61bc5113f81ff860b78bd78ae8f61713a5aca36063260105a852520c27fedfa77073ab92bddca913cac70d246b5e3248d1b0924b2b265e8291f1b8368a104568b2f87f951e4f27fd2f6ebc1186d06602ec04bb80dc5e4c29265c82fa424be8588ea20f857bca2a4b8444720b3608a04aef424e080606520b2ef85ea8860e2b20754a44a9e4f9983c71c5505c702094113ca2e43d676b902af8037c11030b6a847313ac91db328a13a4d38c0c53d3c87744ad43f3aac6850edeaf4d660f656d85530e27abca9364bbb2d3ca789b01f67b58a0e21fd7cd760c9ff8610ead3f11759385c7dfed31c2bb54c44697115960a181e877d8a825732940fa64e20a8d22556df6679857a78ecc343dced17ae7796a0b19909bd9f3eb35f8f404186a3ce415b47a0287a097c1e5acd08c622e532fe32efae6c572685db3976ebd680a54c28d393ec83f752e3a24c6195a4acae049a5ca8571dc46116cb9b9e140a0bab0ba02deec3af6d3754df52084bc96020227b38774643730757274f8e0bed46ff42cd864f4b585d0e0e2152e936bf79a18752fbcf3563e05c6bbd8f11f7380f566199980cf6bbe95af11684099612cc909e8d510b5fc1efcb7eae6e1102318cc49296eea6df8d0185f7fc2dd35660b06448b4028ebc4bb7b25ab8ca3b0ee06d4b8031d2b582a60a565b018a530b487f0e8bb0b9bc1369cfd3cd1c853b30458b882d97acd98e736f159c44c263a9d526dd64ea05007425244ce8b25a443621ee430f5f230b83f9c709484907cb2a4e15ed126a155c6176da562eacfaa90184523ce2189f91d10833dc6379c93a9e206c7ea049f8d750bfda4610bc6650aa566796d1e5f7b609d3acd5a19cf30e271ac1040d6ae28bd3e3610bcf733dfb8885390efef919b833ab81a97551428155f8d49038c7fe611fa10885667b94f9fed68461376544aae26eb77c2bb2d3c11428aab44669b7ce63bcac3dde6d765ab1ab4851851b62ad09b9b211d70706a5f5b8cf4c354c8e7579631c15dfc4d4f9521de5bd042fa53e566a46297d30a03d2f7f434758c1855d93ab96c2707d0a37e47e1bb43710393be84f48664f8fdac226e7e073a06e8278953e4b11913bee1d1575147cb5a6344c5de22b0c2bef8a427bbb10a4c9c3bcefd723fec4258ace3afa8cca7774dc7f5bde715680ee758ee07d4556959d57fec9a582d00ee50bb913672864a220ded0f51072688a1cf33ae3e8b0344ec33ac2439c355cbb90150256356e6131c072f56de634ca4e6dc7c1d5987a125d89eeb3c952b86296ac6943c8a34ef799f0acac88752a9d89372e12983cc8368a30b5934728f752949d4d72fcaf65eda2e7a56b4219e4ccc673271dedc0e30151140b4e28287f5a1319056899d31154bffb185a49af410a2c997b1dd485c895fa449912fd1ffa1a76e68e7e68bb75f7a210dcb6b17d271bc5a655ee848ba15ee09aa04a1b173e36b8e2f4e4aeb91d3071caf19d6dfc86018e252e4313fa551935a30b66311a50155267da097fb943d0af176c11dd5de05f4aa83a8c3ad1e5088e335a6553553e562c2e2eba553663d6623bf6be5cff98106cbdb1c98888e452a1c01c227b1bbf5def0d6a5774f606ceee7568ef0366c9f432b8ec3857460eb8b89903c24d027bebe728c172ede98e0ebbd2c8832874246db8c3dc77b88a7ef0814ef02d0709fc0120daccff87f383fe416326da5e8ebd1e6d7c16225830b043623caa7b359efbf755f08411761ca89c4e02d87faff2510e3fc3217d1e206453f20f57ab0ba337b01530bdfa2379549c450ca1188904c2a16593963ae2eb993ec186cead589693598036e666c7fe9bf4ff603ba9bad9e2ddf640273b4ceeeb5d0b54eb47d3566b82879e06a28ce311585e8fc0d4d2f4ec90d916813fcf2654dc5bcb2f5edb83670ca307e6f8e6de0933e5c031366b417408a1df120623c98371bc403f4eb72cfbd749189a1a4683c861a97a30632abe56075b525d6e00cbc2ff2239f80cc85e0749e48e4537ead76016adf21abff26b481f367a640b799cdb98d170583650f98c07cd46293eb61953d42c8d7119e6c96b49fecf53de3ac50d82493b650ac22195debadb8e3ea083f26bbfa92ef4f3d56c5cfcd5ef364327831ff4db5cc1a5cb27de5e87e28e06e0b30ab397d3f6ec30073dc41acd38b8c2b6becafd9ec9e316bd4340a84f3ae27f8781f53b4d86be7e27bf3ca535025f778cccb79a437bea08a0e44dba242b688a7166c26362ce7c9aa20de15b74c1f822b6f6eb1b811edc72b2894db3ca11a8548091811268048ee55d5f1539ec93c9baa414abff5f4008d50f57b6d9c345203228cc03a71b646f707083b1ff8debf614dc7ae10c2c8952f77eafebc30bad99a7149b7869d2e7a3fc072e85d944f8e4774495cf259677c993215d050087d73ec085774c60e7883bee751f9bdb90fa52df95b0b6bf34a7aa85f444f4334588baf0da04ca2f8ad6ed20fe97ae424e78cb1ac5c4b65d6c6494183b2dabcdbed2dd6ee21ae4b827726e57301efb97d57378fb95e7baf68ea4279d5353798ee9236966b8c2ec105ceb9aece2cc3a09dcf8788e2a135df8685fd9dfb72d42e70ee7eaeecf96e7c0ef2a56e1bb3408e3d06f9c030d7d0bf1bfcc14a7fd11fa66ebd8e422f6a49f5515d33b373627b73f392acdc5628bd9b6a0c885d8fb316c36ed1c24791947e9f41abf400542a0b9bb020cc91e7b496daa93c8f85b00d766c2ee58eab28e76c6ff07e4ccbf537ba3f200e313204486a4cce4e91c2de92a49f5eae0fc8867f6bdccaf2772856c75db8cec05a5b9b8f38990a039f9dcfd3b08956af48a864a2601b315ad4e7b167bf024a02fc273560ade266e2bf11f54a187a6d5a98e3e1fdb53d74c069b3d9d90eaaf30a296bc5bb4737c171046f1e4585b53f09d667573ea5d2095629ccb108174d6aef9339a38fdddf8697543aab7bfc82f2574ef90b51b8bad9a38c4584c9c5fe21325036f67525d7c8ed90b1ddcf4173fe6ffde63671c89425665fd657b8a8ff32efd6854044e7f6899a66d28b3f2fba1f432e51c4a238ba5f5d6862e9c203beb4a98bba20c0afe5518b316e515b1e0472d6897f60e3f5a3478dd4a2c1129f31e7e3f25f1d6f86e7050dc2651b260d64f00d4df69e0c9bc8651dbfeb5bdbe3612604fb54a378751fb61971e2f49623a22b771ad8246721d6f6374f65f7a3c1a1761922696c586f59cd6610cd07f2abdd8b79df67db5b97cd5d0cb07eeed0b5dcb23e884832eb32d2d61e9aafa87c5513067045ca17152214fe2969c3ad283e8a452e936232d3ae25193df3516958b6b09400122c7cee69922659f308ae58a60683e4ac3773faf77d464837d872be3866604b6fac88d46b06c4a4db50fa2f7386d68d231395fb3c0329318ecc353973b7b20428adbb32bde6004f2a2b9c2663cf32b1074e19867129ba70aa8bfa2e26b3110986ead5c1af42ece2565e49f954c0f7c038dad14d8b0eeb606d6877c96d94ee3449351dd3c21d5cf598b39392210a8c80a7471aacabf6f8e22578a5e21651670597926f7f481cbff4adf2ddddf9efe16768f183cf51b6b30dcedb2c812345950a3bb7364291d222bdd799462c81b62a0619a3fe73d4f30e8dbe0c3b5b80605e8870023c52f51b7877d37b553d1ed70f2d0d75875136fb1c6216b32452c853fbc28ddc86375c8550fbb9375e93795f51209291b0350c6a7348dafd2e462a318167a366ea886e1079e3aa2a9762506db334c62d70d653f9f45535c6e0c17ba863483b8dd361fb133461eb8728d7dcb545e5d37dcdf87f5007227ee13dab40eb851bc01a7b082458d7d9a575dbb2e6a7b702ce35f2c3aa129c467041d1444954067430ddcf850fbcb8bcc7db4b2c41b92ed8e90cbadac9683560068a909e1ff3cb1651247a8ecf6da769289ded8f18902b7a0ff8ccc0bbc8d2e77ebb7de79bc245a26203c36802a7f43be286f4f6ff859d32ea11498fd3df27be248f2ada764d517288ccbeca9df6bc24fa64a7ba611e8ba4dffc6b8b5300275749a8799e7fb7c3603be0cad87b226f9e8ecd3b53c1862518565fa4fc6e1058c9e56d61780c1c108a03f592e352c91594e27d0af4db8858e89109c90a4811f6655ebfcbc667464565552b450a2bb4a3a24357982ba4331774e98d8cad2eeb5d0e7ca268da1ca5bc84d5558ced66ffb489b826bf9e2c19adca057284f57659c737649d3837e04248ba417c0742b7dfc68a657c0db529681a0d21f59ef17b3a3acd04728ccd4a1622aa29e53c282f565c8ec201f581e7031e9ce97058d45462840cb6c347ba7d6f8cd830cd376c3d605a543da80a61c46ef1bb0d44f98d87fe3d2b3f4d921b27d4e2cb443dddc8ed4c9286d7a6410df911acd6e915eb9490d445c3b2740d0679193d4ab921400f6de33a4f35535f4781a82ec81f54ea7cf447582497fe991c0899b61f098bc65f383939a80ee775e289a34a32f0a927039a45847042ac172cc523f2533c55279cfd1f548665316bcaa758459524518c522e6d2ac29aae14c2a1d76d215d6cfab40506cf6aa61fe174d913d630837a58c96bd40f80078d24db4ef7a37ab9474585856b1a8d40c6585c71f47c8f846af35db4c8d44715e074f704e31b3a6e1e84bda453a42d2ec1747b466a070edcc2fdfa7ac58fa58d3c295cba5af362aaff67e7fb87faa3e445bc34fc6f42acd08a70c9b025fa26a5dc1cf3fd5b88e7bdbb612b9e78f2514af970ef82a33f5113bb9011b902c72186cfe57d22ebaa70b25df55619c00be8d0dfff3d50ee988a3cba94eb6634a1d63cc305e97bbdea0aec3d68aa6fe2e674db73678f45e4f9faf24385395b8a2e0323341578aa9f46f6cc179c81b9c124ce71765dc726ac55785089371198e0533fb0b1399c231d011c666564ff670a173d92b65862e894715d1eafdc3540ccb6d4ce33059e426a680cef072df3cc913afc2dcb12fc77a37a28925c32bc8ff43e0a5486acb88ba4a2d0ea03befb6de1470881016d148fdfc00725d2a8b21133bd207d94c3b0bb001f52f635162beefba9ca9ad45282300396abff2a5dc259d3f2408c13dcc9c4f4dcbf53af8dc876c3683a370aaf30f44dc1e6a9138d1412083b4affe9fbbd3765b7438370398c66fbf6f49c8eef69c707f2f6aa051fbf0e8e28f3c55fd45c3714c2408f33c1a7bf2fab5ab0e652e24831cd47e6bb7799679c6d932b3177961929fa7bf7b173a187b00de68c2dd58e18fbeb3f9a9f9c14dfdae62f31b40b595a49f3896646af52d642cb99cffcfcaabd8d1fac67582374d9a5e5833f43b1f37fdbd9acc0bfc6183c5f3390b474271c1007d32cbe4b9db00c92dd9faa48c1e97e22f286921541896b475d1d143588e81a6242117e80a05188037df0f134f6dc8de4a583e5e2a45cbe3006a33fbc96770d32ac2d4a4921fe7e987feaca5adc3f02acd7f00f42a6141b1a5bd8ecd01cb5114f859f7452a159c3aedab1c7974a9d798e7a68366c486fdfef82f341ff5b1e35d2c1069500fa784a005aa8703904b46dcda269e4bff3a0b5e85ade0bd25119b5cc85eba0d6b7ad8f7281c7ec3632c6a89dfc1ddab01472e971c00f95c8dfff443acf467ec7e0a0956d96e6b5f0dae43ee32f2245bf5ce587e62aed5ffca64804e2e46b487c530f9b94c2757dc0e1d957dca31bf4d2a4fa45c334ad5e5cccd3f7ba21e13f1e2a81158cf4f0d78b0d8e49e78046da0535e16267f0c36cdc4eb0989b7dcb73b26ae631b6e692842d080760b4e6142929f99aa25d336489b18d2b1998a3863807e3bd115c2433612068ba7ebe99da10f0e97a3e6b1b625216a40c396fce038fb4404f53d66cb51b439b67b75d69789a0c93b216d543e52ef3c7b44df083f5f498fc271ffa33a9cedb09335da78018b34eaa0e4e13091f7aa7713ce4e186237d282d98129c2dffe9824a27ed23477f16f178cecca7c24a02991fd786829a1916d01a6c486d82e36eacc0cbacf78c3c471f9fc41e20b41f6aeba00cc10e3f195953a00af293f6d2e22bddab65a7a85f8012f1a91402b80d72f025201c53c75615d96f0759e6baf7cef811a358c76677eefb69f799ea627e02a71af355331acd3d86978f5fc1c1af7ff3bb7dd3173fcc6ecbe19cb53775cd228e8b9b666d31b31c5bf919a0117eb0ad34a4b4022f653136db041f3aac7a2761cdd6bb1219f21594df9a27af7e28d4c6cb751a40ed2b29cb2d9b03d21f4ac954aa45dc03d4bd02152381718250b599ce6571561b62bc6f3549f45d31b9ee3b58e2e4d6deb678b3d372c96146330284c0ff92f84a8716893fbd7497ba67e3b48156fcbb7ea77dd341664cf7ac9b9d001cdd61b60446e194f3eacba29c7553491712551b483ba97d31318d71fee2f16f8e01cb73e7bb3fdb05f2140a81d8df6031fdbe357160c3612a62a0e2b64f3894d9438c5b0d1ebbf94068fb5eec7582884cc9562b92ba18d714dd304a8fb92861d8bbc486e304d82304fada44b61ff693628962d78db0acf6a85544d8981a2816a59412f8fc3064a7f0b3bc407fff54a568e479b3b521d264d012157bcf3a885765285542fbbd227e25271e4820e1aa75d1c1482ae7bca7f43d38d2517aaa8552b42f405123e9a828d57e4c79b1b4be2d4a10a9848a9b288fc83090b549a81b99ea59775b30f09300765f0858bb4bde6b5fa3c1a3ed64f021bebf150b2b66272ce0bab20b5901fd72a4744169a22883c0f061e6fdf4c71116ed12513ef27aacf7bd8c8c3fc09ba713ae6b8fc1d57f93948f5cd364ce59bd9604a35fbed147347ae53dd118507a28830df4b2e168d7e353d5a9b7a4a9859d05c5838e121f0780ad3ff5d487721b804d3d7d7d73c444f7aab90df00ffbc157f4a25fc64a1ef168fd0656ba179bf92834f276fc457f5a391de18ce53e00f76bbbb479f4d54777740cc961c9164e807a9d02b43bc3b9bf826e6e774c6173341481e038bbad42e9d6ad30f69b4d30a9224484893fda8ee6476c850dbdadb579b739ab0497c7509f0a1498be1de1316858525f823c95c7a6c795cb85a40a580787d2244b2e01c09239b6d39192cd63f4762ef3a199af672a49779656f30d93bf02f381e6e6fe394fb4c68a9abd576657cd3d80acbd50f79d8abedbe3d5f7b810446dfca6701cb8c14dda856980397df3ef0ea931989231c6a4911b49fe4125296cd7d76e47ffb8a8315ce4454c1ad707c7af129bbb2896e948e9593704f716c324902c7af8ccea564fb9e0a6642962c5d6ffe41185a15f351f7eeb384aea6b09f05deddf5494e5b4b4749828ba47818660a92cf8679fe5342e3c9bf4c8445c9e8b481ec6b5cb6802f5ce3b9214d2b28ad0fc1330a7a2d15c070396eb909fda210cb607856b39a061e43f8f42356d69366529758119f40449d7c3a6d226745451e4bf12436f4996256a2a1c23062efbec4090402364e59c4607f0df47721ce79cb759e5d96970cfe70226fe4a64ca522dddb69058019feff4e0446d613c8d57b96bc427bcc1267b992a80b0aedfc69fce06d21a650da6eaae6ebb02946aae1f2f1240a5fd85a7a2a1d1caa88680a9adabf80db54016f18df3837a023b2885917ef357ca7df66ea59a1130791cd197889cfeb6c9bf6162cbbc1b64a9a23fa1f97a87e7a75cc2f96c78b8fc66ea200cded704dc253df144c57c6deb3505f4761b2e1ca032cfe54b2954324936bb439bee52c347e6b6989c066d6a98e76ae31667a1ed8e4a7be373d93dff4e06bcca9991127518d3e843746b86c6027962afa73c19644b7f22be3040639635708354b4c08cab8d4e1226e17c694d5073a0cce665f28f6a26a306e6bd94bcdd00a183eab2642c7e367f422a4a5ec5844f42981b47a5363ff1ba141899214528f96c877b3bebe5873d3989ace5f83d29604198652060f0008e53e63cf39b605a11bbde4a94f5c79ee2178b36b3f565124d46039f36937ceb0eaa7835599f4f36846655ee17f24cfd0d26b9713e3c444c69aff44bfd73429417b79314ea18017ae99ea30e25b620523e27a6b5eba5706eb859a5a79c446b29b22eda194c4dfa6af22a53e4401e0997dac3523b7d40f7b5d2b2cce2ea9e6288b43151e9a42d292414582d3d0dcb291ec9ea696571827555581d72502f79c63ca451466d9c8e76db360d31f3dd0a9524ff2619ba5ce612409f4bdfa604a1441baef1770b9fc2c7ea689cd092f05e3c7c3858b6693444fd3f439d8c74bf95abd1140be355e7cdc864e0c4c1b0439d467645939c98cca3c301a643c2ff07bfc0c7dc61282b03f28f165a837f7d173391f51a929bc34a9209c04cae2155d92f764ccc7d87f1d9d350e08c001cf55661629209c1f2613072bc1130d25ab638c8df5f0e3889c16811a4124bf9f22d9a534206948d97553a4039ebf40997de7c4bdd0ce1802227bf61829e0ce3a54cb5f9a4a3c071d542f347d4271b9924810edf4cfd688add08aebd4e5e31daef15c6b8e556cae5c353c780247a750f51eea6a5d2f02197d90c0342509636b977770f1aae35b7f8b2ac24fc92b03985973dfc9ac1d68af3bfd3e5aaab0e4eed8e223a040d88bfcbb0a1636fe815dee5259bc641e2be8df72ed9c2e8dcc7e1379724579411a7524d53e10339b0d426d483eaee0735cd38fa7a58eef43c39863736cf904e5d7911485b4ca1a314aa833550885bad6abd542cb011e361508a4e476c68e39de1b12c3b12370491e78f0094daf35163ddf4f2aa1061b1386c39e4d36d0ca9f1b17b8ddc88c81716e611134954725f4138940d236fc9ac35ddaf7b09529cd81be433bbdf6b72329047a3e4103af34cf8e7139b28c59ddbf490616a62076d5f60bd62c53396594be5c52f1eea330862a3d30c749761248bd3f018789d04001df2ba26e4cc9f40df68f4b4ac915813099be3e0323910ecdfb7d06fa58a00b4b78d816ee289b62911b3bb5f034e48363539d9d6ed9158c11ae5cd3085fe9a653bc449f89728d142805add9994f8649216caddcb84c5a119c7982ff12b0c83f698f2765145e7d135cc319488c4e958b07072083bae7a9d9f30d9cb0a98f5d3b65137be60a31118a06fcc51ee09778707a15074f5507d8726b59d207e4d33dbb46ffa63829905b13889e78009eedffecd0d4b6cfa21787111e59ce7fcc636f2ded24043535ee7c7370f62d9a20f7327bdd0c24a1ae0adca2802edead7ba59481695e57cff36713cb389500025a46c713d0ae8a4a2c31318ed91d9a5dbe507e23691b33775d011ae92798e1ac996d4ee3fe16cf7e76fa87cd9c12e504257381d8dd531c2e4f426470fee8621f87475987f92b826bfe0411ed8cc361c0bf4c81fb4ee3c8ca9b7bf055ab3cc8c34d86219a281a9b95a97d8867123a5e089623fb83aee4ce398d85928d83ef9889727b455dcd5537282793960b6d0dccc912723cc38f86c7940a88a892bd3b33c72a86a0c3af9fc88747cfdaa0c0a682c9b366e36418b7a0e577354afb2a8e1d49fad87d2e0f3844e20e2d4764922103a4931ddc44c3ae3a1d64ba2f62d469861584c359982446f9153135ece66c098d8f37cc44f6451f12b7fef0bbd997cb0377739ada9484d5a971efbf72e0ba9f40646fc3ba12dbd73d6abd19e261285db6ccfd945551cf04efa85835bd502c7fe610f0fc7f0d275573481f9dbcda785b24ab1ecfee6110d8c4d6dce69621a41c6ff2594d795a59f205bbd2419ac514458ae17765d62045c47c7e368f910f6e16018461562e65b8b8481bbc26397e8c12b481efba006f4f8a8b43e6a344a020305fe1585f052bbcf58c14b3701026e7817473ffcf44af25ec2001af19ef1ef41051ee34b3b5210806549824632d173d477d998dcbea38320c8152dc13941fa2f4e1f490a54b8154580957c0a03e03f461865eabc0db0ea67deb16963f04d1646cdae35f86d7866292bbaea60eccdffc84537fca00841881c88ad16d623d480751d95e880736776571ae2f7e553810eb4ecd86debecd8f06a01e9a83f3c0c4b0352e6a9729f5af53edaa719a87a7b636589fbf1084cd633b2cc43bebe05558cd847f0aeee050941a57851ca59544ac109280f97cadc5226ee2947c9b960df93dbb6eef1cf64389f77f365bab2bd78ec5f5a63de063a2f4bcadfb6dad77b7f389fcf9b3444ee419c6b80b265d1e1dca17adc633a2d30f70b93f6a78f73b9db1467bab0a64cd5df5547a980c49d182b4708c6529b448fdd239bee2245a4e5a95f9d85890498c82ed8596e1ea49d3e0796e96d20cfa087dd5e4b7a87564a21e32b1c21b021acd5c789544d2ebc05ef7113947279a34d0dcdf106ec9ecb4cca587e70eba1839e628d3a0a6279eef295d758a25e73ec7ea50509810543db29af9c4e1f6e492448a30c0f5544306ab56996feb7c5c5f97a0faa078c8729704d06e3c6b51d52ccb74ad672e2d192f6a07f8a8f3a133255dd767e23ca1281dcc762773a144e92edf855e27e7c34a884777aa930e17c571cbb59365ba80ef401360e3f266e8490b0386bd6ed4278e4942bd2e1030ffbea468e4e3f0781b2322cdf0f62bf59882b4b72145b50900dca9ec834f323a05ef6017a99d34aecadb2f827654043e93b1ff501da29097d5d4226594a68ba8dc107060bb08963d9ad2d3676d6d506e74b3e6b41ab8f94dcb74ae593f380de047800ef3ff0cb49589ac9835ada64eb784b4e561fb0065e863165476268c2a8d80fa5a7c66800f86807b167e7edce32dec7e70f5ab344e19f7413735a74cebbe0558c0244339ff194216b487268f39f848d9863d4907caf8f187c736293b1524abceaa5b1e478bf759a57f38f3fdc6310ff8cc9a44e8c6a39bdd74301ee1c4cf98694dc4d119911fd418a33121e2910150baf40cbb0cf9f48026532b677d76803585dddd12cb9d79ce5b93eb638e5ddcfe73f39e98fff4346027c6a48172176bbc2dc203bed2b26737da8ff5f89fc6947bd97ce0f353b1d7fa7e787e710b881364ddc3c09c3386b7a393b7476b81e8b33a1e4ad79bb38b1aeaa7e42b41a189775b7f130d72ff5aadbbca8d43e6bf2cea405a5954080852537fb89ab7e6c445ddfdb451c4e26521578b9b6451c0f7a64020e856f4e305dac91d6e869dc83ad5076a10374ea8b00bc42c4dc33edbd96839daaabedf9fda8a210090acd2fcc853532e2f5f8e7276572185fb5524b2babc35c913c998bcae6bcfbbc3f253865f9deb7d314efda92ac091a4f772d9aa32a5e632fdf697479a884a9d42404b467f0ff3faa4a477f6ffa3b0288c903473c12900cbf044eb04c1a2a86cde1f36329e34e0715a4eabd0aec968113bec7548ba86f7e070469de501d222d93944ceae70c3832b45b5a20e359e1fedb60d517bff6040c8b0798bf481fdec17de96bbd93a1183f83712c5f9fcdd05000b175e3d38c6ef8dad9c87d3e12d5ef03b978a2d20e1af7b407aaa5e5e6f3fc1a5d71a90824dd9b37bc8b4a580b6e26fbb5aed53f17d8bd052d49d8ff5c257f55195e03ad9e13b01ececae0eec53b5523d650b297be7ef06414f99ea69544977a635334bcffa53f067116b267183e9e3ddeaa57ff6ac8c124010d00130f2693641e1e28011f5572c727f80ba25bb241cb8b3e4d6282dc8173c9e49cb7d1aca5e569391265849d997186f25a6477d8f0d7efcfa23cae8c2821c6767e927f737bc6969bf38803a322686eeddb7979c15f02ae0a11146a47c07f19f2086f205dee72da75b0a57a8f5555e5391525571aea6d5085ad170c0c6dd964a20e626ffd5216887b2c835199ee49a09b406de6e62855a38f808214d4dbf7bd9afc0cc65ba0dc0e13bab649761f3fb3bd3d80571db6714446de73d9e75cf8143b37af5bb2a4345262475aeed3fe49eb9e18164a235361920d82e50b06431eef3556f5c63a4929057e3f44f0480576cc511ec132109d21aa95795e4738d8447752a82e9413813bace8a40e6fd1f8697172a58e813ec225a7616758615aa7c918163b047699dd8d2e841136350179f1a473fb4556910da2e15da975e7da29e438163ceb7f2208c105485c5d70eba2b91917184f6903bba60e6f5dac3d39e650da5f0608630904864be5fec04bec115ebe374929d6c000b8c4370e1081aa283e49a525dfe532bcbbef570c6729c5bed4bcc28ec7ecffdade4ce92fe2d63f0ecf725c795d845d818f7efb8c4d5d4fd2ef7be414de3d4165f0afdd489f5270e872fc2d11dca8e275423e6356ff6a8680e673feb71e6c41f190efc361bc98175c391ed1bcbe955e36e5a0db18081f042b799f108d99991085bab4b28e9aa6fc60258542b17567a10703c72e2d0f8009731957a2ebd013cb9fb6a238d043b23fafdfca31bcdf2f3d2b2d806a2fb6bc073438102a9ab1dc95aa3a884ac8c965399eb4ed7d593b36ceccd44891e9d6f34da8f8c6ec752444ad01e98c1bf46b86f9981cc7273ffc3bcded6ad3cf9b0c2e90186a5d2d67a0e9b527d4a4754ad2adeab178370721c33f2123d8b36f5a87e6b68a2e79c8f36e09d153ad5a1c0cf125d602ac3814b13b7ec3e3c585a6505512cd896b4c115c499787ca8e225194ce83f7ba28bc3354fb6213d4fc25f42625bfd55aee6eb83586bf212ce51dae8a700cfc9aefef4b365e3fbba937ae642c8d2ca7ba181ccf843c504a8babb4f96af6fff540382e50b4d4426dc0e973f78ba890c9e15a0f6acfa764f122e66e730f2bf51428efbae93a954469f861d78b081a44f776479fa99b7c74f59a7f66d8705a5f165027b7304b7c1054a70c6a1a9e7fd6b6ae9715ca6e04e4f4db2bd73eeb1ff44ee3f43e3ba14086c543c6457e3a7ae3416bbdb1746b794acc43f54796f74d34ace2dbff2849d5a644f18ba025c54ecc88cdc72dd90f8ce68f70fc0fd6ed122bc41cf9c221db7c87d020322f3a321353fc91cfb56aae953b0b6931b9bc079cc60cf36a23543bca8d7935d67da850a4c5bc77cbb48026ce75b67662c147925aebef4a46149560413092d5fc835345d8c65ff2d7faba1e5b4d10563abac533de1747588bf864afa60621f08f5d10ebad4f735bd2f78076335ad8cd123d6ac9576ddedb43ffcdc7fa4a5f500beca40326e6fc36b87f4d47bdf52ad449230ca33e263cded9f2fd7bd914d0cafd44e22dd01f8627b8a1e0041fd7caa56af8b06066b0270bf017a86b0415dd78554cbfda97725bfa3e194f4aa88c8918689db5989fee925e0a5a1315b6ca61a593e8dc260c978e01c3c3911d87c186f0cd8297156f4d3b21f18e10cca295ea26fffcb3b83619fd4ec630c68999393a1d77bd325e74105f6af4721f95ff427e4bca237f322e7b263fe45849dad8bbcb1fd27b198da1793bcab77e26a8cf4dde146bd0fca5a9089070da71022c4ce55b0981330a7f78480a452d100387f0132226c60a52ff5b54957fe677bec18bd6926a895816eff58dd266134829c977fdf602549c5e6e425a601806b6143e2e4a1bc500b965d96d7aae5d5d34bed97ca1859f34328a237a965e059d35f9b47b29217eac56bbe0c640889623ee9dae5aaa9a69de5ba3be46d3dccacf630356f8d2fc34ee9c874716da15ab18aa4fa643db239c41acee61fc2477aabec9fba41678d74ea0d6abbe69b33ff9c9c807aa75cdf111b9c7e8f192378bd61d2dc0e3a60004ad26c35ef95a62bd459ce5c1a6f453c0d5b4bd1d9ba1d2658ea71e46ba549af000d5401f58e68d5c11b76794e5bafabf2d1a384b20307ce015d0e3580962308573aba4102fe4298599914f6bce1989b40f7c7ba47b3bc2b04ad2c14eeaf316ca127b50b6e292e2035b3608db0fb85871934604510dfe0330f72958dcf470f790153c2b357af58acfe1d9653e61da3967da467eaaeae255fc5fea4c21f6754f91eab782e741d0dc7bd8c028ed9f3ee772caf6c0d6498517ba4d17b0ad7bdcd637403436d2de4fdf2820f91f62f17f5725da430542c6ee0be20c2314fe5a73763bec93327c57393ccd189b071a41aba2aef3281bd60a85143741a093e2f6a096b3212750a24116443a0b683280135b9e8e1b73825690218a1aa8bd6bcba0a405697696672a7d6d817125ba8b4ca3ee7dc6b81403d9500b790c3479cf11842d657d663bb06c13541f146d38a009262d96ed3b2050f43be0aeedf7b006e2c3d687dd96a347327402510910aa62588bed0c66d6679dfbe507a272f292f5cda933f5c6953b874d98d8c5c694edc000991be4034a296a1852ca99400c23e629f9033441611e55298b03a52e07f208ce55e4960f79af9c04a63dd8a7a0639611b21d9a69b1b4f5f5e351dc0df76d6d01db027eebf590661288f8e07301247dfa834b36df5a1e7c7c8bd32c2acf0907d6082988c44988cadd14bcbb88f224e83d1e3752f1c02cb7ba352e34931a3e4084c72cd313e0dab84f811e6c5f06ead714b1b4f923adf7189a6235fdbdd0130aaa9379a0e0745f9a072b1e60f399c2671d227581b6664bf584224db79a574ba2008c6abfdf3bd759bf9451ba863a6efbbb613f3418a347840701f68730088d40736799f05f0033e851f0ff7e805e69a64999cafefe24e30ae5a96950cc1fe8c02d106d12fbda9584aa51924447c98bd736ef7cd7c2b4389d389fee4a1ea9afe7d456415300d809b74f32eea9fe18898755d2d6c557bffaeceab31eeb28b36c53cde388a089bc5d26bfb3e675dc746e2cd291678346ecdfb3eb3687dc01c7023e8efc10c61edfbeee673fbfedeb052187195e22f3f2c84b3ba3380a89931798ee348e75846c7460d9b4948c6e8351fb6e783ad281365b5c580d6c38aa5a7e79c1c71331cbefa573a670ab181a2b5ba79cd4a3245f545650dffc03c109236a5fadc485ef7410a91b6a999d539563ae98347e084b1ddc3af51f2852611a20ededa030727bcdfbc3f15e9cb13f3e58513c34c275302fd04f15df1b9953749479b65a335a8dd60c2001dcce98af08b6e4ddd08832772d8efd5a32ddb7717731cd620f5a4249a5521711ebaba3b6f3e6407ad18cb7e781f411f2fb60d7914d57c562952cc9702aa3b38f9c08468c80b3987b191a33a6e22541d1298308dab4d377ae4971b63f113c283f33a0b9fec0a72499ca11b5a209c2784529f8e06cb9017f52f0aa72c0b0a077f8d53e91fcf08dfeaaf6291edbfc34695138735675a0321bdf1e12a04e83fde3e9f997d7030986aa21a2fa5b03599273285bfb17e4e639b89cf83e31b9e238633a529f7153009c096b6fe5b223d0a83cc49ee4e402eb32a516b546b90b24191fc20d57c09db5c3cac8febfc7014b8290d418a1ef18799ecf20a270848a4519a372c9acb3396f654ba8121047ce1422b0b63ba0fb4ea3156b663388db92566ed567ffcb1c10e14da07b468964dd2409c3d02ebd22f86c749c7099c7e90d2b228b3ada46ff1f3fd65ab49dda98a2328907dc45506373f04a9ccc5f671d6f154cbebd649ff98ab9c30b5ceb2affb5f791d974db9a5a9a8a25d61f70a1decc6862b035568f99d965d540c970e584f872ddd78387dcf7e5eb2d17033331a53ba9f8ecb7ef5f746a533de0236066dba9aa6aedf5d2e6c3caca76074bfa7f7ac54ff003ae0320a553cf2b1b308264a073729829ba94b35e833e0aee82bfc7f0d95a6ad479101faef17d4053f17e53baeaa0a2d83b13abbe8719886c283a9308a7b0d04c79b8ac8906a1ae6c7cbd0af01ff2852aef75fc91f41dc9acfcc2daf2d4bf3a20a4a0c7bfef8d666b2fbea57c1b4811019299eb3362a079cd46421bbf5dfd1a343dd3840bbf0b34edea8b1c8cab45474768fc285c08c8faca5f7980de6eff6135e42cf4beda78015afe136d06286d55f8cd23606546bd2880418760bfce47f85ee75c3dce540f96eda3a29f78f53427ce036f93bc176903e1b2fc1eb92010128938b9624c93579edfb2fc639cce14a447406f72001c8ca63d9becee2589fd4284282f1cd786ebc9da2e6c367ce90f2b9b7a9913900013ca6c7aad71e700dc460f4bc1e4d92c344a37165e5364e31d423b0bb0031c306b3fce646709e9b0f0b69fd598c2ec50b5e7d9c49290ea1d94ff610f78310a3d715de401ad64b37f5a5d1747072aa578ab27719e475c29661ed65fc2f8aab486f3ca3cc7488154c46597bd3e8e5a6c67aeb33ebce95f7fc263303ef48b7c31d6bbe080f804ab8991915773194b683e3126aa2b9e4c011f99e87b016734c351d73320ecbc82022fbdf33f8888bed8963c325d3406c27d29c86972c9b1d4bc1c30cb6a9a7634e6f058ae282a809b86e255c55ef1e72c561fec321a65cb93dc588181997c49b0fddd782f74b2b17c41e3891dcb14663246dec5ac0e83e167e5f998edd3e36957e22560c2c8d045910c8ab3192a8d891a650f73ab03db5a1419096491010539bd5bc82c4c1e5993f78e3258502de8b0dfe6e20fc76cc68e02690243e7b9031732506e40f65a1e5178b9549fd376446688112b70f4c9e301fc36cd14a7f080f6eb28a9a01a99156e1894154ed80abe1569dc0578c1b4f5e86cafac1dbc4114d127c7ea2f613e2f8cbc80d4efba48649d41123831ce38d0c594536e0f3ad524d36227488784d4807a613e2c731d32ecba3a6634f339988612c043da1ee650bbde7606d42db11e4b7bc751c4c97a7b3b29cc83cb7771e8d8c661dae09fa43e610b141146eb42ed28779d42ce285eb5241dfaa94e2d481b1225f8ecb8126b75d0f0a8838eb283486de3bf7f24a202cc43c0a97fffa4c13fc177d52bcc74922284621cd8e93c4c290c658cf631ded267e631517545f35ae4dcfd2b88b8c663fb965cd0808f112b6615358e78a1c721c4aa9809e47c3068b84f0e815af968278c313f8de9eec95820713ce3fd5b0f71069b80d712c4a7577f43d73d8224f587343339c341494d66c1c05c5ba9989acefec00f0de7c1fd20aebf2d8539ff6c102b56182c7f61178cef0c0e181ab0d492bd5753b7360b2ff7bd9409522c799550163b7679ba6e280ca9152d1e72f5c081c499bedc855088b08a7c99f6ea2281cb11ae317b4ddd3c7f86f4c261b1fdb94f0fa132a526c339b76110d0248816848361969e7297355e7c2cfd858ab234e4d0ff4655a481733e6d6bc70ed772ba8a7e23f984d6315c4a3be95f22ffadc2fb9e3e9b907035c9fa8a69dabd28e2fff418853b0bcbf717c9523cfe5eb9ea218b73a84b737d2a0931f72045442ca2f4b15978dc2ec89af05ef9d2865e568f09b4a470ee37957d85a5637bc44a61307b5edb1260351be8590f92820abcb6e89def1336d4381479d73f3823124370a25a0a9bc20653a286a662b90979b6f9c5069823b7a772f5b6c01357cf53f28a7a8aaeaf5d256e0e81f2439f7bf3b7ea38966f728923226761845dac5c48c04f4f3bf0dca5fd8e7274d09d93f64c4545533bab4288c1eb74dc836e3f1cebaec636e239c046588193df3249f5ec911cba11641dc1f79255d92c6aea47c7c031a7dece6d29bfc5730bf1cff325a72d8ff9ee0ea2d9374d20c2d29bccac30b2a56d17c8b41fccf59e937236e9eb285b90d3c06b76b903f10d5bdb78ce0334ebd78f5a19eaf3e25522c90e292581de3ea4a3b0dcfe68f7033e6c7ef3dcdaaeefac845a25262526571ec26269577ca6ffcab7689e170d5bbecf3f894ffc2d1ac296f4fe6d1af07e698121050a3ba9970eb1dcd7754e42d84635d2b718493857c690ac5a4e6f3d69ade3ecc0e13a46d574db94ec83df69d6591e7d7beee55bf574dbc26d66f69f127cab66ff29d6b3d983fda6d7fa7399390319a1e534f71b843c11b7151959e4631d74da86869fefd0e6eaf7e79cfaaf6bb638fe29fc358517873e6f75f8a51f0193b540331e5b53811d7f694c95aa6d69b8644726ed26a9167dc5aeaa1c18b43b06e40575ac9669d01863882291643c259ee0b55a50d333c7c75ac7fadee073e5a98d5480138ba92a9f4983f32656483ed93317043e83bb787c391053b6bdc21310619db36731ee4d5c22e94441ef4f3e0b4c88e08ae5c62acdc4819d64cb161dc263638a476fe25d0ed2d4a52900b1cbde1fcade6a2ea44bd9d1a1adee45b8535cdec72e8f9a3d2d4a298567b39784623c3762de9f642d28b18dcfb7677b31257e20d2aa9250dd91c2b14d0f061770566edad27361db81799237cd5dd27ae522ec91889b60a7ca002ff4c733a9c446a35801823efd8b86cf6d39f490fea15fec17a55b5e16ae878c2328a698cb119e471bbfb8fb306590df02bd4b7550633d1a0eee8959530bfe4ea2fc3cd6b890337a3d8b1a671e1a985fcf682ef4e0ff0d8d84039398fbfad3693f10936276ed58291e08cc7cbf85acda0450c15ada4748cf14f40719539efbda0b690ef3faccc6f460a73842662d1d5f224a16a5c24afe2f38092705d86d4374f5340fd1a87544f82256eb0ffb1dbee8c14746c228df5fbb8457920c114e3bff26c503b0db35a0cbffaf21b48ebf56f24f4c1d5ae5071ac9b7ef9f3afc0b2b26a584c4b176d34d8f621d4cc6c0cf258ed6986436423c90050ab5c0e245daa75b463fb885c1bca5cbc9769166b8568a3f084b49891037873c7e4ba165a2d57b2823080d248c94211fab354b56a626c2d30881c0c89317336dfa8d57eaded072fa5e09bd4684d9f32b2a81a38257a7850fafbe6cb1a2d915a55dba8df4138a448f68e5cfe343cd9c2163941ca07d062a51e9f0903a096763278de462d79323f3a93b1e59d79a03bf75bd8980f65fa13a9b6a9b239f181855bd203f92b8ed07eaabd72fdf2c1860102a98725287d95eaa3039fd312b8b997b01a99f3d2ecaf37f251087b2d2b1bd12026f7753858bdfdfc5acbd573e6e16fabdbe0fd631f70b1419a7e7379e2ba618310740e150fecde45f87dc68562d02f6c42c33008a084d76e1e2e2e58cee317ff3ecbb5f8d7d60e573b0eb451cfae5306bfb8c001beac9405d46ffe5b3fceae237be432867168a900d2bee1f2729bc88a854e190ea9fde0c3ac3926b4c785615394d5c10cdc7b6ab1e01a8ec20bdf6d5d5d5e34aa0ba8649a3717c09374118c214124714fa712c9567861400761509df11a889c5aa15ce606ae426955b3520807679a6ef1613740051a3a8efdfb2ebb5f1031334dc9fb157fc46dd6ea6bcb99d3a2e1cfd4586b9842175184b3a039ab69f0e7df0b1868cf4a2f1cbd74542214f04e7b92aa0ef79029d0b30aab9ffa61efb24435bbd03df8274723c48b55f46a38ec4f1a9430689094e626f93f1b7511a222bf79b46011523505d178f5110a5148bf4fdcf3d7bf8fd520d39a23e6daf6535061fca7a19ce840fb37afbc4daa08d70506eeb514c7d0fa489bf1ab2db9e38dae6d3a2db3b4705738a55c03eba273d102ea69d95685937f9dff2d2bfaae36c9bd7c46888c217c5f61d86410e3ae2c32a85ea04077bdb9ed3d90f3131395bdb80ec2fd6275d2ab3199b43e8f5f627bc41ceed1d3b93f818cf146321036c2c5b51ac83019d7fa1330793a41c76d02a6876500c78542135513f4ea9a16a8a9202ffe00d873a541204bc974d6fd3f5acae2e0ae4f6807cf70d6cc709de4cfd3a891c2dc17203fc3df4baee493691b4c268871bd676ba677e434732681f88989f6530ca878c3440c43eee4c7924f9b1be50c6503b6b81a0a1c93dc5a9a37b7f31a6ebbbb19509aa7704382a89a5e4dd966e03137ff6965ffecb13f0d501579caa050ae868218e57974f0d22d22461d00a607f4220363462eaefa4efeed01b952fa61d2dd8806c2311d8956a478caa073489fe0c89878fb3fc8ec6e17fa35be3dddd759c97fa0215370fbd2017287d21d1a25ab3f84ccffb030e5640799fa6810c4082a98ef2ad27113b2b294cb05e853be7f9eef51c5b77916d77b3fc7b90007c4d1595b558f50857d33135af4515fd32f56fbc519dbe47fd566632d14c2952dc0f9899cd7ed2e4f53ba8c86d51bae35891d496181cf85a6680c36590a5d44218047684e40dc8c77defeb4a36041c8f7f54c040ddb52666cf8a260cc41ad64dd28ab32c88b025b455079c4b8b0bab408021e9bec6ff1fa05792c8f47334a628bfa37e8fb72850be3881ecb638ece249a022c26e45b0e90d47ef2dfdd7a21600c20abd3782fe7b896bde51a2f5dce4944584ac213f269a3811b5f354a3cbcbc56d5fd944be5435b1acbb40b4930988e52aba6d6c8905108135778c6fedf1fb44c635f21c2e1e0ab7e14f6232235221f73220eae13bce4ec396f5f5ebcd27d821384308fa81ceee4db39676e9180d4c64639e11ff27d088d0befa335ab1249a96188d7031696568d677be4b1433fc347d4ecae4dbe6214575b6f0507d570e6fbf279c8b604ab57838be5a49070522d8d171ecca55f405c6d784578560069daf657c50da03f7df15cf50c9e31db9293f27ada4000f2e174008300900e460767a603f21c172ad99337b83086becf190f08e0c07f305fe2efd15b1b6dd7fea5f3d93f96d402a5007b24ff8af3befe7cd225c5cdb018bef54018c71ca8cc94a266f74457ccdb39e7d1a0ec8e6b5d39bdff23656d22f5c3aa4835ee869949ec3f8cffad3c3393561f98a07655418838adae8840c22b6e3ac65f0503b6ff68c8a39cfbc9b165578740acaaabb8d69e932a0797a963834ce576313f8b23273cf6aac4a32da23abd60c6046f8fdba500c111f06b79f928aa23c743c782bf507423be42e08ce1e33ad14172e5c4dd99c1daed7d308a75a9bc0360ebcab3758e2d39cc41cff87ece345113b5248228a9b9474cbe25ff4121c0f7bb679492d791ca0d700d54b5bdff0fef694bf817f115619f8fbbc78577b9f4aeaec5fd1f4f5e3d67fc8cdd01859526ed1f94c5b10e2aad60672156003cd48de3f8d8e113d662bd3822035308882c48d2952fb754d418e298485e2f1503b2f066bc1d1f375be117c1204c77fec35b88768cf1f480c7fc7ff6d8d4f8d7b514c1bd77dd0768bf6a551bc69610a15908590f1895d632160410bf06c085c4fa55d30d4a5370df4df45cb877ac6eaa96895b668fae43617f88bf109d08d48e0e4cadd74302488d506f9e4c70677319ed49e9636f47d47dace1f1f49123388cb4e19c87ee0c2a555f66a561dc12a017a366657b654cbf345dac58e6f059bd30e56d8d538c086f7c19fe841e3db4ebf11c9205f6a8b52b29a6d0e257d66280227be16ff72d89f54ad6de9e337776b77c598db5416c8ef71c8c8fc5a8bf7d49b9844b6b4f11bdda350ed963c6d2361fef5fed2587b9fb373a93ac89b90b28fae9948f78c1407e5a0cf020fd1be5a0cb9c410bf01b7c3646d98c80cb8a440760cc5a23550e86d9a55a618f6ba38ffb5cfa158af8a67e55456611823921ec6ced9c90532640bf52a9456240d9f76f452284670eccce4a8c978bacf47d05141c9983f1e6cbee3b91d698a718eb0d0f9d13a8712d1d33d109e4f0ea891e9fab8abad4f0eea2f619d1e8f1eb3317f4e42fb841a3e893e96feabc233acd7378488790296587a9493547d72b4a8e94c55fcb669db0a3db240a1e55514e2f8c8731f9ed6054995ce558dc960bd763990c3de3ebb559dc931c99e7d7048e5929d72640ac3e7fb905ff8f461d23867bec79f7d8cb616fa5446f55f3ac56c9a3a3e869a2eac9b61269be5f29cacf030c3964904c4252ea8bc3dc02c925795901c995a0ada28914ea7b102a041ef9f918f2dc68a4d421d91bf6a2d4a7bbe622ee5f3de029985d7526948ce5ba293a6de2288c2f061be4620e5cff1748bcb965538024263c9b72fb9cec75339a86bce828160f60ba765996ca5c081c684664d31c33df038ee38a8e2ee8c4fa04632b13bd0142d0b0b58cd079d80ef7aa9940de74e1aabb9505ed65b59da971f3b86669e3a552561efae13166745dcf48825bf71cf1608a0de76d348b060c89e1af2d0d8dde7a6d1738c72f1a169db9f3447c780fac34f4637116cf03fb283cc99fc23aacc5c0711e5cb3bc04cc651c87fd734ed72764483d1625b472ce9fba5a09f02ff77dab6ad2ef1ba167314324fd728421a1ad59efbe993b913e2c7b4247dacdb8d19e521b96054c51d5c916f69a1ac278e8c888edb2b586ff0b4b08ce82ce9fa865de22b2906efcd100650f4cdc42cea370c78c68e0e3d2bd85483e42164f6468f3708199c133fc1cd16e24d60524f9b52fb1a8fdf4c8f51ffcb103f935dba5157b570848311939b73cada94037da8e14748ade040247660963e72c8d34a2dfe7c19b7894e849edf6c76d30ee92fbf3309ab3a48e2a703d3b49f77d5cfe265f14abb7c7275811957ee3bf9debd04872a1746319699ff0dff7c0a8fb291cfd05be85d516e449e107526ac30b820bf705c0d06479bbbd93c14ae6301ed26f71f13b157e9fae34d300599f2b85e323be4d560aba809819e637a91fcfc7c5b5c576cc2353b20973f47834cacba06bff9ce388a9cf0070196688c9fe9b55604153096dc2cea16ad3ecf982deb41bc7bf486a1413f79b3df79aa6e5bbd3287690106dbca963cbaaaf58473409e9aab80600195c61f087ad4f4b193039b39b78b0c4ce1b7adbb79c094253a117308a1835905ca48bfe9dd526451b81a8b38fbaf87de89a45aac9cc4c55cece17cc163c77f029b705b4b3636e2768297464152651e7337379779276c9926e855a95ba16528e8bcb59dc83f2cb32dfb015882814934c1991bf7a2e6c89d7e2f61df4c03e42b6116dc5557926e2a49715907b069c358da5856133372a3fbf913298ebe374a40ec85bd93f96c3ec37ce8fee6419b9bba751fbe282e5b5a2752301adb8b0752546433811c38fb7cbf7c4152515442e4e81579728e10f4e796b58affc6f3fbba612509f20afb3b76bf98e920dff47d0bea43fb9326a574aae0930512cc982269524f9864d1303df646cf8e86ba89af84e688dcb36420233d3cf9d01b72ffcce93b13c950213f63a8d1c5501f3300cb3697a40808baa286cb6d9df8a3ff4655e8c34e276845c0081fe59f550cf36c885caedd2ec4db3455acfec60df3c6faf340bfddf1c750ef92e5b5a74fcc0d92bbb45371a0f3ce4c6709651e98d309081a04c480ddf11c0f1c6e64ce626b9f074f3ff28d7d40bc9aa124dafc3bb80eedf9ecb850c24564d864c86f1cf207ef2605a202d4ad6f271f8bcd30d58b991f43f8910d3f551118bc77e3bd0e68b0da835baac43577ac81545d74a77b594be256a53b4cf14fc87ae365e849fd66bed2249edbf97b65aadbc8e3ea076b421b8c2b822b58469fc0e0fcf2c47ff7ddaf1d5dd3d7282828f0e3876add0da76510c866b5290580fe80eea1093666a9369dd1069475994266fe9394e2e81ced5aa6ab643f12ce5cdd34b47739c71f19e4503aac80c5f59dcf2b50ad652f3e9c3c57519a76be329b8e7829b294fc5feea28c8223493d26ff5545c5cf56c073bec4bce4c9ccf059f1aa34f8de0afe98293d9c089526b6e16b7a5ca3701d5a5cc317678fd2aafef94c1b026b8636f95753c3da0740363bfcd7e8ecd611c8d740c6e078393978be3cc3d9d3d1b31dbfc20ff8575036fdaa8ed4df317644cfc221867ad9ecfefd8b841ece642bd733a76f0c165c59af8ff98d17fe20b8a6d991798a15d50a614b7af484425bcb9f75df9c8de61ecac173e0630aecc940aa311ffce6d4aea7d525f2c6164cf53a7cb40429459ce35c7e2814c6bede8c2444cbccc61deff1dcb024d0c5151aba37a57a31f03d00a02c0704b5bab1ef94f86e13c7142f30067e0777116b91e1cb88308e82c32a316191b8426384757c013338d407f22acc543794ba96f1149b0f01f854a5d8afeb2b71b4232de73d7059b037eb7749d5fa8fe504dc9502ee4dc3553e2c8294877d6405c42626b79a282e3a618da73e54264f2978055b07f6b8f0ea60f7213511a5510c5deb54749f3fd4c9e0e1277cf718eae2baa19bf9e818ca44c62eabd31e2a548f80e8898d99d4c48df7a2d91c6a13a58a3652eda03c49ec6efb92977b3a7c8804c76ef9d0a017bfb81b71c83c0275f72e0fd8cc5c11cc1d83f6dc30ef8e073cc71cc6feed933fdfbd9325668b34150ad62ee4951c826904d0aa061a24438535dcf873a9ed5b52e3cb7ac919a8a8297c55241c78b627668e70948f1aa745b0ca813a90918bcc00e03d9d167b5e52d42f41ef9b63020e2891421cc499a905e214c954016f9c7da420156cd9102d9b95e2e2f0e76db854414f85e813a2b8ed13d30e0db3eb8b5fa119daf4e515edaebca33f218b8b7a9744708533eb37dde03f9217b488a1dbfee9dfcaf7f0cb9f7d18908288921b779912468a2746b3b5ffb987e7b55c5b25031f0cffcf3c22c25fcb6e0cd95e6741bbd85de6fd6b8342d95e148573adf354d3d70f497cc6fd4bcb98d47bf7135b59aefdcaa5b6978cdb580d70d038c8484e9040b5711c3085b7607b369f43f7596d46cb1eebb6a3cd7e15d914ce49f0c3641f91b63704182b97a5205551cab32c108e495335be7cb43855d1f315e2cb41056574b9e8fb3c8ab7e0bb2f2cbb2de7d9488b2c497920a057e34dc0d63b5d1e94333760202b6ae48d3a12786cd0f63903a19b88b6e9fcc77152fdd433d36ec9080113b0e10316461dac70138502bd0c6b1538f4d8ee19c20d4910ce51eaac5cfdca21d2183d94290a32baa7ca7cde8b41a58c530212671ee9fb32774ace0c26988644da303190b5b0153cb2e83104d8e3943ed8fee137a276e42819b7297fe40ebb10584fbac58b3d76682268b2aeebaeb3a069fe05190e5011b3bc52b5f4fb34d20acaa64a8622a90798fcea0ce1459fdaa2caca85a0481a1c3696b0fdb1a133c0f2c3b62f3e1c23fed996ca3da932ce605595bde3e370302e2e198bb985d339a115fd8c72b9490d0648494b45896c49c5ba38d562b3f8580b9e9866c76c98365dc07845678ebfa5d9bd70ff3abf799966019a193c4530f77b6fe80a636e553ff79288c28da712995844ab09992060fa24a8d4634def1e1602d44c0cd2036980b2f4e960d21c3a101aa49b8d644846540ce48a7b836b676ef33a7de0844c0212c190d1c43b9190ea11794a072d7315507278649508a9ed12e4a81744a8a1f12d0a1c667940ed78e1c8018c14f52232dfa68f243c0daa29d9c064c772c2f1364d7c810805d9ce434d5fb36baae8d35ad64231c9608c2c649aa056ebfaeb3d328d1f5aa9a8a49943d923b71fe0c383bc67392ba4e46fcf393a633f2bc32fad135587f9121278ca0c4560114a3c85309150a7f5188cef15021bd0ca8a5d35f3bafda00781ef674353077579a2937080c2d8d469b79cd898a170d31ae14f417dcad834e6d6c58c280871ee89d80b3fec7f7f21f419f14cbec7f0cc3ae14f6291473791550fc41077bf255bc26598dcdbf7407ae6d0fc452b4213bd2e9b407f917510c1ed1d8eb5124b601d06a9f926123888508cb368ced811d539c2e7f26b3ea7a38d1b405cbe415f300a928beea615834d3a27ddcb085e6ac12fec1829f2c6baa106945ae7d12ad0276cef1ca971c4d2e5cae400ab989126d78d6870870df8f0f57a201531577ddf0f9d127510e0d01b220b753d3dfb677e665d94d0dae094563422c92a34d2137e618733f56de0a4965b7f0aa761071fb7136d4b391e82021ac69d133fe3e74f9ba94f26ab88cb9b4a42a915643316567158330eaf628c9f2e4c01b8e410031aa55799ef1f4016731b862c0b4f353de5a1e00a0065a1716531e80b4141ed92f5d9760256fb6cfbb0ea0129a6bc5ce8b59c0b369b15bc6b73e2bac87157edf0d5f5a5e5214cde5b80066a136bc24cd9cb0318ef4ea1c9aec380943d068ae4de25a0ab9c255380093c4e6f3ef70c4467cd4b5f16a385d2c6cfb2f7b29443ba9afc4ed31025700d385160627a8bafcd7b8d650a31810e1a2ebb0bf9bcd2e1513dc0ba2badfe9c9448af14a660d8fde6ad8a05c265e092c48ba0f031b63b2ae4c1e31f462fc8260949627f0cdaf3c44a878119997ca9e24f8a4d2a23b48c2f85a1ff7abe20327ba5808a63e96b95d2d548093d1409159c1908bfebf709aea8a31c10e5f2b5cc457721f1ed05b5d5cbb93f0fc1da9f534af06b8c325f0f871e13d5b23e88bd50d90ebba66bcd3cae46e830fd3f558ab7f3da99dced7ebeb3fb423dbe97469e6ab594b756993632e378d135becdaa2131037622427af52f6dc14783165229987ef2fafc5953ef2acf19096d801fb94f524b8590cc995c8c6f54cf5754d727bb4134960ba9d1903751dadbf5500b39804ef16f545a607dc61c7eb3daa65e8df790c08e03a39aa70c803d4332aae3cbca00385b9e6253dba7b238cf7e02d91b8ecf6e719a73a51a563766de36a0f8ef26245e5a9133e13c06cf499453c95aa154bc10ab85ec4a55c686a776fd22308651aae5bdc0a3032779e37909fa9bc17b223570495b603d688c2777b2d6b64ec00550a7215f12030e879fa8887c5fc0fadb07284503df4ebf8cd0429b5a41d8d2b8e0ccd534833ec153773df898d2935d3c379bfba1c3e9c947dabdd5ab93620894aed525f846087c0e42e8c14bed8d777036395830fcd2153cf75a3b94a000729b9c2f9b32e24bb9e3f8fb351c3c9683c6df8fe74be45c2c80c2a3f850464f66ee56be8c8854f24c5690b1effb0124027412ca261fd10616895b8a1c40623ca97afcb0becfe8e0eb6202f207d59b6c27f31563793547eb413febb1daf016bfd1023473341cebae377757f87d66ef89b5be4ce3ffedda530cbdeb6dcf8b2b196ad5c94eef3d98ef97028bcac48acca5620ddcd4c6da93eb952fca73c6ee2df56c81fae4ea4b2b323a47fad4379c744374c47cac772023e32823b794934ced0e4d8a5b40e737b714673b826f51cf85d2ea23610e5e5ab99c43e983519b2ce1ede670a4981b6594257204a48990b1082d183a24262daebd58e4823b7378d2c9dc48c448e8431aad567127427097644d328a13f2c641bab252646784267e12108d1adfa4d98a6349f2140b6f21cd7b490502f702dd140e6997cb4af9915d4da65a755549feba15e58996352e824e7cd597a6668c856bfc7e3769e1c02614f8bcc22405ecb5c3aa9b36a53c11e193069304337c548ac84b08412451334dfe071bdd497129ddb6d7f8ab0ffb70e4a81c8c014731d68ac0a1715ea83c526d37d3e08aade1f8771a45ec8cc3f3f75daf370aa3ef4ceee5a619c2a264aa225dce557fe9ffe58c2926b058bdc446c25afcf499f08d4a11d56b1c22c9c0f343ad1d367f6b0ebe3b83b88a15a637a92c914b4e21b19ba53604dcb6ebed4ec94bd7628f06bb53aa992592a54a61af25b4a56cc9b775920416f3cae9d3965f9d4daa1fcb36459d8abacf0c474a49bde2d7fa48a106f4a914bb616c8fc459004ed9cfa26be3036b97a394657ee7c2fbb5db5961eff4791424513a1cd0db99fbe5b4864bbbb413e5da45e386c688bcbd3d99ce703154c330c9a34e517171e44dadedd5318a57512c75a0245727b1ae995b346888264989df3f542bf32c573d04b188cfe90d22bbd649c7301417037baf7bd946c7a916b3c65b9ba1c54656c5d6d4f2fea3e84062a1a49a9191de7cf46d4132ebf650a80a4ed046daefbbff4c363433969d591d7f9e5d03d728badcd27121f4eeb39615c8ff4562c4ab94cf5814ab7d4ad137aaa462aeca4dbb1fa4fce81465147e21275448eafe880661ffa48a8fe5efb116510f0132489e9b45cd4908ea175b8e0c5be427f0e70db4bcd8288cd90073e1066324917821f8acfa7bbe75b2e17237ae102d19ddc6b09d796e812a56549c28245a6fabd0c055c73a8a5244e1437bd3d4d91a8c4ce03d49ddf9056aafca724eb757982c770a5b459fac529bd3fbf8c47f0191e0b19fed436fb766624483605f6ebed866d9d5cea69e051a686cefabf7f585018c800c6bf12c9d574710ec4eed0003646308d363db08a3524c30cf6ff12aa410ef537f53445acc08d3573ea7757e6f543e784554b00e82ff1e28f2c22f321c0ae639d55b11bf021d54d17282da706bec49e6f5e5971f26b9544f8c0e207ad87c13ec9f7ec3efd5165107abe41fc5add7630d4979ef2b497a8644ba29b433efd56c347036e6e97fd2469661e365663e556ee21a8822a33c5b92db381614917fc2b1cd2004cc93ce2e3f98f338e608647362fd1d971c126b77c06b29333d04e0ac02c37b37ee2afdee4b42efac6b80b52fdd617f3e935ea77a166772fb46d31ce2b79e81e20054dc42fe18011cfbc7b1750a13137ef905e7d57b509ab2635ad4b96571bbfc10b4be085b67ba207226ff89559f318a79bdcbe19b70c1a2bd77584ee69b8fb1e6e0166da8e21c4fd1f3897df02a94950158f5ac7a3c4a568782a0a7e5f7c4d5fe40bd9e76057b67b0add8177502ef16f16e8c1f24989542c9192cd0c31d5b6994e99cd3eadc15606b480eacdb1c7902d4a5595ccd2e4377c35cd206517cd36b49d57c05a8293d2b7280083267dfdd3b3fff79e8f3c0711c81e485f462098d7e3d8d7a49acdfd052f4c5695a637f695eb1e76d86162728225082d63db3557f9f8e0f11f99160edc7920dce7e5466539a356e5d174260d4c8776f3cefc5592b2770a89fa27888d44ed06d2e9dffa857ab30a93270e2f336a2bd714d55d73d5e51e5f33b69b68950130bf3a86761b4df4e9b09c2d3a0b4079566cf097ec0af734ed2fc73e75b6273df113ac4930ed15b9c326a019f0515512e43d1c9ce092aa3043fd4a0627a2589a7369176710656c6278b6c08a1c859826a15c0618d2b2950e5ba4c6572f117f01645b86934b3653c653830a23b25ee47d177e326aaf9056a2023c9e5a2f8a346e3eace9a484ae0313b8abff7260e03e4be46cb01233adcef2d015cad477dc3533d62f9a8af9a369789429e208f9763303361bed2ecda0fd8ca2bd2e9c9c749abfbb9ca3f21a3611fbea87dac13af42687cc60788eb4d3c8b93c291ff05319547ddb4c2cceca6189b031e4b1859ebb766b4c165d434136dab70896c9dbe070d4805cb49e2bfab388172632f6faa7d1dd3717e9e6b76e4c89bf3464af37194490e2c9f8edfccf12771bd87c7ce6b32d7ad326e11538314119d5b4135341b62406ed6461d4ee81587789ed63fed5865ba1188738c0503b5b555644bc73b97fc4c9d561aa808198a860b4f26730d70b16a05d4319c96dda90576bfd5dad3ec7a8a403f0aab595520331326102e22a5d52bff9e4f9cc8f821f08b5f2b3a17be357a8db1ed018d38c2d61667d882faed39d6e7e9ee202c306ce787b58f69d918db8fccd835a7553494d4f90e219b1484142d38459f0f0940df5ea92e3057d8a8dc36a99624ba84a06c6aafd8c9796fe8a2988fcb5d703080bf30fd7966a8d462bf806a84e40d7028ab67bdc3e9472a6f789a50602f956c4791fc0e50a159469119ea1b517ea13fe8188ddabcb367d9af9c8db49a24b6e807ec7bbd1fc32b6aa1c4b455dc1ba93a39f7a53ca492a50c415571d3be207d7171e4146ffbe2b92162ad33763ed624e94cb65cbe4f41c0e97dc2c8b3a6793c958ff03d23f5f80ff1287278818937b3f7f40bd0bae2a7607f0146ef1cf4f7512ae7cb9de4c4ca34f61fcd4c243d693fe59b2fea2c3c76dd9fe2f4fdf4d7c62c143c61eda509feab39ba9adde6e8ed21bc1dac91e164e15b9f8ee778183dbc991aaa8c1208ecc6f9aeca6b5a983fc7c8e2bbef9f42859a414563366c2369a05e00da42f88c6c52ea5b48f5898569331563b26e901ee9efb86f25e3dd4d7e1d313acaccaf02291e233f3eb8a742ab54323f97953242800b8cfa07b325d3d68b538cb350ff87ed1b51260abfea852d0aa5c5eb9b77064dc358ba8e97c63dac555e230e3edada3784d6b797b4f9edc8b997b72c5373c3d1efcbc4af4bd30151febc6bb04c6a6a571fcb789e53d3d94948cc80e16d1ef269dec1dda4ddd676d0b9051ca56e3c4569967a9784bfb7237bbe42bc8b6ff8361769728f774ec96b27b4954bba94fb1f31cf3bc98ee5c916b3f9dc3ffdd4bc1c67bdf28c7944080d10c0257943c1987e036eaf3de071a45d2fc7c98b6cd70583822cbfb252adb8b2756431f1b7d7e463a8d314a2b78e7e941c1cca43e76b6343349b431692d92a27f8a9dac24076bfdc8bd1184742bfd1598416fbf68e2f6a6c88343fffc9e379a8ae6f51ed75f0ba1e39c3a43b1c5814a712d1c387b6c10db20f5cd07eba454cad600752d3e6fe51a1b373c4254f8dae66d7e3b73ea853597b93a5705d5374c9bd09b43b0ef88d1611a9f443c83438ef8fe2f494121c29f226908f41995304eeacfb47cf60e47accc654f3198a3f91b21af23c9748cd9337db90ea45852d19688bcc1b57164841c2dcbb0e6b3825a51a7f8885461a99b0aacac84bda8e567c0ffd2c69414cbf182c9df5621ccc87f652a881cc2a34619aea2d70068cded49fc55179f065d7a2dca18a8b37715fa17928ec681fbabc043d1111dc1b9524cf14fc59ab4f516012f6d36fdaa3c841f781e962d9bc17a781045db4bebce28db5997f365eee43af3f8df34c23622e1d15adae44f5aa9c84ab474377e2085c469848439d96c09031fe789d55cd7d68cd51298a892c71786d70c1722f2c5e63000e91ad3dbea51cd186e2af7e751c29b6d5c43498d73f0556ab4851d3adf6a1c39f8f3dcb0f5db7324c988a8ac3b5e83ef4ae9cb12ab5db2ceb8eed3efc3c25425648451c39ece5eb6230dbf9969ce8f634b24b9847713a115ef4f06c7fe413e1d45cd1e4c430472ba1d0925ff41a2a3c19f1450feb85879e7589e5adacf1396c9aa8ded5605735041d0537fb51b59384161e9f9e00fde191e421664a48cf0ab8d3f88052264e2adb885bf06997f5f7b19556814dc9ce3590a80799e5744342f25182647b48b92d52e41e3ff928ed4b457a62e0fb685acb649559e4d0302a594ed96bd2f251bfcd2698306136618556fe37e24ba1119fc7b86f2b686749f7c5fe7b0029d4e87ebc74e187031e4adccaeb435961d70373c5bc870b8b6c071ffb49eadd4c6c3a27f10d8890556b3fbdfe949884c3de4d83aeab88ae5c2859012c55b7201a043f98da2ba3b564ab64bbd9ae55c342f66c5745bbb1f638c947f74dceb75161dde993a1962b6d9bc4b08dc6d43318229c3b3d5b9ac99776b67bfaf7e0cde6653f6292bb261e35a7f298705412cb3521a0b3f6d4055cf6b0c7e9fe6e7706efde79889a57eaebd070339d43e2ed172695e53c2e490ddd68e532be2f267fcf67d2bddfc8ce43b5e5be149283eb65428327febeb700aa2e32f56540ade5394958f64ab091aa574833fbb1d75660c567857040f043a34d01e701d5c18a7f657a64f4d5089d364f2b41a90ef806cf6daea566e9363d68df63a8898a36646df33b8c467ea590f4ebc3fd97ea5073cfe2230e58d306b8dd1a2e38bad8495cb7e8da227f2b018f3e4916e9bfda0124546545daf08d9cc6767e2b38ceec7f4a80f4b183e3cc3437bb6afe1248d0337ac1f1d5b1d78ae8e098652b7c4e58b3ef16f3156fb89371b80d8a47a9f3f45f393f5121cbb42796bff4c7c20b1c38145848e6e10275b2f0fffb2caa554435f63ab17d16d2c5d0faa1a1ccb4797fb0174ba833830dda7b04b845588a7731dee23df9622bcc34f2c0090b2978cf28779f4024f3f9c18cbc1d0c54e44ea6fb57b593ef68acf31c689f47d296c0bbe134da74180bc7ad43e6a551625fc522b347db0a781b38b5dd03949f678ec9daea10932221629773bbd4ca946b7b2ecce3383c1b966a58e3d8813853ad8fc650e36a9f3d9af1cac1a651b97e7158a2779d809568e68dc56b31a00045c35da43b94942e296fd119ccec89d551ac8ecf4c80e0edc1e71b62bde5c2cb8691801521b6b749298dab8ae2454aa43efda04116ee2100feda1385ad539d02ef7e7b704ceaac0a67b7d2319602deeab0d4a14738d6c7e8c62eb8eba92ad82527f1efc62457a27e98ca58d0fef89ce6005f18f55408747f1c58adbac6b78ce4295388a896e1231bcd07d2d01c9842e94148fdfd96ca6ec2c5856c84b8f1e4bf9997f8fbf3ef7394c0522bab1ca8fc9acb8370591e96ee7f079f2a93038281eb0d9f25244ee7a8278feb1a8588981429aaad32a1b13695989a90ee495fd3133599da12020354f03d027a8f0a6a030daaa86265aec411cbfff6dd7cd0bc3a6cb868ed23f6d63eadcaaae9743fd367ddf273e691dfe74dbcadf7d6e38dc41078e6a35f9bf952307d35d70668bcfaa5398359c415eafedfb4c036e63bf51aba10cfb4f8d2a68b6c3497dc4b69e48fa47b27557b2ce4cec3d082f2cc8b05e739354df4e4edc18e1f5d60d57ed6d7204db59db13b12ea12cc5dc85dc78b7c7896dff3f1ab5d83ed8ab0093278a82e0117247e99d4392d1e34b7c0074993e7209e8ac0d3f1cfa7f58e2522b7479ff548cb0df67200f5234d0115a3c5c9359c042f1467636a78c4117a1db56a02567b996ca5fd84fcaa7a04080000e6cc944198164b4746956046e8e3394838451a7cfc8ca1417950aa6c1d910e60e6f9b6a3c42040dc23a73ad5e0d7c6b642e369285bc116f16ee0c5aae216532ccc9388289d9d27832c93971c02f17f3b7d48a35032d7798d8567c1f1e2e9cf4489cb1cbb91811950383baa991177f492905096c2c71e5bd00c5d8631be941bdb3d2d209bf88e16319432b0de6f856c5d69d73f9ff5e0514758054e725cf161949c6d1a6a1ee38914e85a7cbf3c97eaca4017c19b1fe39d35cd57f6999e38f35db8c0562bdbfe1df6975876c39375606999808d7e9eae3abf41d7a144c1cae71f66c3d99ffaf935fce92308ae0f3603dd28d17204705b62830ce35fd98f03276dcea3067cbd9e1806378e254b268bf9e8f3b25091f084a825bc715d82ac14a7f009ca6552c990e2b7891c157704056dd93de315fd1934103aba8043f76f815a944ac48a47e1cb2c330f06b1feb5eb121a5d49c7bc702c61600e93b71a7764bc0af485be0bb443ca37b43e0811df59dae218d4d6283b6e7a826839b378230d953517c1146d42c78734a14df0f2ff8fdddb748914e9213f0491f56c29f391dcc32bb00925f751c288c2db19ec7e778b995171ba5e6d16a270fcedb2253d291a099ffe735dd7e5a8b1f770507ccd354f83e1eba041a6fccc74a6d52da6685815bb9556f9059d817f5011e7cff383d3199a7965a3bdaeec29b4695df8ebf000af6b8af8872af697d111f25463312545ca9c0def39e71f7ce0f0f1395368643d952648cf97041617552f40c60c5424bd516c9cca2468d98547bab7d5e473e8c2d70d40d79ffbf3bd4d7f544b733ccf6e4e6ca6013a4dbdb9b96f8fb6448291bed593b87bdcd546202d5975e928cd9f3e6ea7fbdcfb6363b1d91f4375b66552b0928571e59464c736b8bc0ca232738b00550b72c5939a4c7c6f55247d353e875a55a07fc3246ce319313866be07acd3e6a6a2d8061a725197206a100001792e7c067ec550c4b05b3ca92c08a8f6c1f7da25fa26c06773e9ebcf2eb579be14d1095fab32a29d87b2a5632f4d3c1a079b7343d1b7c7e45426f62f7de89cca4d6e2c13bc3582887434a96c01d74ac2c41b4b012e2d2e4c75de9a018ebdda5f0b848c92f39fa95765d0b72e2987853369f44da4e014ac426391c4514d74a94d007c3bf6151254f9d473afcf91c2078c1fe05170fffc807a0dc0681eee49ac5bd09f552541a158d4b780dcf790cd3c6be7f903bf1a8cfd5711d88d950bab4f8f4392a62c7f8576d0d3b0b34686028d929ed4ad4410eeb63d56d2df4df09318f5ebc0755ec5ee76070027bba59a58d7a1ed184ddb4d2a9fe5df099a4d45aad2ed1a57c13da766a0e321456bca0338d29684fe796f0d719f53d30816ea82c8e08e541a2a88cb23ced54c7d22da8b9d8419de8be1c721a8decb89889ac3c3216f455f72b3172c657745902640a4c47e9c128b65b320704f69acad6352eb4c9993cf0f108ba9f7bc95d0ce63faff4ae213ae9be895e2423e9df9c4f3d71f8587ac9954e14ac549f2d653f062635abfeee55393caf7c6a167eadfde355afb8d5fbc0be2862f35c61a97f265d15cf07f7ec48a8384b464b7cf14ccf92174b347f44fa751cc3e534523e357a58363f76996e4e448be5cae396ac50ac90ead8a1ee9efdaf478faa7f54b1c974c40fe5b0c2ac02fb769420cb643979fa75b18ea636c2ba11710c479b3941a928786dacc05b7d65314ee41ed054d9dc34d3a99e9683a41a3dc820fe19a117a1e076e7ff1a90ffb30cd2b83e6c42361a1e12c962a81ea29a5af6d4dfcbb36e5fad9719944c833a54fbc94ec9d54b4b4f5168785881821fd733eea6301fc79611d6b57349ef2826692ad736cda9d341e5fc631f71016b7d28d51c8c511aad4cc47d69b60bb60fedc76db6c605fc1db213e4723be44e731d360642a682c6df41fb5c128c0b6ef7fec0e83126e7f4e35eef6b557442a395f95b5f93f03362788e9107bcd0a7aae3c64647c05a5375d9f3318857f52d90aea46ebfbae3ca442fa1ff6d5d2acd69da55f2d382c9ba0303e67e961a9708a25cb564d21243a5cc1bd3b65cf174affa0d2642e70cf09aa01259ed5a1131c82a3737f77d108769b15844f133bbca5b2dad0a6fd72ea0fbf422f829beb5747a1e758e2f142c1f17a5e86cafbe1f3ca9dd2961448dd47f858ec3649237996f314d36be66f4480a037a44f22e73ad02eb7e89b16173a11a6654f33f93d6d5211558eb869a5ba27438b688bc44eb32a9e0207d9f2c87ca140c4eadb4e287e4a79dfa1782464114dc59bedfa893ade270a88d4270be5be7874c1122121d328505ecad82f2803e7ed94d82d9771e0a2e4086473cfc00d193657ed4075634191cb7779d95b3bc3a51605092211f5f91c7b5579b474dc2a9cfbde08ec089e916deeaedd32d513bf96705a68ce075406e632846d8851d89819972bd5032b95496f98fb1f871aa70abe011baa0b65b84d9718b2d62a1c2acfe8fe209c4a60df124b33626f1c94551cfd4efffc1e94c0acb020ec446dde03b854ede3d0fac343f5126a68e9836d23481ef45f609459787fe6159c0cfb2af9cb6f3b5b3d427f63edbac0cc07d9d824d4d3014860a4fe6936628766e7dce6975a16902eaa8768f220a8b2479afe0327a71a8d2a7425af066a45b8c8a9f83e817cc7b5f36ea848bc3d73720280021eb3b2fc4fc981a5406a1ed271695f485114e5654ea1735c41e382f9c5b5a1be9a879ccbee06ca3710f0765294c62afd8310ccaf7d8541c2a7a337e3279a1fe7bc9ca2785390b1d554ed528d16fdbe770c9075fc20c56335a7eab8db4a39f6734b60ed82c238270453f0ff2b4a2419b84b6b98f4f9fa06712fd979ed3543f72fef2cdb1b0aa3ba190ca7e98283a3b666c52d70ef6feb231be20ef979afda1d945d34405af5c445ea85c4a6bd751309381774e66dda8623042f109bcbe3812fbd00ffb2f4af73ae9c6d133d0ac9b9ea86f7a9aeafc30446b793090e83e779a1daa18beb4e0cf713531a8e7f1ce762aaa828cfc6313a46baeb321c4232ae0327d5189925aa98b2119337b7499c8d73dec8108de64352469a405c34da0291116bc3b3659b18bfd1fa7527cf208a270c3eeb79f76d444134fb8e5af16af66e210a36848375ff748a3fffa2d508e1422fd67081f1fd982ac02d35a9dad186de013ce37349181c409309a53c19087baf6fc0475b8383e928b17e895e5a0fe0d36717bd47f77a92bc2641b6248694d48e163f83f54bdcc8758e83a5a4eb40b00cfe993f54cf4acd11dfc63a8dd51bce454e3f8b043c3a57bcde7881ce0ebb6bc278a0308df6c02fb817bdc3c8a8adf000950f5116a9c10f04b077611b68b3261bed4ec91180a1e71bb27411729f0484b9875903c2e8cfdeeeed50d990a600593ec5723b1cb05fe7d2939fbc35eaefebca0a9f1633cdd8e8308e47d3ab6975cc56bd439a46c479a8fa82357bbac5ef210e877f5e74d2802379ccbdc17a2618e47b89b6f9f265466aedb1b49c297a2f44449d23c77217c1749d3732750d279940e99eb3a1fdbca3ad617b39663d423500a5d661ddf4d6b7608971f90dd80c9baf4b13f00f5d631e785ebb0c30e6cae4fdf9792f73e1b2bdfd97e2e832b269d76a8801c1ba15a88b6d48c1bd327314c598527582303ed3db99adb0af2aecf76aac0c9c0abfe8f7480e16312f0edbf7b372519e5eab3add925bb6476b7228afafc663f9c3a70908ca3f135dc5fc76b21c18fa99c0598d4b83650f324144c85da53837bfbe512632dd6260cbc1b1f5f96b0ba95b150beb08945fba2e6b13e0b810ea6abdbefaabcc168854b784de7b532e869595c7b84a802a08d4b287daad3503f53524b92aeb346f8757e0070416a28dea389b3b52f94c5aa8acdad5e55e1e4d1e68a01bfe4f349ea6bc550b123e06788c053a09b20f0a391ba6da5498ab49d0aeb75e6230dc1058c771e24ac906663c1e1b3834c2d2db5d5c9058e75372b9c4f49188418fd3fc4ac02d286e8e5ae26639fa865295ab98903cb8c25188480b6baea7a789e8b87fd27dddbf313e7eca30946173045451590ce2bc00cecc377e76dd8c9b1feb3241f65c8236fc4a504d6869e09bd878d160903d89c1ef101ed85eceb9a7864e3bec345b52554f6447ec01010dda815e8133d5d03a8b52c9c1c2540a5b5ac411ff496c7c90f610003061b08852c173a488f9586f7d0b3b9b7c71b35b8cb325b47c97e395a85c25dbf6465a07d91c9a4fb630450e4cee411a5d4a552e0312ad5b58990122366ab8a930db1ff97d36cb5737402b8639c1726c2678f4230d2d6c3d4c4d9b0e3ba98a551289db7a8ade45d04c1dd863065d9b4c29a4014b59a2fb6e0109ffbf20c121cc1d37455e8655cacd9222394da04355ac5cb68b5e6b34e448aa40b3c5e7d7269f6d931ca4b6628cfffda3b76449450ae700b624f0fcf2d91d3653707efb56c09d5c7dcc8c4b1045e35ba507e8926b46ec7b3a1e812082864c15fc67db3b2e54a1c0d93709a3834d45327af3f93788869e1cbdbcf25035a134dca0c4141103a30d62cb7673751c6684dec5642b2f5d766eb7bdafe0adf8e4765e4474960fb95ffa9035b1d1686750fd7c9e3c5e08dc5c687aa7f365e95dba2d0b0a6a08862e37e7be5e729817d206d8e25f999e6b89bc77f39764ae566d9174476ff0b6d416865ad07e66a3fb08bca143090627055b1d255a7a5d8fb92ade96f47754be64244201bc5b66dd882063c2ef4e500088e3ef8f01b5c46d3faa71aba5001550266647ec1f565e1e48ec10654dfb0efd60710f05cfa983ff270a3c306e637cf325139e04fa0d0c9abe27f2c321bfb34966732c3613bd4df36c1cdeab2372091d108ce6844992e30eebda4f5798ea4a5d93f41b78e4f71a7b63dcddbf173901e0ce4ae853ebebee082103371529621742cfe9ce16e96ee658d48e056f568c037d63004cd1727cd26bb415cb4b1ed0f7d83343a5f72f41666adc9aa850347710c262c99ffb64ca137a4cd3f19d1b98665a8a3ef81b95ede511d2002e9c2684d5d7f5b326f30bc16b3f90bf8bb6ba350f1c30ea895fe403ea8361f03699a715e22c29496923f456ab284240246b1b1b4530fbd8f8154f4dcdec21af5cc7a77807d610db370a021f4b7cfe22a80708897635d2ec81e3c6b18247b574c60a3a2056605bc16f110513c608556ffb1f16aa7ad37f646796d0e6b7fbd0db0bd23361d0e5f90310bfefaf8b2ddecada5a20b0bfb246ef5faceadc06cc0f0097d96450de2b32f569fd843ab052a12868106e1252bc73e5bbfaed9484859a0c3530c596a153c43227bd5e1c38ff6ef2a6329fd96118f4d9b958d26471584154478862565d7bc51ac2e8208a31bb8ad4a9adbc11f1d2120577e074a1ef00ab211aebfd4109984cfa746cb8da297ade4fa5b11012550d82d84fc17d28015d3837aa364233bb513ce58ca3dd62c1d2ba7fc38f32ee4df8b4eeb4fe6c0c9e81a615a8c56964b7590c2d4c01f5e7e7af021281ea4724c3c446e7ddc9bd0c360cf14d7a8522ac74647117e4bfa899e24ec6b0d33581f147b7e037a063d9a26e999c2998db2c71d808b62e442c7cc497df0b9f51f0ad6febcf3c9329fd2872d44b27e8be0919338db864862af38702c7d93a621b9fd2ef941ca454ce8483948a761ab9514b5910776d8c96beaf50904ede5064ce1b5edc21a416c536daf40742526fb826572e53fb3c9e00321f5bc1aedff718ad5e65eed01a20335efa6b12993d07557f0e925249c0163873b16e461d78bf0eeb6fa581727c761050b6b3fd395ac755e46d3041e1b882becb96072bb74c800b85f9ce07c5881485f3145d5bb3b8ffc0f1f73a35d730d09206299e2dc2ebe6c8afb2e9866233fe71f71277d2d5e08c08d450f5493f526a81cad504de86e7b0835e98318c17ead041f0801795de6d278c861e9c0563bca38e1c364369b1146c917604a36227455cf7f484b13a6ca0926dfb297f5ea3f8e245e7958375ccb84f93b72997e6e8e9130064a045f0c123223e55604a212af63507d924499127ec816422ed6e507a80611a11d2f3dec017b5becdcf58d3e38206bd71de34c4653945fd4b5d48f5718efd21d56524b63c229bcb8d5694b429a6f263c940cc456b5c6ed685d3f3fcc60ee2fa21d586c5c7f48cc331bf052db49c430f04a0b7a736be160ce10385398732474ee785a192c02aec617274ac801cd88e4e5b30c326da54f0dffbc884978a8ae5559c4d17b2088f4fced2884821f7d63f89bd1e647820048e0d68de65009605fbce9ad5b3c087e35086960923e05443d42a71d59191dce75338d79592663b75a0e7114fcca5759b20ee71fbe83021fc5afe172ccc69d3b4c68bd67e1a1ee78181b06764420f23fc663157f93be9ee99445242bd3a0126d953848551ca8a03fa486dcd61da86a891127d0471e0f11f08205acf68261135f0f07811ac4f6828b479f497148d250631e14dd1455ac062482f7d44b71d1510fc20ef59c2a2b3a39127a84bd117f91d0ea18fcb0091a2b700547aa52abe6fc95b01ad33be6ab031577b872e0ebc000527d3e26cd9ed8896a98567314abf789d54822d99dd892d07033cdf9fa4ee07d729b2bfd89a54c94c709dd977b1bcd52aabe28541f4e9765392bef8de107baa88a336244d3be07e0cf8246c828f499e024ba259d993d4da3667807e28e5bbbebcb69462ca1fed12f296c7122ff5cb14af5be01a1796906db0f50326d7e2293347e419ec225421fe5762b4fb1eb0770558652249d7313293da0781a3187987362b7256184cca82562412158755ac5f6af68cb2c91655fe33dbb60bf17d5f6ab20e535361c5533d23d1aff3790eb2f7e0c19f0e4e622eda65bf21ad04eeaaff10b7003dd0c8e83dcd3eec70adbf5f7c8ddc347eda254cc87d6086cada264598c1aedb5b49de1434e9dd7f9183271e2fcd983325bd140d9a74bd0e8e07eebb36ebca83492ace6a5857de8eca47c0b98aeb5c9484cfe7bc1c180518c7d4efe27acc9a2b2d207e2fabdf6c875933a6737beb107be5050744ab727a73cbd221d660a4d6fc8d67111ae435c30c73f41b127ed5d959aa221d1cf6c924a22342a5b1de2abe900b68cb74c63d7cfc70fc0a6cfa395c5a467b77b8e8f5ff6b1459de5091ecd1bb99057892e24c26405837535cf89df2cb373e7198bad7acad96df5f786c051f542611db3ae1206283fd93db0f003be9e81fb65d38e2eff450b9103e1289a805551f6ab4555f7bd13b60cc0f69749999153a3b11a737a04804b603bb55ef183011206f06a69c85390915e4d2ae4300e90869b14a2dfcdb567668b9ddc4caef195c6d2228edd91bb93a1b89dc38a4d574cd7d36201be853c59a419d8706c26bbc2e11571223b6e196d57d5a3f91e872d25a385f93122cbc0dc8306616d1053720fa40df642da74080172756404b2ea0ffb2cb5e694e1240ca202deeeda2fc4f60b6090b9bed15dbaf3d40f19f1f89ff1aa03d06eeb34078eba3954d313dced3ff4bcd43e61edfcd54d17ccf72298d621d546f959c5a606b7ed1b303dcba7a388bab0ff939242129de90a355029ee92ffaac2b7e9435710185d1506439baee9731e65ac190693558c11bde57e16c5a9ac0ab6b3433deedcf9e911607ed7d97f51aa15cc5631636ba80fa26ae369a8816a02a8474a55a2631d25b6ad5534f1412b0e1250045a962415930f9b29bc2955475751bf8b1a84495c348316979fc626c24504b21f32a9cf9ab3d442b4891a916a3757ac60d59f8fb85d28670a0bd49824862b7ff20adebd7a58b91079dd7fbf0d0767efc47bf7b7a8847103503517df26c3fe734746d2eb140dca51d6087b81db1a21794a5b52a4822cd59c89c981bc7f4037bed674f696ba54dee8d1b8b15b45a110cdd7b486a954cff55f1d89f18daae277a39eb10a88b0fce514253f23bd1489abdcc8b108c6df6ceda65c0b7df1a4b0116158f5c21e094eccf730609d1905e2bae757556ae08f55e1099f25d2c1650f09436c13238c37d0db0c6ee1aa368f62cd6feef29a60bb43a0f9d332a5da82d0126d81e88f7db81d66621d11a928ac51736c75a0c08b8469020370d8bbe5b86ddb7c1705d3963a7926ff5b0441444bca70612debc13f57e970bbe8e3e72daae2ed1d689ff4aa96134596e614caa022725649b9906b4b5f12ba0f09a7e41819f94e162f79634731855ab2fc6679a42b09c0129eb3f9a31dc497a23e13778e0e833c2e20ab56452159c4e982dbfca749c8ec87c613211d268b5ad92102d18c6c5ffae67c541a2cb3365b35560981b71457f4f12ea3e9214189544f3970aeb9bafb06659379e1cc882702b1a74e7d5958f9b7b8472f70264bb0cc21bbbaaf40341d238b92589c2b2ec22035e590d740fd459fc2ad6443b17e544b245d51957bc637460e16336e5167f145c42f4e9b64fb9648e1e4f240a6760d24ddf56495a69c8af240e616beac980278b515103cc04bb3a94ec8d787b724801531591067baff7906115ade2706f5176da195cd5660499b2c4c92c1313a3d7326c84372bd2b8a965b8c5b53f66b6ede2b3a58af480d221c518154c0b6efd034eb326276de519c8b3c934f37c71d5e02429d023adeb7fbb3b8f52cdd9411394399e474030675c4aac7b16fb4851cc30140b130f7abf3b861c197b3a04f3302661f4c0ead47a5f936f9589414541e1681b28b1c7d00e6274d770b4bd1b646dcfd2000af4d50395dd4fe23651275b567ffffd9d10c1ba7b351f37262ca27264cd1d7a3e263c6d02f3b0e5121333d52bf82d6833fb2d0719965ec4e06a8cbf71c3f548342557ad263dbe47bef0a9d03fe419ef371b49966f6577c5ac287f359bfd78e128479f4176de95dba1d2fb2235cda86fd82d458f38b98d47935071110d68f1a02c843893d55f7e185d54e6344755be845eb3b7e750a76435327c5a3d1c420bc80a8dbb272411e260fac5bac5994051e9839a58f22fcbaa32f74cd5087fdb8d667a0d554cb2046adb6ba733d41fb229102b1cab24ac4b906ba56951573fa4e916e80b672a11b534e35b96fbfe1cb3d6e417b4a59f952042aa2bfe08f47240beee1de088e6637d51b7d3e3b7f045339553daba9b4cd2c104ad0ed6602d91627d1d998c37666697d6a0b5039d6708e7fb511cd94c79a1c0d80a79fb4668199cdb3dd3d908b4786d04411a48c15f94c1eb302648d9334dc1e56a65e13c65f051001cf9d4eb59f6ab135ddec76ad899e43a43dd1b5cca15681efaaa44c3b590abc126d47f41832e156414a6b11d82508b8cadcfbca7d388f51b8ed8e801438f5d0e10e31a39b5588c83a1ebd2cb11f488ff3d0c8a66142900dfb31b0549d01ab19f7ce2383bc16823f76bd84c5aa21080b373bb81dfcbbb4a239da5585c33e0da7c06c09f35e8f938079a8890b125d752b27e286d377b3f4e3f7fe196c73782536f33290a8c772af7cd3fffd4cdd40976817150d55c13307ae7f024727e98a9950a70a8bfb06430cd737887e0886dde025b0053676950bbf03684fe8df553c275825cbbe0b8f15c9233cebb2ccdca58e887031b81e762c20f2b4a97a41ff81acab82a620b86b32789c72e21f84d419851f5e83c4bb40283a9df5eb5bb4eea80f3a7f765dbaea8da44871da6e614c62c1fc2518841d10e7a1b4222eb0e2580ccf7fe36847b3b28cb7d5e3585715e822f1a117bc911004f2ce233d76648e2b88c16fae794c3d13704429aef854d48588278680c9143ae3ef375de9484b63f6f7c0bd014d33bb49f0a72dedd4b0dd6db667fd3c5a17b092d56e410ae37f8e6bc6781d43982de4d67ac74f9b2f97ccadf0d9d4ce433bd562a81af303d4288931d7ad5e7cb882865e8e250070af66ee8fafa2a2b4620de237d876ae24cca25c8155ad12981ca12704a449e5ac2b4b129f00051887d0ee4af771ec4c37fa4a2108d64f924be003ae277b221dd3420053aa4223e75ed5663b31936e1925c42aa61542febec3fa84a07d3f9370f3a68e85d61905fdf2804044970031e98af019b5c291f0cac36ff56b4a8a4f6cf54c51f4c981f811447cac61194321f70772e9482fa77f89fdf70940c2a0cd8023fadf32522341013744eeb8db9ccf203297e3584942b21ca66824130de8c9f342b3fb4da81044eef5319699a015ee40c0b00f213b9852286fbf1fc479c8c72fec8d9e26f96b65853705c22a8a5aaf38626702008c31222ce78f5f8ea1da0689167108563bc2961d04163c1c8fe858c95473d65cdf9cb0e97fa3d9bfab4c2796dfa8db0c21253b9554e2ee99b2b4c7eb1efb3b67c9a0f18426962269c882e42993de1d12156c22e8fdd65e9bb17b5943ad18b8628c526a45954c1b8e5b46ef17eb66875cebc4876a8419efafb0897cb2c93879b88efd6b41b64e91f6a77cd1a8866cdad03c75f731f523605ace78a4eb747c54ac2242bc26b0f7717e70e58a21f35fbcd1874e42ae267ddaf09d269b08ca6a9e083fb6e9057cead8fd00ae34d3299a5b190be1bfa27c5646a77996200792f063fe471be9ae8a88cb1734903b28e95806d715f6f885eea3d84fc32b0766b6442e898e4597ef96be02f4afc78bfb1d7e96d8abf488de47bbd6f00ce0a39f8e1204ef325f5323944bdacadb8d10df0b2b943e704911e966d458f18038f5bcca5af1533ae2f703900be42faadfbb0efa4793469f730a74ed61dbec74afcd8c735950754c1b3abe18383e65cfb4e9db2e7ab2881cfd08253bbe7b762e711450edf9b57e78e9ffb2eac0e02160594cd0eb50e87af119353b3eeb91f5585bf336407d749617d7e64b5cb93437dc9fafdfedea356018b8e577c2a61b39a871d095762a99fb55d4c89840120f76151531e5ffa3b1ab4a3df38ac1e108c09361d5315cd12dbf7d82442fd8e60f9f895be45a420f8ac649a711318321b97dc3a390af26f24469bf6da663a89f8a91e79ff8dcef1b0e145863b5da2eb80038a48eba77effb30452fdd4688e65a401d93d8227628b3cc99542c5116ee1ea86367458c8d8b3e600078feb7fe1a73ec26d64a1da14560d4b4fc95ac28d5f85f65d3c0da72b69f0ecc15ee58e0406aa69ade288666a215caa346b7fe97752d47b9e7cfd7c130bb7974cf2a55d633d8097f985113df7b54913855e26d4baa5d3b92cffe0bc66d9c6c04d737a76945b86ef057698a23b21e250583e2b5e61ad5087c1fa29fcdaf8260ef9e325588fade8215fa1c8318b69d5f366442e7ce6dee2773bcfb6218b6c602628f01c6850b32f96bd95c56029ae4a44132c16f58420aca32b7180d31f90cf69fa6690630900257ffc35414257aad10a9a5a405b9691edbe8e0d2f30abd9be783f24e5ded19053a593b1b140f31ac6554298cd04b6121db34723d2ff81d07e7c5749ac3dc7cb06a214092d71b728b94f66b3de64216273f6c52201d3bc9272565af8763980e7f79c5e3d863492ac2e974ee0e0aa6c128e8b72228108e9792f46597ffdd25de826882030f32bae660c33b851d4cf24bfa76553b07369bc6feae36f135a798809ea1d1ee36ecf6c9defb04bb767c039f58f38c876d61d34d710180c9c16fc25aeda711d5729f55ffc537887cf6700c69bb728908f4317aff2bf8cf781867ed4a2f5dac929cbcff9fb47c4954e374d6d69ebd85551dda570368d141866e214a3c6a6a927e1afd064378390ec173cb65b0dbc966295f234b108be9b172ecc2f2f9ac17b674743ae47247f475ac16e0e5a897a273a8a989484d1e1595abbcba38cba8b73a1f46f47367f65be500455a51b5be3041751d05302a8bfb1692895b635a12522fe5a7afc1191e203f791a274d2be5dccaa4da0cc62adfb373ae341737af9eed44f303d9e6ec2d1a563865afa6c3b07452aca27c3598d574f093b6a413e6e9663c41149179654ce187acdce2f1bca65d454a372c737caef527ac78d92fce23715e66305aa9edb87b43dcf8f48781dd94ada150d5ca2572b815423ef704b39933f19ef0bf92e9086dc783bbfc824cb955a674dde31a67fa84cd967f35aeac12ceeb33723220e22a42cd52f02305673d19fa13afc42fde60baffeb41dbd3493a73df12d7b4be7b0d8ddcae7d07ef2600085686911d8f28ddee9ce959d9e0911cd4edec09ef55f3183a670dfd0bcc8a2cfb02245f758933bda24e2ef6de29b7b22850caff3bac08263310a197fa2a318482d28896e6c73fb72039104a70bb5b02bc99a414ef738937431f835ecd57a66d147a37dc427e0adabf4dafa92616bf95332136db5238d5c12c1590db46296d7d989fc6f278169ffb7ef9bda8a7af49cf7ba4d37618c29f647a535471a6601f5d4a7d808f5b9255a3cce5bdbae1eb90d7d5ee8297eaa6dcace81d67a1c7c6705565a9098349661e8d5758e842050195d74dda9094244494de31be98e30b6d62532fcdb466e8a10485decedc95f0f8b54baed6d60e4bbb5159529b7bfd10894d3bf1c813b54a432ef51b104089ce69d1fffd1404c43d961590bd37dd8218f8f0e1cde2e0921550ac1f3ebdda567541b2864d75cb41f084f6f37edb87272c091adfa3dda5243cec89755ff156b051451ef9715585e793e95668a9d44b35e1e864e4f927082f831b4a82bb04e5ae84591c1e27dbbe84f487a2e332be55a1cf23aa208239f151d52777a28c994f9f217ddeb4aee2f7c594a548b4c88184c7d95e855303cbe0bef0a09fd3bdc52cf5a6b33076e0bd5b86b3e218e3dd8e9d0eaf8177a10af46a47ffa660e77e6f0f5f2558137ecfa2ae75ea096ab8acb480c7237ebae8b7f3e93ba84aae952020540a277100cea5fa8f5a444e38152c4dde5c54ce8a0bda209913e1f276e631785c92e10664cee9c57f17</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> Coding Language </category>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
            <tag> CMake </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pyspark常用操作</title>
      <link href="/2022/05/13/spark%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/"/>
      <url>/2022/05/13/spark%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<h2 id="前言-9">前言</h2><p>最近一周主要在做一些数据构造的工作，主要原因是大维度 embedding 的引入，造成了测试集构造数据处理流程的文件 load 量与内存占用爆发式增加，导致本地数据处理几乎不可能完成。在当前数据中，对每一个 keyword 与 video_id 对，我们需要新添加 5 个 256 维的 emb，每一行的数据几乎膨胀了 20 倍，导致在本地 join 成为 mission impossible。为了实现这样的工作，我们希冀于借助集群分布式处理的方式，使表间 join 成为可能，同时得益于内存处理，加速整个流程。</p><p>在整个过程中，也从 0 到 1 得学习了一下 pyspark 的基础知识（此文不赘述）。这篇博客主要关注的方向是平时在使用 pyspark 时常碰到的问题，以及一些解决/优化方法。</p><h2 id="spark-shell-操作">spark-shell 操作</h2><p>在刚开始接触 pyspark 的时候，我们更多的不是通过执行文件，而是一行行的代码去调用 spark API，这样的方式，不仅方便我们了解各个接口的属性，也能方便我们 debug 信息。而使用这种方式的基础，就是启用 spark-shell。</p><h3 id="启动-pyspark">启动 pyspark</h3><p>查看当前下载的 pyspark 路径</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">which pyspark</span><br><span class="line">/usr/share/spark/bin/pyspark</span><br></pre></td></tr></table></figure><p>启动 pyspark，并设定一些参数，确保使用内存有限制，从而不影响其他用户的使用。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">export HADOOP_USER_NAME=szci_ci_search</span><br><span class="line">export HADOOP_USER_RPCPASSWORD=xxx</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pyspark \</span><br><span class="line">--master yarn \</span><br><span class="line">--num-executors 200 \</span><br><span class="line">--driver-memory 10G \</span><br><span class="line">--driver-cores 2 \</span><br><span class="line">--executor-memory 8G \</span><br><span class="line">--executor-cores 4 \</span><br><span class="line">--name &quot;xxx.xxx-spark-x&quot; \</span><br><span class="line">    --queue ci-search \</span><br><span class="line">--conf spark.speculation=true \</span><br></pre></td></tr></table></figure><p>参数设置含义</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">num-executors: </span><br><span class="line">driver-memory:</span><br><span class="line">driver-cores:</span><br><span class="line">executor-memory:</span><br><span class="line">executor-cores:</span><br><span class="line">name:</span><br><span class="line">queue:</span><br><span class="line">conf:</span><br></pre></td></tr></table></figure><p>启动之后，我们会得到一个 applicationID，并且 spark 会将相关环境打包上传，保证 applicationID 下的正常运行。启动界面如下</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">[GCC 7.3.0] on linux2</span><br><span class="line">Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.</span><br><span class="line">Setting default log level to &quot;WARN&quot;.</span><br><span class="line">To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).</span><br><span class="line">22/05/13 11:52:42 WARN Utils: Service &#x27;SparkUI&#x27; could not bind on port 4040. Attempting port 4041.</span><br><span class="line">22/05/13 11:52:42 WARN Utils: Service &#x27;SparkUI&#x27; could not bind on port 4041. Attempting port 4042.</span><br><span class="line">22/05/13 11:52:44 INFO Client: Verifying our application has not requested more than the maximum memory capability of the cluster (102400 MB per container)</span><br><span class="line">22/05/13 11:52:44 INFO Client: Will allocate AM container, with 6758 MB memory including 614 MB overhead</span><br><span class="line">22/05/13 11:52:44 INFO Client: Setting up container launch context for our AM</span><br><span class="line">22/05/13 11:52:44 INFO Client: Setting up the launch environment for our AM container</span><br><span class="line">22/05/13 11:52:44 INFO Client: Preparing resources for our AM container</span><br><span class="line">22/05/13 11:52:46 INFO Client: Uploading resource hdfs://tl3/packages/jars/spark-v2.4.7-sdi-028.tar.gz -&gt; hdfs://tl7/user/spark/staging/.sparkStaging/application_1649942865376_6398197/spark-v2.4.7-sdi-028.tar.gz</span><br><span class="line">22/05/13 11:52:49 INFO Client: Uploading resource file:/usr/share/spark/python/lib/pyspark.zip -&gt; hdfs://tl7/user/spark/staging/.sparkStaging/application_1649942865376_6398197/pyspark.zip</span><br><span class="line">22/05/13 11:52:50 INFO Client: Uploading resource file:/usr/share/spark/python/lib/py4j-0.10.7-src.zip -&gt; hdfs://tl7/user/spark/staging/.sparkStaging/application_1649942865376_6398197/py4j-0.10.7-src.zip</span><br><span class="line">22/05/13 11:52:50 INFO Client: Uploading resource file:/hadoop/spark/sparklocaldir/spark-bbd4bfd8-6578-4da3-8ee3-80511df8a90b/__spark_conf__5160579084130103039.zip -&gt; hdfs://tl7/user/spark/staging/.sparkStaging/application_1649942865376_6398197/__spark_conf__.zip</span><br><span class="line">22/05/13 11:52:52 INFO Client: Submitting application application_1649942865376_6398197 to ResourceManager</span><br><span class="line">22/05/13 11:52:57 INFO Client: Application report for application_1649942865376_6398197 (state: ACCEPTED)</span><br><span class="line">22/05/13 11:52:57 INFO Client: </span><br><span class="line">         client token: N/A</span><br><span class="line">         diagnostics: AM container is launched, waiting for AM container to Register with RM</span><br><span class="line">         ApplicationMaster host: N/A</span><br><span class="line">         ApplicationMaster RPC port: -1</span><br><span class="line">         queue: ci-search</span><br><span class="line">         start time: 1652413972393</span><br><span class="line">         final status: UNDEFINED</span><br><span class="line">         tracking URL: http://keyhole.data-infra.shopee.io/keyhole/proxy?applicationId=application_1649942865376_6398197</span><br><span class="line">         user: szci_ci_search</span><br><span class="line">22/05/13 11:53:00 INFO Client: Application report for application_1649942865376_6398197 (state: ACCEPTED)</span><br><span class="line">22/05/13 11:53:03 INFO Client: Application report for application_1649942865376_6398197 (state: ACCEPTED)</span><br><span class="line">22/05/13 11:53:07 INFO Client: Application report for application_1649942865376_6398197 (state: RUNNING)</span><br><span class="line">22/05/13 11:53:07 INFO Client: </span><br><span class="line">         client token: N/A</span><br><span class="line">         diagnostics: N/A</span><br><span class="line">         ApplicationMaster host: 10.130.80.227</span><br><span class="line">         ApplicationMaster RPC port: -1</span><br><span class="line">         queue: ci-search</span><br><span class="line">         start time: 1652413972393</span><br><span class="line">         final status: UNDEFINED</span><br><span class="line">         tracking URL: http://keyhole.data-infra.shopee.io/keyhole/proxy?applicationId=application_1649942865376_6398197</span><br><span class="line">         user: szci_ci_search</span><br><span class="line">Welcome to</span><br><span class="line">      ____              __</span><br><span class="line">     / __/__  ___ _____/ /__</span><br><span class="line">    _\ \/ _ \/ _ `/ __/  &#x27;_/</span><br><span class="line">   /__ / .__/\_,_/_/ /_/\_\   version 2.4.7-sdi-028</span><br><span class="line">      /_/</span><br><span class="line"></span><br><span class="line">Using Python version 2.7.16 (default, Mar 14 2019 21:00:58)</span><br><span class="line">SparkSession available as &#x27;spark&#x27;.</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt;</span> </span><br></pre></td></tr></table></figure><p>后面我们就可以像执行 python 一样执行 pyspark 了。</p><h2 id="spark-submit-执行-spark-脚本">spark-submit 执行 spark 脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">spark = SparkSession.builder().master(<span class="string">&quot;local[1]&quot;</span>)</span><br><span class="line">          .appName(<span class="string">&quot;SparkByExamples.com&quot;</span>)</span><br><span class="line">          .getOrCreate()</span><br></pre></td></tr></table></figure><h2 id="pyspark-相关常用语句">pyspark 相关常用语句</h2><h3 id="读取-csv-文件-（data-frame-方法）">读取 csv 文件 （data_frame 方法）</h3><h4 id="基本语句">基本语句</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.</span></span><br><span class="line">data_frame = spark.read.csv(filename, sep= <span class="string">r&#x27;\t&#x27;</span>, header=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. Using Header Record For Column Names</span></span><br><span class="line">data_frame = spark.read.option(<span class="string">&quot;header&quot;</span>, <span class="literal">True</span>).option(xxx, xxx).csv(filename)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.</span></span><br><span class="line">df = spark.read.<span class="built_in">format</span>(<span class="string">&quot;csv&quot;</span>)</span><br><span class="line">                  .load(filename)</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">df = spark.read.<span class="built_in">format</span>(<span class="string">&quot;org.apache.spark.sql.csv&quot;</span>)</span><br><span class="line">                  .load(filename)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="Extension-1-读取多个文件">Extension 1.  读取多个文件</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data_frame = spark.read.csv(&quot;path1,path2,path3&quot;) # 这个我测试的时候没法成功</span><br><span class="line"></span><br><span class="line">file_conf = [filename1, filename2, filename3]</span><br><span class="line">data_frame = spark.read.csv(file_conf)</span><br></pre></td></tr></table></figure><h4 id="Extension-2-读取多个文件">Extension 2. 读取多个文件</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data_frame = spark.read.csv(Foldername)</span><br></pre></td></tr></table></figure><h3 id="读取-csv-文件-（RDD-方法-用到-sparkContext-sc">读取 csv 文件 （RDD 方法, 用到 sparkContext-sc)</h3>]]></content>
      
      
      <categories>
          
          <category> spark </category>
          
      </categories>
      
      
        <tags>
            
            <tag> spark </tag>
            
            <tag> pyspark </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C++ Standard Library</title>
      <link href="/2022/05/08/C-Standard-Library/"/>
      <url>/2022/05/08/C-Standard-Library/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>作为一名进入职场快一年的员工，如果还没有去具体了解标准库的内容，以及其实现和构造，会是一件比较 shameful 的事情。为了弥补这块缺失，我特别开启这篇博客，用以记录在学习 C++ 标准库中的所知，以及可能的所感。</p><h2 id="Container-容器"><a href="#Container-容器" class="headerlink" title="Container 容器"></a>Container 容器</h2><h3 id="Item-1-小心选择容器"><a href="#Item-1-小心选择容器" class="headerlink" title="Item 1. 小心选择容器"></a>Item 1. 小心选择容器</h3><p>容器的分类（按照是否为标准库容器等标准）：</p><ul><li><p>标准 STL sequence 容器：比如 <code>vector</code>, <code>list</code>, <code>deque</code> 和 <code>string</code></p></li><li><p>标准 STL associative 容器： 比如 <code>set</code>, <code>multiset</code>, <code>map</code> he <code>multimap</code></p></li><li><p>非标准 STL sequence 容器：比如 <code>slist</code> 和 <code>rope</code>， <code>slist</code> 是单向链表，而 <code>rope</code> 可以理解为是 <code>heavy-duty</code> 的 <code>string</code></p></li><li><p>非标准 STL associative 容器，比如 <code>hash_set</code>, <code>hash_multiset</code>,<code>hash_map</code> 和 <code>hash_multimap</code>。</p></li><li><p>还有一些标准 non-STL 容器，包括 <code>arrays</code>, <code>bitset</code>, <code>valarray</code>, <code>stack</code>, <code>queue</code>, 以及 <code>priority_queue</code></p></li></ul><p>需要注意：</p><ul><li><p><code>vector</code> 可以作为标准 associative 容器的替代，有时甚至能比标准 associative 容器在时间空间上表现得更好。</p></li><li><p>有些情况下， <code>vector&lt;char&gt;</code> 替代 <code>string</code> 可能有不错的效果。</p></li></ul><p>同时，我们还有另一种标准去对标准 STL 容器进行分类，即</p><ul><li><p><code>contiguous-memory containers</code> 连续内存容器。它会将元素储存在一个或者多个 chunk 的内存中，同一个 chunk 可以有超过一个容器元素。它的一个特点是，如果一个新元素被插入或者一个存在的元素被清除，同一个内存 chuck 中的其他元素不得不移动，从而给新元素制造空间，或者填充被清除元素所占用的空间。</p></li><li><p><code>node-based container</code> 节点型容器。内存的每一个 chunk 都只有一个元素。插入或删除容器元素只会影响指向节点的指针，而不会影响节点本身，所以当某物被插入或删除时，元素值不必被移动。容器代表了链表，比如 <code>list</code> 和 <code>slist</code> 都是标准的关联性容器（通过平衡树实现）。Note，非标准的 hashed 容器使用不同的 node-based 实现。</p></li></ul><p>以下的一些问题可以作为我们选择容器的判断标准</p><ol><li>我们是否需要插入新元素到容器的任意位置？如果需要，那么 associative 容器就不能满足要求，只能选用 sequence 容器</li><li>我们关注容器内元素的顺序么？如果不关注，那么 hashed 容器变成了一个可行的选择，否则，我们得避免使用 hashed 容器</li><li>我们使用的容器一定要是标准 C++ 的部分么？如果是，我们就不能使用 hashed 容器，slist 和 rope</li><li>我们要求是哪种迭代器？如果必须是random access 迭代器，我们就只能选用 vector, deque 和 string，我们也可能想选用 rope。如果是 bidirectional 迭代器，我们一定要避免 slist 以及 hashed 容器的一种常见实现。</li><li>当插入和清楚发生时，避免移动存在的容器变量是否重要？如果重要，我们需要远离 contiguous-memory 容器。</li><li>容器中的数据是否需要 layout-compatible with C(兼容 C)？如果需要，则我们只能使用 vector</li><li>查询是否加速极端考虑（？）？如果是的，我们可能想要使用 hashed 容器，排好序的 vector 以及标准关联性 associative 容器。</li><li>是否介意潜在的容器使用引用计数 (reference counting)？如果介意，我们可能不能使用 string, 因为需要 string 的实现都是引用计数的。我们也需要避免 rope，因为 definitive rope 的实现也基于 reference counting。如果我们必须表示字符串，我们可能需要考虑使用 <code>vector&lt;char&gt;</code></li><li>对插入和删除我们是否需要 transactional semantics （一种语义，不破坏原有容器内部内容。）？或者说，我们需要保障回滚插入和删除的能力么？如果需要，我们将想要使用 node-based 容器。如果我们需要对多元插入使用 transactional semantics ，我们可能想要使用 list，因为 list 是唯一为多元插入提供 transactional semantics 的标准容器。transactional semantics 对致力于写异常安全代码的程序员尤其重要。</li><li>我们是否需要最小化迭代器，指针和引用的不合理性，如果需要，我们可能想要使用 node-based 容器，因为在这些容器上插入和删除绝不会使迭代器，指针，引用等失效。通常，在 contiguous-memory 容器中插入或删除可能会使容器内所有的迭代器，指针以及引用失效。</li><li>对拥有一个 random access 迭代的 sequence 容器，假设没有东西被删除且插入只发生在 container 的尾部，让其指向数据的指针和引用不失效是否是有用的。这个 case 非常特殊，如果发生上述情况，<code>deque</code> 是我们的理想选择。（这个问题不太理解，需要回来 double check）</li></ol><h3 id="Item-2-小心容器独立代码的迷惑"><a href="#Item-2-小心容器独立代码的迷惑" class="headerlink" title="Item 2. 小心容器独立代码的迷惑"></a>Item 2. 小心容器独立代码的迷惑</h3><p>Beware the illusion of container-independent code</p>]]></content>
      
      
      <categories>
          
          <category> Coding Language </category>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> STL </tag>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Pandas: General Use</title>
      <link href="/2022/04/19/Pandas-General-Use/"/>
      <url>/2022/04/19/Pandas-General-Use/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>日常生活中，我们经常会面临表格数据的处理，而 pandas 是一个封装较好的 API，我们经常可以借助于 pandas 更方便得处理数据。这片文章就简单记录一下工作中常使用的 pandas 语句</p><h2 id="IO-输入输出"><a href="#IO-输入输出" class="headerlink" title="IO 输入输出"></a>IO 输入输出</h2><h3 id="读取"><a href="#读取" class="headerlink" title="读取"></a>读取</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># csv 文件读取</span></span><br><span class="line">pd.read_csv(filename, sep = <span class="string">&#x27;\t&#x27;</span>)</span><br></pre></td></tr></table></figure><h3 id="写入"><a href="#写入" class="headerlink" title="写入"></a>写入</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.to_csv(filename, sep = <span class="string">&#x27;\t&#x27;</span>, index = <span class="literal">False</span>, header = <span class="literal">False</span>)</span><br></pre></td></tr></table></figure><h2 id="选取"><a href="#选取" class="headerlink" title="选取"></a>选取</h2><h3 id="根据某一列聚合遍历"><a href="#根据某一列聚合遍历" class="headerlink" title="根据某一列聚合遍历"></a>根据某一列聚合遍历</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 已知 data_frame</span></span><br><span class="line">data_frame</span><br><span class="line"><span class="comment"># 固定列名</span></span><br><span class="line">col_name_list = [<span class="string">&quot;feat_1&quot;</span>, <span class="string">&quot;feat_2&quot;</span>]</span><br><span class="line">data_frame.columns = col_name_list</span><br><span class="line"><span class="comment"># 聚合某一列</span></span><br><span class="line">data_group = data_frame.groupby(<span class="string">&quot;feat_1&quot;</span>)</span><br><span class="line"><span class="comment"># 遍历每一个根据 feat_1 聚合的 data_frame</span></span><br><span class="line"><span class="keyword">for</span> name, group <span class="keyword">in</span> data_group:</span><br><span class="line">    <span class="comment"># 遍历 group 这个 dataframe</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;The row of dataframe is as follow when feat_1 equal to &#123;&#125;&quot;</span>.<span class="built_in">format</span>(name))</span><br><span class="line">    <span class="keyword">for</span> row_index, row <span class="keyword">in</span> group.iterrows():</span><br><span class="line">        feat_2_val = row[<span class="string">&quot;feat_2&quot;</span>]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;row_index : &#123;&#125;, feat_2_val : &#123;&#125;&quot;</span>.<span class="built_in">format</span>(row_index, feat_2_val))</span><br><span class="line"><span class="comment"># 查看聚合的所有 feat_1 的值，去重后结果</span></span><br><span class="line"><span class="built_in">print</span>(data_group.groups.keys())</span><br><span class="line"><span class="comment"># 根据 feat_1 的值拿出其中一个 group 的 data_frame</span></span><br><span class="line">data_group.get_group(feat_1_val)</span><br></pre></td></tr></table></figure><h3 id="笛卡尔积式-Cross-Join"><a href="#笛卡尔积式-Cross-Join" class="headerlink" title="笛卡尔积式 Cross Join"></a>笛卡尔积式 Cross Join</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># label 为 3 的 dataframe</span></span><br><span class="line">df_label_1</span><br><span class="line"><span class="comment"># label 为 2 的 dataframe</span></span><br><span class="line">df_label_2</span><br><span class="line"><span class="comment"># label 为 1 的 dataframe</span></span><br><span class="line">df_label_3</span><br><span class="line"><span class="comment"># 初始化最终的 data_frame</span></span><br><span class="line">data_frame_cross = pd.DataFrame()</span><br><span class="line"><span class="comment"># merge 两两 cross join 的结果</span></span><br><span class="line">data_frame_cross = pd.concat([data_frame_cross, pd.merge(df_label_1, df_label_2, how = <span class="string">&#x27;cross&#x27;</span>)])</span><br><span class="line">data_frame_cross = pd.concat([data_frame_cross, pd.merge(df_label_2, df_label_3, how = <span class="string">&#x27;cross&#x27;</span>)])</span><br><span class="line">data_frame_cross = pd.concat([data_frame_cross, pd.merge(df_label_1, df_label_3, how = <span class="string">&#x27;cross&#x27;</span>)])</span><br><span class="line"><span class="comment"># 重新排序</span></span><br><span class="line">data_frame_cross.index = <span class="built_in">range</span>(data_frame_cross.shape[<span class="number">0</span>])</span><br></pre></td></tr></table></figure><h3 id="某一列的所有取值"><a href="#某一列的所有取值" class="headerlink" title="某一列的所有取值"></a>某一列的所有取值</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Series 化 unique</span></span><br><span class="line">pd.Series([<span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">3</span>], name=<span class="string">&#x27;A&#x27;</span>).unique()</span><br></pre></td></tr></table></figure><h3 id="根据-bin-分桶"><a href="#根据-bin-分桶" class="headerlink" title="根据 bin 分桶"></a>根据 bin 分桶</h3><p><code>pd.cut</code> 注意参数 <code>bins</code>，<code>right</code>, <code>labels</code></p><h3 id="对-groupby-的-dataframe-重新设置-index"><a href="#对-groupby-的-dataframe-重新设置-index" class="headerlink" title="对 groupby 的 dataframe 重新设置 index"></a>对 groupby 的 dataframe 重新设置 index</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df=df.groupby(<span class="string">&#x27;A&#x27;</span>).apply(<span class="keyword">lambda</span> x: x.reset_index(drop=<span class="literal">True</span>)).drop(<span class="string">&#x27;A&#x27;</span>,axis=<span class="number">1</span>).reset_index()</span><br><span class="line">grouped.get_group(<span class="string">&#x27;foo&#x27;</span>).iloc[<span class="number">0</span>:<span class="number">3</span>]</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Coding Language </category>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> Pandas </tag>
            
            <tag> DataFrame </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Effective C++ (IV)</title>
      <link href="/2022/03/24/Effective-C-IV/"/>
      <url>/2022/03/24/Effective-C-IV/</url>
      
        <content type="html"><![CDATA[<p>这章主要是对于良好 C++ 接口的设计与声明提出意见与建议。而软件设计，就是以一般性的构想出发，逐步实现整体结构，以允许特殊接口开发的步骤。使用以下提到的准则，有利于我们实现代码开发的正确性，高效性，封装性，维护性，延展性以及协议的一致性。</p><h2 id="Item-18-让接口容易正确使用且不易误操作"><a href="#Item-18-让接口容易正确使用且不易误操作" class="headerlink" title="Item 18. 让接口容易正确使用且不易误操作"></a>Item 18. 让接口容易正确使用且不易误操作</h2><p><strong>make interfaces easy to use correctly and hard to use incorrectly</strong></p><p>日常工作中，程序员如果使用 C++，一定会接触到各式各样的接口。比如函数接口、类接口、模板接口。而接口是客户与程序员开发代码的互动手段。好的代码应该具有这样的要求，当客户使用某个接口时，如果该接口不能获得预期结果，则代码不该通过编译。</p><p>要实现这个要求，则程序员在设计时需要考虑客户可能产生的错误。</p><p>需要记住：</p><ul><li><p>好的接口应该满足容易被正确使用却不容易被误用的条件。这应该是我们在实现每一个接口时需要尽可能考虑的事情。</p></li><li><p>接口的“正确使用”需要包括接口的一致性，以及内置类型的行为兼容。</p></li><li><p>接口的“不易误用”则要求在类型创立时限制类型操作，尽可能减少对象值被无意修改的可能性，消除客户的资源管理责任等。</p></li><li><p><code>shared_ptr</code> 允许 custom deleter，这可以防范动态链接错误，可被用来自动解除 mutex 上。</p></li></ul><h2 id="Item-19-像设计-type-一样设计-class"><a href="#Item-19-像设计-type-一样设计-class" class="headerlink" title="Item 19. 像设计 type 一样设计 class"></a>Item 19. 像设计 type 一样设计 class</h2><p><strong>Treat class design as type design</strong></p><p>与其他 Object-Orient Program Language 一样，当我们设计一个新类时，我们实际也是定义了一个新类型。而大部分时间，我们实际上都是在扩展我们的 type system。我们需要思考重载函数和操作符，控制内存的 allocate，以及定义对象初始化与终结销毁等。因此，我们需要像语言设计者设置语言内置类型一样得谨慎研究class 的设计。</p><p>对于设计每一个 class，我们都需要考虑如下的问题：</p><ul><li><p>新类型的对象应该如何被创建和销毁？这会影响类的 constructor, desctructor, 以及内存分配与释放函数（operator new, operator new[],  operator delete 和 operator deletep[]）的设计</p></li><li><p>对象的初始化与对象的赋值应该有什么区别？</p></li><li><p>新类型的对象如果被 pass-by-balue，会发生什么？copy constructor 用来定义一个类型的 pass-by-value 如何实现</p></li><li><p>什么是新类型的“合法值”？</p></li><li><p>新类型需要配合某个 inheritance graph 继承图谱么</p></li><li><p>新类型需要什么样的转换</p></li><li><p>什么样的操作符合函数对新类型是合理的？</p></li><li><p>什么样的标准函数应该驳回，我们必须将其声明为 private。</p></li><li><p>谁该取用新类型的成员，这决定了类中哪个成员是 public 的，哪个是 protected 的，哪个是 private 的。也会帮助我们决定哪个 class 或 function 应该是 friend，以及应该实现一个怎样的嵌套关系。</p></li><li><p>什么是新类型的 undeclared interface</p></li><li><p>这个新类型有多么一般化？这个多出现在基类构建与类模板构建上。</p></li><li><p>真的需要新类型么？</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> Coding Language </category>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
            <tag> 书籍笔记 </tag>
            
            <tag> Design &amp; Declarations </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>github 国内内网加速</title>
      <link href="/2022/03/24/github-%E5%9B%BD%E5%86%85%E5%86%85%E7%BD%91%E5%8A%A0%E9%80%9F/"/>
      <url>/2022/03/24/github-%E5%9B%BD%E5%86%85%E5%86%85%E7%BD%91%E5%8A%A0%E9%80%9F/</url>
      
        <content type="html"><![CDATA[<h2 id="前言-7">前言</h2><p>最近 VPN 被墙，这段时间博客的更新都受到了限制。还好最近使用了新的 VPN，但是却只能在 chrome 上连接网页，登录网站使用。这依然无法让我使用 git 拉取和 push 博客。直到今天（2022-03-23），才通过筛选网络搜索的各种方法，发现了现在依然能够正常使用的，快速 pull 与 push git commit 的途径。</p><p>而这个方法，就是使用 HOST 调整网站连接端口。</p><h2 id="使用步骤">使用步骤</h2><p>假设我们目前已经有了一个 git 本地分支（如果构建本地分支等操作不在本博客范围内），我们要做的就是保证其正常使用我们的账号 push 与 pull 本地贮存的 commit.</p><h3 id="检查不同地区访问时延">检查不同地区访问时延</h3><p>登录网站 <a href="http://tool.chinaz.com/speedworld/github.com">“github.com”国际网站测速结果–国际网站测速-站长工具</a> 输入 <code>github.com</code> 查看分析当前不同监测点解析 IP 的访问时延，可以看到总耗时最短的为新加坡的站点</p><p><img src="https://jason24-zeng.github.io/img/github-%E5%9B%BD%E5%86%85%E5%86%85%E7%BD%91%E5%8A%A0%E9%80%9F/2022-03-24-00-33-58-image.png" alt="时延"></p><p>我们记住它的解析 ip: <code>20.205.243.166</code>，这个 ip 我们后面会用来作为访问 github 的 host 文件对应 ip</p><h3 id="修改-host-文件">修改 host 文件</h3><p>如果是 mac 电脑，修改 <code>/etc/hosts</code> 文件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">su vim /etc/hosts</span><br></pre></td></tr></table></figure><p>添加如下命令行到 hosts 文件中</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">20.205.243.166▸ github.com #/t</span><br></pre></td></tr></table></figure><h3 id="重启">重启</h3><p>重启 Terminal 之后，再使用 <code>git pull</code> 与 <code>git push</code> 等指令，就可以快速完成。</p>]]></content>
      
      
      <categories>
          
          <category> github </category>
          
      </categories>
      
      
        <tags>
            
            <tag> github </tag>
            
            <tag> host </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>gdb debug 调试</title>
      <link href="/2022/03/19/gdb-debug-%E8%B0%83%E8%AF%95/"/>
      <url>/2022/03/19/gdb-debug-%E8%B0%83%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="aa8b5359a4829c5c724540d6a7d1ad402670d958227aa22e2b104950acb0c350">d8d42b59f128a57d0f6a623c69489aee7ff2082c752407f2e29e1e02c1342f4fb5f5bfe82e9d0e9e6fc121336e8a78913e57db69b090fc15c8d2ddc53790cd1342c3d7d400ecb77279198b098a26d747aa9a9a193e00f6f9f25659461918a28462196ac25fb049398124d0baae529115b165657f5cebf09669dce13a965ac29123787f7ac02e84ec471fb6a2be582e06214148a3b4263b72f3d2b90ce01785b4235455ac4ccf024aa68e4d09f46366c465ba61fdabee187e63acf96a3de64e886142b8fb0c2ad45ecda8a9da7725a9395d512688efc9efa9ece08d958b3e29a72db1082d52e432fe5535ad08f116ebe125146481e05fb7a92ded592ca6a762835a19eace9490419e6e439dac61ff844edc36e38d7a7518abd758bd534159c6babe27c896226529c4cac6d81d757b57af011dc7fcf39116a69869f0b0ec10f846ddd90d2a8360a22472e7df06ba8b976d79c98ff2f2596e389c423a386ae8e9290da61d4b605e87fa4a3795d9ff85dad2ebed9fbd8d5d6477b2b979ed4131f1eac96aab4c9f1e457bfe8a7004cdd4cb2fcc26b8f5c6de144e0a3249ea249a565b4c7ddd90cfd62a8915ffd11ec7a9dfc6458d1a14b53f99db269a39a0ecbe4a8aa7a683e8ff2a5e2c7124abf48041b1f676a03ca7f8620b354ce09bb95014dfb5a06f6e42ae9cd09e7645daeb31e6f949a92b8401844bfe0b4e55a93ed00889ac800d6e7fad45f8848a1f7b0504c47e2b55fd8028686b577936c567db64dcfd925a3db1589fff8aa1c07bfa854feab6f1afdb014cae0335652f6f28dfc4e2d45b52e4f711ff8b42d98b29e11545ce762688cda9cf64918079646180f5cf952db038476378c05d2322ae06df3527a33de2ecb98c9a493d4cd0529afcaa0212e5579ac77f57a95d43d23c171db93cfbc2cda6513e682294b37ee74b1a2a81c07f955a04453b3b2aaba5ee13f00f58a4b06b9702a44a176618ffc8df1e7e48b7582a48415ab0a3bbdeeb36a551ff7fd100044eaf47d028890087eae0edcefc709cbcfda4d32d638d2eb7858fe0cea189805853d8e3d880c04ee6194dc707fb38f5ff57dd60c6cafeca07b5e8b3c240707d8c4c1a8c259f06595f5166b0d0032fa642e26372424acd919044b71c0c972281185913ddfa67f36726754c8c364ac9e0748d917fd1069fc7b5063a2656b3922df613afdb49eef4a272898bd8be6ce86081a13e5a89cab0abfc59e8cf48a1fa839b6b8dd57a79138fae7a6fdad5a3ac7076c4ce2b8f96b93352df4c3ba6a52e904f1dcf4d3db5dfc865ff2f4a48af599fc48195c07dd1b31cd07d39a630b1ca8f767c9ce218420baaaa3239ae1cb54f598f66995d1411e2fe31cb04414e68a3af01984110677b3744a255d77fbfb4ec37e8872c4628293ffa0e8451927ad14266a764b1cc7289d4493912e15998ab1139aae99e12d4d680212c30e535272fe319895ec8c8bda8bb868e49282accc83f9117b8991075620cb96742e7353ebd10f2311a671df0949bf4ea392310816a07a56cf5f9e703cf1b5f56f9b5617932c0836e6da59724ace61de5b15240bda69db1e3f401bae751277f1b2a101ccc057469cc3f2c8e8367c7ff5ae0292ee9bc63936bd27c4547276bbeca9ff5f4395e577ff3bffb9dc172e2c542e97a9d7097c6c388eaecd42fa0a897504a4ac5df9fedd24d435324a4d2a42c0b32d967b3c033f70ce33face9d3d188e7af2f8b9dedc590b81726caa8a88c66e197d6a400558e6d8128f53aa402f0e6cbfa18c77d4333a2f51e61f0dc79810f756c25aa8303f07ac702bed57d39fd40221ca4919103243943e4bb831cc4cc71cb6e2c6ffdc107e220cff2e2cd4a0d366f4fe5f9cf3526d10bfc434868c5448a201ac5c99e3737295159b01aa17c915464b3c69e86bc81ea06b819932d06360dbee434677d791237d6e8f4ae556e91065f4739a0c6203ae2c54825dccf696528815da87a6772bfffec1033029d3fdf35c13b1d39458c9b9b61161ac7fa1f2d5947592faea8fe1b39439d8519e8e1c244464d5c07f941cd960b65a80708b85aa34577949483878976f2b1481adae04ef1da51515f00829d7dd4d830c470bff4844b30b76710c0ff1a41ad4cc17d4e58620b345223c5fd18e0423a3455e7d478511336ff4e778a0b5c1ab7492fee4f4f66219bc0eb8f9002a05ca72b5891ec509b6a414c242f868d4d2756f425ed92e420f39ad4af77df5ee39a3c1707f5982592aeaa66362b3d9a73ffe29499342dc5c987348595ea107992fdfd1fef04f900f3a4d49f5c9aab1d263acf04ab1703a77a2d182da7330e43e87e5c7ce4895176a69732ef67edeac864c97ff23cffd55cdcc66bcba950ed5e7dc31e67c22050d903b081e0ce85524a04d7fe900f883f1b8a264e6b9aa379169e74cfaaf00383d69fb14652f703a9fe35e1fe14b1edb84073cc8b2e762ed09388a9150eba8fa87304954d5974ce7e4605074c89594a716ef656b9a7b11145b006d6f8f8af17d6426ca470f29a0808ade4871956e1cce9a384020153e2c25231e706d5fdb6444631d32b301d5f43a6ad97b05555e4da97cbf399a2fc0d05803b19654bed05c82fea599e248817097079aedf8c48e2f975b37a6179c9a9459553f0ad34301b4bb07af84561199f13cd4a6a00f6c266a63c5744ec29f1619510e78ff1f97f94d9ee1f5def8d5d57ca99ebbdd95dea845c01fb4c28fae4e556df99cce726598a0423ff7d59365cf76ab02a7afa0ca2309cb59bae2a5d406ed5ab05c73017c828824d9250f3adc88b0f815468d958a35965672f2d95c3b1320da2fb2bbabaf21f2cca9aa9e3b59927aead9a681240741b794162a365ed34dd031495df5aeae141e62f35ff3b200502c24813a5fbfab9866bb86dca86edb3bb4204147f131f774dd7bd542e1c7341e8c8223e18a3e69626945407c5eb0e84860805aac25d3842dbf9c4f69b80327b458bce94b75a54f567ded205ca366c64e78533d620b8388b300281bdeebae946722aae4adc8bc7c93a8bfe211cbdd444bf594343f099e06affe811886a6ad6269b450e24c7c86ce9d61755abd25fc2eaa3aa7c8b036ebdee8dc1d165b72b42ff06773fef3ec2c692ad7a0cd5db07bcc4ec5d02e2c3dc714ea9ba1797e78f8771a0fe8319ad5d07ab28883bd031602274cb7fea09cfac485e0a2503368b4efecbd12e6153401db2534d36f3f3b9ec8219eeab9187e217260bed6154099a8c04f091214b72e05c03439c70e1a8e01fb29b02860a10eeabf0682c3be145e05a1d7759631d9a67d4fd6d6e769cc5fac16c1a49729d2414c1a899d66871d2b6cb7d370f0473e8c4b1cf6435ef1fcd4d3332683b3edb5b48f12bb6dbaa0b7470c28cafc1e3ee882cc05cfedc712cb8e0448f244a7d4149c7eb0c611c852bfd5e48c0d210d06158f273b5336a91a7bf2d5848ab81d565bd64fc17476ac81fe18785bb5d5238c66078e5f968813634f6d202ed13a5f5c5443687ee6ff4021adec8f405f751f1b615b343adede292595a6d4c4fe0466d5d916b81f2b4fa9a4feb62256c3a39419cb04611608f16602171ceb823144c138811635cf172dfdb52303073734013bd618fd66fe2de9f671bab8256b67905fc420ed67d7d8f558ec848339962da79c2b1e3f7f80c0ce7deb1cfd0b6b551d7ff7dc8c79946f24e1327dddac1255f03558db8bb9386831850bd855fce259198e17be346a38f146eaaa0d482400c105029c99d8bc4d4de8fdd362df090ed3516002e97f56dc9f014b6d157104afd83b3209265e0e889dc1fe6c2dfbca5231928cb08f5f0e4eac8fbad62e0a9177e19d9bf3bf6a7df2d9924620b04eaca3b82fb1d436a47ea8ff2837457a71e3f84b0aa2fb340eabf54d67292f2d7769f0fcf2ed9806813be2e97f14225dbc703c9dfc11063503b04c083a2e036003750546959cdc6efbc348490b97b0563a2708039a1eb3f64b50d9a6d982825a8449c06e7ca5db0097b9b36e85ad1f7e7d668df767af86ab82cdd88fedd84fb155c1355e3b79d8b3772996b237cb1a8eb03a43797f8257efc8221f2c64fee9a7b7783a4d219ecd2e77d06fd42380a6ab1a3583c43cd579daf5c78b21281bf26f65bbb7d033ee4cc83cfb5e399cb1aeb505cce461c32ccb09ca3871b2ef0b1bd4223e50ab606b294b71938527d514a947d1bae4e1bb76bc50807522a0e9f9a6cf68311bef0cba20c476f74b0d4edfe3c2e030ac05121168b5d2578becf53944c7c25f40ee1fd9b6f34078ea1a7796dae6e1c351ac8b522ac7b8665b1b6388446c7ee87aefa76c5daf46e79ba539bd61738cdad2a137215e6b412773b87c6f140efdc3fecf8640c281ddf9e4c541cb68c50300b40b2808bbfe767b39c4056335f5a84b3b96f9011a1b06338679d27b2a598ba1eaf18eb772b0164235d7714932ae830cecd3d8f1334f3550be0b4b1a4a66b7209646ce6677594c6dd06f7a164589423044d5222a4b19be13cf69b4501101f07f58ec17233191be8bb8615842ed342040d233eb94f90721a450fc589b9c4203268fc6e6e4e0773c686cf1c1f8391e9aa3b7fcdf58557d47dc5f743b823916b77b7a287b689dcbfe156cc5a5789edfbf48cf0992ee91d7028b7d0d62e65b0ac46cc98007e07f1faf2ab91a828ad600165e83feddcdcde5e1b91ff5e083d3bf8b139e9f56318b338f3c667c51782cd35a590c9df99d3416ed1f4110b2d138cbd2fc875dab5e0d9f9c3057f3fdad8f0b2b84044fb5407f6b32d4d1c66867cc5c57c8f0c2c2ec0fa392bb20f4b27b78802963154bb7b1c75e0f4d900a25a2d2e476ddf1c00c23f26309672809e11b841846619040c3680026a657f3063cfdfbd9c581afbbb3b4b026e3b98656d583e4939c23bc914ef10ffd5b1d8f3c9ca68f274e45f29e9485b34e33ddc26ea0a769e7b87b5c1898679cfa855653854484b67852a556b4664d0946ad6e50329edb842da0ce7aa2ec0ba7791f417534f3c2e36c330c9d9b4791d134819401fb761019d3324ca41897dd7f523ad4b2815d24e0da463216e46eaf13d493223ef823a395e79e492430a3c7c8300cfd26b0eefd62ee32f803a57d75a3cc428f4a2cfb3082d2d58e8b959c6f6c43b8bce13251f2ce2c20d134ee44d0ab869d91c2696bc47c03d29403532e1b2852090d9fbd447b924719e0398dc7c46ff43451190849a713670709d888f7d5b97651ed60fbd6987c887e93c18a93b4a25fa5fe9a0e3df58d597e9fd1bf08046bec38b956674b025807a4e55e4bc0b67b7cee7936a12722022858048c0a81931ebb965b41876a58a23fa56642fe8bf93860421bcd47d1ce4da8c24a1a9abfa4433bedae6ff273a8bdd6cfd4d3cc2f3342dec6ad8ce2cffad27573858d6a79fcc37a45ae248bcf66de22465072e6b0fd30eea54681fa88c63258274d5ba8c258d3cbd59238f8229dd0b91d9adf0727cb275e91210e8d1c9243d6a2668324581cd72ad5c2b80bbe0398c928cb1eca26c6b4940e203c6f71c9b07315aecdb9468b57a5a43f4aa152b825d7ec5b449b6c3468708b877fb2383fee60f819e80f7bbb21f8381d213be36cf885bc1f6ac31ec07c507ee10abf2119b77e62afd7e967ef291bfb7c942c0e0407064a45b4aa711be560038268046aeeceb5cc247d638d67aa0fd37462e860d04b9b32b3a6591e3e915a80b71018307e1b1bb2434c5070f4b8d55db461ceab4acebc2c33245517a11ae3bd217beb866716652ff2905940d9a98a98b377e5177c61cb9399860359be45e6b3ee8f3588478d5fbe9e2886f45d987166c8251ca67d7146132d6550ce9ff60543dc8239adc9bb41e0d01e0dfc9285c78c31ae1561ab0dbac6a2f7cf00644410bfd573ff75c6e4bf5c2004aaa5891dd8dff7f95b451bcf7052cac513c2493408d7cd345980069785498438fd8045674590307e2d29aba06b792367afa57896dfb116093274be6d5cc2fdc49d1d192c46c6d5e1f134a56a790670a4f06e6c2b9c7ffa55ec1e28588e5572c23aa9fa6a683aa209f25d8d2ebde80d60feddbe35a1848edcadc2804fed92fef0289976843a4dd0fc7af322c7dfca4b77deccfa9667de258c9d09a6270f5b9c55dda6a46b75bb4eca95106be64b3c5caad26043bd74ec8b6009ee05a1510f0387affac70cd879c358b612c2943a379e5efceca965c8b09e43cb4f0e92e00ce35bda34f140d866477a7ac0a54388db079aaf30a766aa8b53008130b078a382abdef1b2640ae8b6109049d71f3918177776579c85ce8284907e2c75da3f63f4117b6405f3fef8e3ac294fc19079d4060682717b6f9fb935885b3667d4e7efa5612157bfb5a038e0f59dcaaf853cd44a80a5d0647e46a2170a256d30218bc88ca1285a6d07ebf97c094ec5f6ba655b3147eb529305452191c6e64f23ae7181635cf5d160690bb3ed51aa66aa39314978abfb8d24f3d96899c2c12414f37401b274330b117d7c81d31572bd964dd81f1d67041da1ca274204392cdf13696a28cc488b65aded783f67910d431bb4b4b19457762a0d1b198e91d244ae52ca03d12ff92541476c303fa59f5335ac738b39b9e4fcbc57148c961ed6e5d28cc4516282e776bb61713fec85a4a900a5e53bd66c517693148c04d3be3b4ab1c945daa8948090ecba34f410d0ef67da1f671b1436dc135f31f69c48e05808a07577fcc711a19b97296d453082032439b81e705e2687441724435876d6175ae253b2d03a1b3aae5bf62acc76e53da25620e4b6d7c8427b9c4782619073509071247708d6744297518cab5a064a4c6bbb3dee30913ac3147c8667cbc2448a15bdfa5b11f42fb70271a0c0ece9c9f4075b03f4f4e07cd372a68e1f59937bf693b4895432f0c608704159883cc1b2c49ae14122293b8515c2f9f43accaa1e28514f81bdc75f347b6c9d055662f1f689bc956101cc64d2abc1eba53a0f9678b48d0963c7c39075e56a9e14a8e0abc0f6fd079c2604b7eb42209e686b345c6791092c324dc718317e1fa1f61668f235b1f4a717ac2435fddaf9de7b238977149454ff28121ead7cd8ad4a67ae4060e35f4c9f9d079e58d1acd6c18421a416d0ebe2da246932e007a67acf6009327136d3d864794ca1d85a7f494af157e219b1c5635a00d3850b5327d5c24212ecebb8509aa68f9228dcf72ee03de0770d8a2d1c3edc3c1657cde6cd16bd84633dce54f05e3233bbe8a7b17a5dd0ef51063ef06ed115d8a7370a5b7e7e3e55cb72e58f17fbf876706cf72a3ad583f0362766ea3c111520c877634406b447306e190e08116b30d9398fb5842e08849895590ae5ebc2f8ae38a11c70d1578bcadafdab3c7c2f68ebd063d927bd7d7458795f20751f175d3b0a04d8d56d86f5b0aea4921d20bda31815a0e2425d148617fb19034f27a6144a11df527565e1721639620097aead751836b2d47096f2be232c2c8f4719801baff090fb8e050394aa1a9c093671e0c60086a4279e298d0e0e94fa684956fe74adcd2328c0883143fe2405b1c3d123cbb15241794423bdd3b7ed4f6e7cbdb17e59673f5d7e5b8d69ba485cfa1badddb6c411cb4b7bb2a2a1e82e29fd918701a08ea0a591d251193c876ce1643e8316b5ed13b36597b7ec5252b0bff74808c363f3dcdb3e259b5405e4816f3b118b2a21f5e04d5f486ce6fa14aee0ec1119520a83fb220efc3f7f8de729d1e3c66e54dedb2c951954e92210b001f1dac726f0c9e007a0595fbbc2c03052ec9c6c8d941e853119e308cdc9ef69f1563d3a36f6cb1846e21d2fa177ed125dc9f4cd246b0d65f66b81ca1687239845e23210fe0c32c557a8162f817bd73bec77784ec47b12b2ec5676f71bce13299f60c9546ac7805688397daea8095e5adfe8519faa48aa0257d78b39abea932830963a3c40b2b354808633a3d2faf0926f86f7f0c04fa608f6d1db9827d48fd0cfb8f618411cf586ea1a6550a1024310a4caea9fefc0b34bebfb0a1d83bd6d5263d47044cb01bd625826f4d2084f0a5f3156ef26ead071867607284349db78f15db0ca27a6fd860b5e3f9ab2581ec8781e2566a7653ba003b5d262f90790408dd1caa09ebfd321e8ef2e08620f9c5876fd5ba66c1b086d541f76643ec34650a6614c89d40b1d4527970d40b5f1f12cfa22e49c815254ed74bf59526862714aaccfdd27bc1bb138c3af5c67127a06fb3e80b656372ef91a6d99d2e86d29c64c3a974dc4ef6aea3e87814f3ed85b58ff5a061d8af1a8b24806e7aa360746a32628e1b9ed06529e4bb7b8c4f6a44c019890a89548323d384c27c4fc9fb0bde8fa9582653ee0d7ed6a6bb2ab39b71a18d0c09d242c083f1633dee2817f620da5faeca72b01e9ec9de42dd23c535fb0534805b32bc75590d61bf7dae80ef52b6ae1ce7325db1507893e38c5deafcf3824ecaa56ec17c0495e66c25525df0baf36f811e5bbfe2931cae305bf0d66c7f10262fd92a7f183c0c657561425c5bc287803ecd7af6731bcae5527472bfd1da907a64150eb9355c34d7ab49525f778541560f5afde287190de6bbeb75cfe606a1631526f7151243ae639b04a6027e9438400ec8da10dab78ad9ad64611107b90783655f8028a468a398f0a3c5e4046322fcd4ba10c85c6c09c9d8b020706665294aef2e1d5d6abb5825495138c88ae3bd7fa5499cbd94f93b1012e3575f9dbbca50873f6ebc61870ece6eeb3120a8826a0421bf814c7e7ec007a120d77f56c001add2b055708f26bd2ef7089e16d582eb862e31eed45dacd0b3ce29323dcf3caca541808fae27cb20d8dd8ed3e79c2ad04df23c4abc88ded96e18148beeae08c8d7591992a3dfc46e1dcee55ae3b3021453877a6f3e9f04ea34d4505ea17f50f9212cc7b75dc1ac19b9110061df37616df73011854f16b7669a822ae5b8fa11ba8ceb1e58ff328df7cff9e50a4d4e043a39157ba5d29d1ccc5fda994d498b18479dacf3abd80bd483155f80a396aa1a3558f3e99122becf80a3d7b72f974c1189e01f283da9d42e91d6168b06049a910b6a92e79f4786e088deb69eeb6f91ca6276cd4da5e27d3ac2e47e21577b008f6a8c85ea847569a44ee9cc82ada26065d3cfa4b3c8c2f5dea6b80c0dae70a442c0b1d2d787736c5d011e1e98e41658c21e890fe9fd5f77672feebf67958f2c054cf39307b3cfb8f4da0f0ba5f52a29c710bf0f9ce55e9d7e298f126ff8efc5a83273d557e21e7cd7a0a664e6e14175b62a880300bfff25d9a89915bbc3395b6d7646b75e50f37792366505dd7a6f7063b702d7d0427f39d999360994c774e6833df0da9b07c6b2ff5a4cc17f7d67ef4a60853bf0426428b9a95c1d97c3d5e493713c90ebc70b7d6363049d280a34b065a6e1e1b93907052e8920b37157f4dc503b785502ce0f38458327808c0e183588ca01373bf70078b2f8cd7f4e4484b0a401f67d3a902845fbdce64199d86116308847e81cec0c5872c025f584fad27e3dfb1e14c015529f24f88e30f3d2dcb5a677de44225493dc185c35756c5b31b70625e099849c3fe2745508e1816fda002254dcb882cffea27792e4409653f686e1e2b1de4bbc24c4ca3a686c084e70b3d0f46a975fa19b31d7d62e040480f92ff093f1ef19a4a2f72c369d20d16988dee0508b4702cc019a666d0f5a4e43b4da9d468a57a7a7e230bdda96fa44c290dd7eea0d542e9d8343248f5dae1d951baba892e2603af3a2b4676afefb0e5c6c6bc2ce2485d69d53428f53fa59a77b62be0c2503b6f72c1c58744d88f9dff93a70b0c194bdfb9a7d0796e719275e414e560aba879daa3c4bb3740c9da6a3ef890959d2837d69e2cfb52d99769039b7ac2c62296ba70d27afd97ee417bfe7fefbc69ddd35d8e127246e871ed0f6a8c2e358e7ddf9a0440ece3945dcac5440bc71114b29c7fc6720e080c92f3d084f92df446354de440632c4322a3f827d6cc21078ce1a75fa22d6e320bc399172b37c3f58c137ad38b0965e35a904ae09e8fd94c8f4ba6aea46b9a4dfdcd3387bf670084f3fdc510129cb826e57fce648b6e2b4227d716af50749d5cfca61005f279d62fe60dc2ca5febf8b025e1f9d77cc0705b7e80592ebb9db1a894a3af57ec71f2efb3e48a36e5bd56b22369113cd261e893f85215f8fb2010e5c68a97e3a2d8829d53572e2538cdd775b20348973c343fe75b610f48d483d64c45bf091e133db5b248a0c71fd3f847d65fca08e8783095da1c6f3fe2ee626def26ba0ee9e4666369e21f28ff90d184dfde76a219a0b7e48fe232df2350961e25d435f0c1c99c01642dc34563e1f6e70b8b9b02141ca29196fb0e1140b53484d0514380b4fdb58caf690245bff1ab7b2e198f714de7186dac097725a62da892498dcd5b49026c1cdc5f8947913135ade901acd1cf8d53ddcecd6fc9db175d8ca1811e2a7fe5d359744d57595e9e14ce537a1d30cab902affb37f231352796f0be4066581baf6f11f7b40eca63b5113c503ef6ae27ce0d2e6013d78a40fdc5b32001c8425fa1ef8b229778d965718dc18caafdeed7555e108563f9687525fb956ed79eef92a243b462a41ba76db42ed793125846bdf2af473e1aaa14c6ea05123927dc0820900068c198b4b6a703d660d3c5f0a8193936697ed38e78ded6a62c8722ee3403abd5cc6f69eb1e2d982314cca8bdb13c6a6df2f14c25013e81ee1891fe2eceb8bd6a33e7c9de03c33d2909881f9baeb58dfecb5e0e96578afa96a0bf52b0722f2de26e7c57915c1037533e411b924cfc5e560440efa8c1b0a11d5444fa99ab55c6a7a0c9c5b10798bb71e78432f8cd56d7563d77ed8922339f7ffed1b699bf4a64706d312ab5e85b8932ddb713c4ac04cb36dadfcbb633d90efc7e9523e01d668c19913498524d5b89ce610db91dc68c5ed6e5b05a7a2960c7c3ae46a61ad93ee3629a09d47ba4dda76fe46f5f153e40e6a248af50a88041ceb66396e9353436a9370206adda0501777e4f069b92e03b91f63c1e71defc266acafaa621de4797ef8c387e643ad1409b0c28a33a0f56adccf5f1f0aa1170e3860d8336e5ccfae1804e2cbe74435d0358ac343c080824d84e9a6666b1e595ea8297f968e083f6535b1a1bfbc04358f8e01b3e37aa0bd9deb8dfc35b8e6df531055371e5f5503439864c736026ed4436d5c16caed8d0a85a37f83fd0aad5c5531ab635a75bf6d22fb23539529fa151bc58eb9266afc56d91e88c1c117101eb81e19b112e227b31a1f15a583c8dc9bb883e1bba48165c9848312320568969fa1b6df7d509d79b19e928db0ef1cede9c01a814aa4a43de1a4779ae03555dda008f032177faca3061768381580f9a501291f8ff1f6abb8598404aee1dcc1d79ba1f8a07953cab7caf58276461108226dd96ec6a914264c43b3c120d8e7407a6098383fae69f9c1cf14c33551fe7347b58ac4fc84e2f888ed94628a99618a81ccdac8a44be3dc43c9e7995d4cc7ac149b28266262de5ffec50dde44559a9732b4edd90986eb0c39ad4964f93325bea38ece700a9174a296699942464340e89716db6b6f9962ed88d84f63155bbacc1b89e2578808d1f79e203fa47505583b98596e60d2998bde09edbdbb79407331ed60cc8c23a7417205c140d3f729eb841b10a63e9d47aceb25064b425b916c10575d14aae948325eea5e73aaf505ef69e65567781ed40b1d1b8161f16163ba445f484f9ee50e9424d342ec5f92c7e4993cc32bf3f5bda2e94c3cb694913df680f559b6653b058f9aa7fcd8516ba0788061d25dd07ebcfa6611a2421bc52d9ffd3c37ddd5405da92f245241df277bc0e1eb126feebe3c18153ad531cf047beab9470ee58060e47843dcd4e7bdc5f0ae3d19c68cad14234b93615ba5a7daab67e86fa2978d7398d11a9ae3107f9f7be84a7beb8d25450dbd7d507105172321cc1239b37370d90d615452ce0b2e07ec604909f054146e313d43ad8314c590d203bf69f1de22db3691b11a248b1873bb39b25dcd682768b4558ca59a419815467a7aea9da7661ac9b73185a7caa3ac1d24c5e0d8a62a4c5594937727892a92a30c1574a92379f6cca3162da34288c4a017ae4cbbc39f0a4a14db7b7a4979aa14b6bcd0b7e67267a508bae1ac4b7b21f25a53a39aa79742407b02998d69800f157afe100b2e4f7a6a0d1d7f3f13ae8d31c3b53d902b9adbd0e19f0809dff8d5aa9ec7409a2c20f6124f20aaaf15d19ea6a3d4402ea782f14466d58eefabc0785019859ce2a5ee38fe852f0ee60a7c618c608178f0ae90b5a42a2f7820d2039384cbb8335caa3ae8d2d0f15d9f8bf845d5826fc4d3df18192ae5f3cf2c8da1a625f100f89f037431da5e7d2643cf18c0ff6c79366426226638185bbac61786d0e7a25f1088994d0e0008f903fd5dcb300cb090a8a18319cc08d8267ffed69c6bb42e3f78bca1d052e791902a30bbd5e8d11521a92a7ff49f83a4184d5af110083482d4ed457629a3ae4043343a4a94f1634d3591fe7fd6148929280492d3f95edb4a0840f5d6f32cc8c7417d2acb2823a84ba8d54dbf96f06c366c793d7debfe30cad0d4cbfe26a1b2504b2188181e53e8595478e37971d231491eee4311652c439a55d03cd5b7d595968ebb25619f53a4a9e273a915e28f49e6391dad440bdc4be0ad8d763666621213a33b5823407d67330f076783a507dd33a95b99fe39d58d16b32ca84d7d7144d346df92ac84a3d2962bec37e54df2adf01ddebe4b5db76a8a2116760e12ebec5db301037dd41a6b7454a39c4c311836a162bf7f04fb1622eb947c29c7dd715ebe5a64a82f928f149efbb2f393249052222b7b95be90806c45d43bd7e28ec54523d5e7a2fcd8b00891df15c0912d70205d228a66371859ce806d39cb3f65cff392bd9d876afda06896614bd8ed6bc92fa4d43341a5b1e9d4d692ca09816dd65f6dfa986611d900459440d51bb519a40324d04e3b074dea1738b35ed32058ebd4a22fb3d5003de897bbfae9df1e01c618b1bf34029e9ef0c40ca95c6d385e945fd0d7f94d6a3fb3be2f0397beb632d440a415918677b0d46d92e4f111513203e697742a713f20031d92c64b7d09607b011b99c9b35d1abb0493ab47b64229f59cce8532e0aa8a06191ded6c9d8552467965977462c4834760bb25f150352551b5faf82b4f3788abd0220c2c46f1f0a219821ea304e77da89db76fef974e402754cbd66e714f646a96aba4cce1083c862ed7be4463396d0482262e6b016beba7edde1557110b289bb19e1965bc19ec0826c029f951e7402163a58d6da62b5407b5f12c8aeaf9c4c6c33c2a3cae7749a15ef471b7692a3069081c8ebc42bba1225162c6779d0fa889015fc77e281d682c826ac6cb00da6e51d002c3eea5d0e359e6273e1600cc6eb0cc1ab7370dfd12d49b3a9091b8cbd2f182cd190e0cfd63470e30da4f6c1d56c19f067e53e0adc87312109a5fcb18ffcdc4e0f37e5dea8e70415aa061f69e02a8cbc01b8311cff2ed884285732421edefb6f91cedb34a46cd1520c15d5df72e1e699288bfeee860df87b5686448753ed8567c0ef5520664b6f8f1260b72e3d0ed193b97d0f466031706e782fab0ba8c6bccd60e71983f97b812fdb8f44acd204fb922098a38db30a84f3e3f4f70436f7fca49c15ebaa8d7654ec5dd6692de60b4d3c27e65066a45c5aba88455165e6589058093ccac53733bf7781f4d1743f496ad26108d261424fce42b1b7c57f9ec64229ff1ccd47fea20930850ccc648608dd01c2cc9d290c612aae94ae4de4bd2e7831c12c65a2b04a049dfb8b3b55a1534b3faee0e992ecfb071826692e823f501124553de6ca6a5f50bc5b05596a966214fc4e3d76e4003c6d19f3fbc80bf09473a8803554a63c04a1a9542b6ec4378e585c4894e9c6e5b6e77c3c4a564eb910769a5b708fd615848b46eae1c54ea327421fbb697ac6def2fbbc57fb332fa4edaede8008b07406ce323843be5ecf2c50ff56687cc6ea75dc8526f00779d2e208aa4c36836077158b32e3fb3ecb2844edf559f86153a2dc7f8a74e2042b5edc6b70e1ce0ee39914e72225c4ca8813ca3334f8c2dfa0055ccd9ae6c90067876babdb8c841a7ff3acbef7fe8fafc95d8d12ccc23d122fff9d6bc06e6624ab689e21bfefc37328fc0ac1dab7a72288fac85281be18d81ddc45a4466cdd7c16c4d05a440fde2fb617a582bca779419f81e4b5b8718d12b1a4d26b762d4e2b588d7c8786d572e17714a8383601f8c63eff3c570f0a074e039222d192331131aab87df0ef241482744cfdce35a3b3866b3db3c5ba100ebd304f3a1bd25e54259eaf367595d852f891aca5ea623e6befa6e091790292b2a71b62c31c54f6fd47b259ed511bfa4350c3dcf3f8b3b424c74cc4788e074e84c4ace79eb0d9c25e97efa9b3f6dc26e04fd04f12c5fd8feb9e92095af485313c6fad32ef58e3b3b9f6d13c1e983402a370fa207d067abf16689ba4e2d7144122433a0f248921de4e1a0ddbb0c4b6b1a356b975ba4dc8749fb1201c09cd51659ce1bfd5814b1fe48284e80373dd33f76e33ca958e905b2fb0232c54339bd86b75c1d088085eca8114223268d33cc1c8832a04890bb1e35baf62345987127d8deb6f9265be17f928374169d867ed66b80038310bde0590acc5ff2dae841de59560510d26fe37daef2af59e51ca2a95e3b0f307793ba7baa085135c4d7dc2031dbebbe10e932904311bb6f5d7a1ce812b267ad08f6e1b2de16300f943ea7371a3ba3ea2767501cda5027043c18eedfc44d83bd8be57c93d6f7bcf15bd0b2f40c919630c16b9ba4965477608d1112b3113cf38fa2e6975afddaba3a108f60d80100513955623e0d4e0859f49c5cb3b1a2f4e8176c595b056b5944b85ab3b74befa5b95e7cfff2808dbb27d3ff287c0069a653fb45e2c43dccdcad3f4cddefb24f060a00b2c86da24437d2cc3436429d8124539d023e44a8d3015d9a729d54c567734381faec9eebd087e0ab22492c4e71316f72ba1da333fbb3e5f2c44ec9c4c8a2341c9cb39d45aee6e2fbf203bbcd7932c452bb90fe21f5c3c93543c1ba0fcf37fcbd04a8efacb3ba2e3b9915a05e06ff8abdfff32287c9f95af1a11463a93d658f134e0baa66d1882ea68c6e939cf51c8d9e3d5f3ffcb9047e0de530f89d54c465bb7f6f1105b52d3dee09ebed1851d08fc98bccd2a1e1da453f3e0d25a970510d39235b8211cec1faf3d65aa6535786fe667baf12547addfdb0d66112c6d1906cfdbad2a9c268d33f60e5c235b3d99d27ac5ea9b13e2a5dc08c2c6d3048e1e7650ab2dfe2391d3b9f7b6d1d527da30d5dd00efeaf1df32509b852d758731b54c896704e5641155e3613072026d939e9cc41eeeda4b048841474286393c35ec79cfc80970c3bb098c4a4a1ff44739f7d374e3e708295ae008925ac890524b472f1e08d5459d0bf8f24dcd209f3c2df8ccf04c71b357fffb2fd49e2b9aab96d32806867bf3829435e07bc18bd1fad4439860611013d5d0bfca8479138166091aedd2e48d2a753c265297641d1490230ef8cd5260aedb3eb7d10d93d271fcf32dbf5083332e9b9f04838573a28960ad70b330953c6637befb238c5b0930849048af72757939cc021ed118bd03b603b1bfe7267bcd1aa020256f75d46a3f84864f9d896ac561b462764c7bd359a0e5f28fa8f4e9b9637798d899d9327c36e1e322d43a5e672b922ebf0fe189d128d3aad14c36329874ebdc180dffa346b1f2c1d4939bcb9222661e2a8bfa4900716229b0e1fbe757c34ea05dd551bd391454873a0f2791b39a4a87e8fc7f6fb80e8de133af073d94ec21f2100b2e7b77e9d18dbfc69c9c1fbd9fe76a032e6cb8577cc47c790206b94dee742cf488782f9276598071652441d3afb33cefd396937f4bdd5f82f3aa77f6c1969019fc8b247a41566f9075eea07c444d169b3b2092064128f787c008ca54e9f840ba111c66dd1fa78cca64922e5611dfb76d0e66a085f8b3a9876df934d1eb6dcf2a99f513438937509a0dfb828a376368960a46db88e354f35a78b3c62e83454b66fa84752962a34c7f0cbe062b12a0aea3ab69599b6b1fde7b4f013baa99ada0c55377f0de9b92fd1b9b9c8a9c542f926063aa6fdf8fd871ac53e4648826027006652231cac9d212d6506b4e3b76ccd951cc4e07e89c7c85f6c4652077ed511539f2e56071cc5cffff431fd95830ebea62a85b61a4d016e2e94b9698fdd944ba9f2775bf7da46d4e97c1f637e57b5cad95e4a54982e081f0c6a229b376e87dc838916c3a68a830fc640f7357c164958bca011a35178975c6e0b62eccf10ec4bee4f405c48c7f065a5ca32d1eed83c03bac2af8875bb13eaa2c4efeb58c5fefa5cc8818b972a99783bb78704aa183d60c8dcb2d98022c1b4da365dcaa30cdc359aab84197971355c1f36a8565113b16f2aef7ddc4903a3a134ffae90a6ecd21f568d21f3e8ce6d030678d2a30a99aa19965b5199c45eeb0a59ccc4d7bf7b3454136398a719c939510f727a6b9d80faaf3bb286d0dd17fd2d286844e5f4234a70184d95222758f0d8ca32b008fd1fddbd8ce3464ec10589864b6422262bcdce01957d0874264c25cc0083e4f7ca4190ba3bb4cd22ea8f070850a2f59a1a068b04790bcb4c2684715cc741a52c64b31170a23126c91d1c7195857f817a73093e234b3dbf13d60f4f73127f24bb00a7ddb2136b7d5278158fbee1e795bc420fae51dfec86021d75e26912528873321a40fe1afa720dd849567f38a53269ddc3a5eec74e5dd66ea5e9df2136b7230f9be18e651fb3020f5ffd55f64d988103ebd168d146183e5335e7a282d919499f6ac6d31353f9875557ff97bd6cb6fcb7da0c72acb16c7f2f79d48246bd19565554f43534758a0272f811a33a2cbd747f463c6073d64bf9a1220a2f3471526584c5d970ee77100483725b12043fdebcbc3cb38c0f8de96a7f9b6b648bbbd2b6c77e53a66a5b2aba0c21c7acd3a73a50b49a3c6e03328c3138c31f9569d3a898af7692a78025aa722475ffa36ed9fac63e8a310fd82555aafacc41102f4cf249027667393affc9de8480126c30f355a02b077dccd844df51c8cad6b1e0b12cc872f4e97371b52d5d54e8d41562dc8f31d241bafbf5e9adba400ab1c3a239b2a510821148376c7e8d91e9e09cb24d4eb25442909643134138de4e10439e52f3823ddbe12a3530e6977c6af0da3667ef3f377cc746886bcf81fd42866df57dd07b675cfd26f232f023063ca3fda74039e61d833537fa6a11e7928671884fc0534de60e07199b3d4f598662bae47686bdf9db19bc83e91d90bd40967725c3c7b8dfa66c5d8563845dd418f110d734fec52ebb948e608617beabf237005f4295abfb242f7771d3827ebc1d0a2c71a0db5c91de8acfbbfaac04646e0065954c5ac67803b957545aeacd10ee52bb1a88def81fcd5400c412f0dd443efdabc5715030b25221842f297ff97b103557ea7b30bdb64a58679ed947853402ac0868094e1c726d61ead450668cf469ca0cf0948ebd678050d4795addb8bd8412b07ffe66f4b9a21ae4778ea08c84ba0dac27636a9d5b5185e85703973e690f09265a1209f0d2c1f7062aed5c0c085cf52384ee7634f9104f3e95564b8a67a7b2fe7023b13318238b9f06ac2b0484be1558526c2807e8672246df79cbd47424530e85738628171385e3f93d6679ee2bd433ab863fd360e76ea23a7fdb6f95c8a4221ae322147a4948579c0deb81724ac70fe321da6b4798246f445aa897028c1311ee26a653bc2428ffca61e3d80a9b61cc82a85a2c7e48111f47a50f87505dac15c9d8e873a7c0171538e3205a82bceee0e82988bf268f67785f18955433b18f32ab0dd64ed72b2ca846c84ad4c2a6d6859402f1de9dad517020605d3e7d5fa74c7deea17554078cbcca64770758e05e19c10d90ffe8d68a50724f25efe3fd59e91ac30a1ff33a6b9c2261c4e5851a74bfa748538723b864b286f3653d9192ec7daff6ddbec83cc6262081d99ca06b5bb30e3103a63f37992b684fcb9c1e338f95fad5c16c31d49135a5a2e649f4e911dae7004d99bff85eec4308e54a195dc308486ca614bc08b771dda4bde46357451b015090a8842e96b2cb51f9860607de0e947fa9f4b04055945fb252f426ee3c9515687a834ccc93ccd4ccb02f8144f64307a27a2b92beaa450886d6859169c4531c0bd5629c9e14d067bf94a477ffdbb8a96358150bcfa017ecaa3234a5176b1df4bfd3578c3bb69d963f6e6765ab8cf544a425ceb43521ea2c0bf27181d1f65a7330c76d4125eafbbb412764824bd0b4fb80b259af815815bc09b0c37f4e8b25add1fe041258182ed7696561ee87a68a7258ed62ac8e2e26201efb38967ec30ac42a5aa647fa9f6135df3caf3f77e0a0f562df707fbdcedd2298ce9b93f0e1529e6d16951a395069a615b53743271a767b186e2a9ab38557f696cc55e748498b29c34e1d918a9f2e8484669214219e42f9e653ddf1d50be24f10b2e132c28a77aee630a1d896d635ad5eff6e9e045fdd10fa3319da0fb72ed6a585f6c0757d5e08125e924a4491b95c609732e81bdd7c69a3f9792a70a4c73309d7f71d1430032f4cfd7f7ff5aa8f17fd83c638b0171da89f31ccb49aa7d0a8169fe78587c0ae29ef87b6e7fc38d4fd65ef2c922160cbd1ebd15c03df0f8c5f44b4a1d966bb4a3ca56f1d85cad6e77e01146887f36447d0befef4a98e20c408cab2a41709c65b72ca487d0a69eebf259ed27cf963ecd6b0b765ff193d9f96a960dd86cde2db4de2a020412c93bd08fb891d8d47c2ad67023e270025420c9f659e0fde04a9ebf1198b01da65dfc2b04daa9e5da87ef91b9abe7e7a35ab796727bb70a6989f9ad6bdbb62e4fb0ec6214065c52daa956e16a1d60e323280d3240293416e45cfef02aa3833867baaf9298fefe948343f33ff50bc78afba0b426a25d9a3cd268ea891139c435416f9d32fd2e8819be5046b52c3c4218c7f2c6d163b0f978fa7d34be42493147286f5aa6cadff6cc07de6fdb2482e8dcae8130cd0b1431d4bbe0845e206b9999d1ace028da827958e7a9b0f4490fd81778264dac0e8c44af756c822f50bc61683c7ba5e413ba546406792f16b0c6c9fd1debcc0be5d15ec6689e280b89a41323e63a885a95545ae3cd67f5a17607dd433c5206495156cf4007eddda6aa57178e5950643be57e20444760873eddc29633f2d0062a4ff5376f9d4f6ca3e0d9a898719b056f6b3ce09d3c830d8bc02fb63a5d4fe632196cc7022edc3ae39f7dcd1f420e5866ead738d12938a7375d8561857371a69d1677a2f2e99edc82531a6a7b9d5f5756f8e08ad5d446fe4aa05832153ac49b3e7b829e02fdc92e2619d25dd5a0ef376239bdbd1b60b15cdbca424a1c3e04bf09c5e9be3ddcaff558a466a841c3b04aee8b48ee0de3e5b9fdf70d466f69a2e63abaa9ebd12f46c91056982a439d20518da8bf0a6878761de7bc6428be9d3d1d4267f64ef416e7b29af75eb98dbff7996a7eb267661e20aa2f63755eeb54e1fd3c2a4b2aa81f27ab2f2dc98d7b2f2987192f1f1397f386e5d347a20a13cc109932e11a31c1a37d7ce4dd2290bf4bc1126c8b38064e31ae3b5891dab4a9d9ccb41806036d0bafde176a7f15e5099f7bc926d7435f3da4e5e74e5301e485d732ef93d90ffe0e312994858725e2403f2d4330e72bd4640c1c99643cd88b9a5256c02f73e09f1e330879588d810642487f039fa1eb46165845a95223c3d99030535ccd61f1ef05602eb6cd9611ca858ff5c3bec9e967f2897712163d4f3aaaa441d1fcd62f67083d9330800ff12baa013daf94f07fc2a3aeda132916d99362bfd1ea181742edc7e8cd48d201a132447c545a35ce660cf0ddb91eedbeb244808b6a78eed9f8c569b88ae06c0b65b34b7af816a6d8cb5382a88e8a2782d0534cf06e2de62736a24d19f5bdae1d44f8dabc5623c7b1003873bb44ab1733e066745a6169229d7d26b70363bcd8ac3156c2bd1fbb4a9cf02943ba04906ea4dd7e344f9f2f150e26583ad2886e563093750cd6633fe7cab051a20d29de3cdfda28c8c73a78de9cb6de8883ba5fa65e6522b854fd1737e24fd3bc5fc67d0c9a5491e0c4904f65d313246564c189cb8e7d48ca97817949d720865560545b2399477c4c303c8316b00f3e416b189571b7ae114880b84aa8f6fe20276478211ddf2c8a5ada871a159106fd952953bab25f162bafea630061d13f5b7cc4605987b21229ae0fd60046c5cadc772d2df3b8f18c622107424f3aad03fa74860eb143106bfc20f081a2665c734e0ec137fcd013d7ef7d3ef005100f681be4dc196fa6fea005fad3893fca957fb406e82e0157a604763de7fff701a9d2b5b7e263beefcd19097abbecea29c14614664175046fc97774efdc3a6ab6a5b48732f03e096b89dd9f320a2760b1b548f6d6f0a5d603d58ec0bafb85a20a400dd5d9eae8c970e0c9c8e0f63f5d023b33f2984dbf92ebac0d3eb6af2eed8367b40a63d0dab6935d3cc5f87e7f3cc5e7f348d707903c85d213ac313b92624b8a81d014652b8c19e2ee1cabb99a770b7f943eb99f39e20f9c360426ad0433e4abc394d566033d145add0dc228b6ef3ee613afd6168be9f4b7700a441cb8fa42532b411e3315c778410b0b60ddfeae7878f4518149d1fa7e724f0ea13af58c7384c9f33b33e555b5a22723d6134d435404ea794558302ba9e2c5df3da94d5281fd867b1cee8762a80ee499e3f9cfab53826009b1cad8cf5cd40ffbab913f194ec8a0900019895a5ab55635f8500759b4c11932f00ce22a4b46ff6f409e4a5a2258ccb780bb3834dcc2f0957189187a082350a3e2c797c3f04367d90f6d52387977a701d2c527e7b6b401f800de1ffddfd5cf14740c3911ce90e977b21621b5f68190ab67cb556086678b3d9ec3a7d544203638d2f51ab2d23e69b7becea84d285eb7aeb4c6a01291935839076034d1ed353901573c6095e021be015881d95f540662d686bb039db60f64dc8765be5521f257a0c302a5ef5e9f615cab0acbbc5fc32f5a668a1babc1c77405990f86847e391bbb0c7f1ce0a9c7366ab5589455fa5c353b3b33d552e1c64059877d8bf4c1c93c631e9fd4e1dfec28cafba50194d46c660a8745e7a84bce6a93daa8aa5f3fe9924a477f00c4448c07d54f8eb2c84a57ca9d458731af9feb8e722b17e68cfd23beeff81341d2914d379759956e2e8dcc170bea9efb6ef3184dff781f4ceea70db097a7a380abecc6d9a0a612c06f7d25cf1e4b22fa6823f4d00f1265cb182924a2cbd4fafac25960610bfc2e148b1d08d866d4e7f99bb33107030a01d50dde16ad82fdd4a9369ee39da932366b024f50e396bddc9b2b3dc53967c57efc57c2a4b74bd24a6a620b4e3bee0dba42fec463f3bbc396658f9e7a743c32b3836996cf43cf22125304b62c4b357b659eb7458a383851c0fac7ba9b29c68f5b85ed66e6e3be0745b02bce455d3ec920325b64955d7ee4e984f9bb726523e297a94c9e7e463f53a3ce417057716ff650635be21a3632483c9df94e27710bfdaab7a34b83de7c198579399925c1567be41e6cedd9b202edbaac6f2a38075e3bc4781773ebe6ff35e81dcc7f8c0c6279f065e5e85c1d92beccb6f2adfdfc08d5c1819b2d69aa5146f9ac35d760946d63f6c78010bb1a7b9f13c28caf99e32e7f1d312800d88a78f90199c1d76bf35910c56d87c363074a0492bbec276afb71461adc2e5400d0f479a257b622beab6797749fb0bc2fd6d935183e584603ed21949c4c9bdbe16eebbeb88adca7503f1257dadba05e958b3719e2e58ae9f3358959b051999100b34ad1585d8048e92fc89460a27e538f63a86ee163d1b285eddb095b281aaf86794f0208c4a065a7730ef0be11f3abfdf228d9999f4dcb89153c3053c9155b7fd84d55b72ee91c9cea48b7a6a09fe88faac58a75c14cab5f36e255e9583e25764b2161cae7724093484195d3bdf7a1897c04c86be1963fe3e241edf64735a6a80f3f3ce54f79a9ee58797a3dc4f46039e3d8aa7c1ef20519f7b43e0d86958525595f066db69416f65daefc01f03f147acc92b08255a0312ebdecaa06542441013878bbe95071536e59be5dd7bdeb01b100f7e1cd3ceaa9aef7123f9c24705dd9227d571e78a4aa612a9eb6b85d2998ca4fc24e74edd7ffff36c9089240309ca5c84afc52e3f6b4f61fe86e4a2534e65e76bd7f0b8e32293451bd2e7f7454821ab95a102e10bfca437defd573886bf2a5340f8e60f43bc835dd9031f966d1697f88ce3d6c46541ed265220074fd40569ef6a52e67ab83c90e00c842b04e3993921b385d51a3ce4ed3e6ae990c950f59a58e4dbd7a9948351276e8fdb0914d83fc9af67d4969b674ea59a63c7e4fbe609f7d6b8793c9df40513e21aa81573427331c08d703c0f46ac1386be78ef60c9af5e71bbe383472078ee212c407f946f71aeeb3fecaf88f896760aafcdf2762d17c5788f18a5bc6003bcfece7cea044b9aea6d0ba376b7a180be2d755786a67fc18c39ab948286ac728d924a27f31fdfc48a96ac79cfe7870d6a999d7c628defde897befba34455355cfaaa866a33271e7d0e723d7d8e44d01cc9c708f1937317137e7f1485fc5cba3a08a92c55e853523d2c11fda032c58f1a605f8c89e0c92db55d9ca7d564b61792f2a584c65158178c8a2f70fa3ab02a4fc947695f134859de7ffcd25daa787e8e42980dfb63e12e2e80f90d13ac7a6658e880cf9d24ea8132cf64fdb0f36e2657a943059d1a7df521a5b4c9292eb0f19479ac0c4abb1278d3357d90132c65ca4b34202efbfc7e968b3a301482a2e176ad29fe7c446ee52147df48219b2e1cc6ead5ff50b8f504e9246bb2739240a28a679c5de188f13913f86b1e92202a8bb0b6cc0fe8e46ec1eb4e46e9149e4a2580e0651adfabf8aba531ebff8fa6e735b40daf7018ad43693c554cd59f9c1749ef4eff05a1d629e5cacf4932b1692684808e6e49d5cf80bd0d596f4f470ea6ae3a7553df14879c9296beecade6dfe327f6eb5a587f0fdb9234f7fc16702f0e60db52fd39c25c646cd8d92c8de6ac5492b778bc3ca83eaf2813b82b1a034014e05b23742fa6cfd830a3f756dc69567afc764939b5c369bfc8313d541e41635ed7b7a572af97adc49d977abb1a8dff7670683fd766f3f1531abb6bc2b1361db637d43b220c71b801e4920c7ac55b2ff8b0a505546394fe740840fa9e79c282ff284da8406d4b396f61184fc3ebd9eabb215cf526870c833e49df816c60843e27b0360ac25f05045aae192337426fe4119f076bf7c2009206137bf06e6755a44e4b237e482443b0d4199533f0b38ca46a1a14b8bb9e8892cdf93a3caa50967a240f1b51865f325170383f9c271662f9e86fdebc3fbdd83ed904f21664ed2093ab9f9bedb68c92caefd792001e09c39b7a317a18d10d85607115c70b8ea2ff9ab94298eee3b57b2261dd936be9f846cf264fd66b090e6dcdecfe4cf6ee15d98d209dc4d3861b3974bc14a1b1286a97961f82b0f62bd129aa068815fb2a697d518455bde36397ae93ee44ff332e5c67bbd7ba752053995c3d64cec90d9e6850119020f56fe430b024ad1757ac8cf1c1945bdf65af8ad821f594f2c79b327d69e1424647f899af59325d91f21de1b1c202d6b7a0699b8e18b2c48d4acf2928f208cbfb7c44adcb48e21c4b6b161e1b6491fde93c8f17f13d72a5d6a4abcd793a06ef24f63a403a7f5da378f28e6377decf20d151c4b1b9bb52d0854072a1c21ea3f7b892b2f841942f9bda48efc8c1a152db7a0df1164933c9cb8fbec54ede03826a173deb9766464ffee30ff920e0acc0879e978e0b42a9ca696f933d39c0e606b32e008d7d1dd9f3acab0250a5295e09f0cdd4ca3898d98a096e991611fa1c484ac63f3e60ade9cd52e3ae30cf3b5f10299d8819870a6436282c71562db4798ac4d7e0a4b94cf8336075cf2b3e6b91b4b330667286dbacdd57ba092a8523bdbeef93aca6ab64e08049ad4a48937c72e410c3a09859803e03c20ff7fd55bebc29d618b47f1bead85a819e36e809940c30abefbcf3b37754e71ddb7f13dd264e18307d09ac10945bb53957cc15b7322144e33f41ec93233d9b823d60ba52c21893564338f6556acf83f6ec2db93aceccb81be367882b5ae4fd9aa6be2e9a43ad8e1f9541c64ff28decead48fb2890aa850bf236f796a51966fd584c8d996cf93caa50519fa3b110027a729dc7ec5c4f84614850aa0f0d9419d93a4a3d98025ea9f221196ae641ebd4a4d9aad08f0318034cf34e5efa7914eee1bd81558b3cb20f9305bd414fba5e22e184dc37affc536b796202be966ce99a7dbae4d9f15d6b82a4ab29a0c6b8ace3cf29bfad1704418a7dab552bc512f724e402440e20b5ae12d3b2118bd2e375cfb396b6b15af12a6d6dd74b2d2408ca3e73086f0150cc76158556870c1d9579e55f02437fa7b058db9c1f2ba94e8747234e3830ebf988e9d6278aa32ce82c93c10ce361017fb90945ee5790af8fdea71c50f2d413c80da0cfdb577c6038b1e9cf969ad62ef59c26da88b56243f2394727919a216a0637ee2ff907d82993414c5d1b88430d7e3c17fbfd2cbc0cb5b2b019e5f8872e730b4de3f0f20e8fb01d5a32541dc0b217700c0e2ca397b4c9d2f047f71adc456aca8b243bbcb7c2684ce1a96de8f335ee0ac7832f7798da402149ba865569ec280246e4556ba111f5886198ac14d00a78ce895e41c726674c2b555409f38767934f5907785f09e5fe05a5f81f9e95069dbd79d9dff242a4df203032e37ef0dc31fd049f072995be8f19b110bb2cbf9fd8714838ac4543967312c0e90527f0fffb72a9d07cc2bd5305db95f1bf9ead1dbe86b5ebd74999df159264882fda0265a41209036b51e2eefb30ac02357a6114eefe3815865bdb67979dd9d4864c0ea76e2297fab6c3a9000bae19d9c335c5831cccb09f5b9892e2fcc546c2416b58c8375e1c6cd96e14438369696ecf2ae96105cdd5cd6e2ee6997fe2d169ba094cbcc82c5923edd58199b073d2724221882285e271d16d51cc0c4dcfc3166d1834d8002c105fdbe0c18df0adfdbb5414fa8e5193e595a23377e0da6b34f3242f0f8da8f36d2b0c783e02fef87b1f38565b88c3b4f4f1cfa270308c5ccddd46a90957c1adaefde961c74016c9dfd1310fe3ed359d20518e8e99429a37c20fbeea00c6e174363b00cc60380346dd8cce10c16c48f52176d31aafa22ca25868ef4bcd0a942b61483594c91aff641112b0b6f653f28bb1f1cbfa8b16465ea7582478b0f366d46eaf4b7d82cf8aa51ca9084ae2880cfcad522238843e991db15f2113f01ca018bbd487ead83896c9147151d36826d660a2f0e5accc81d56d423a45f2ee729559188f92c1b184b28f5e1232ba2562d68d356da6febd6714e637a6d4b44ea7a74f5c6265c581e9a6d052d5fa32dd00f47ad7f7368492f129ebda37bb7ed6998f16650262c2262105133380e88f0d4de3d5af4bea997388579e745fd060c5cae32c4b48c0e599127c0ed6a53194a63c842cd9ff485daa9691be84531ad595ff90392752c14b94dbd9f4eeed76f784f82734a9ee1464ca42e627865d5f45dc157d5069cbb16dc2c0a053d60fbb2a67aa95d796a83baab958561e06cef716ad4803aeaab381284193023d1787414284b9e1dab111d87041986b8208866bcf1fe6cab3ce691dfa4f09683cfe5eae4b719de93a4ad81d8393735abfee46b625171bd4f4338539b3a654e73a0ff6de400e7e0d9b25d0242ad5056d83356124595a14538fa0d91bc2a1299ef8600eca26d49291a6e3822689a01f9b56b629869d64bce59047b0e88c1ee1fc58603d1e0e08128b27590fc7c54398984ee6d4737752417e345c279a6243999a42eab8308b767236dcbe590d7a6ad93a3056fc7879236f9b560192d4505803bcd1cd9d1a7bff2744442413ca32d5ef0e3502b48749fa8d9df9f3edf762e3fc77d47afa6887bdc42f0ae45212cec9f96ee3b967e82c51dc743d5d19b99f4b43f60dff3a281f9bf811ac0d1c77e3eb8e89371bcb87a7f2a020dbf94d5a19cb274bf141d8ea900c153abfa34d7dc9235f73e9b7dd7f6da8ea3d0562d5684b18f651492e336ad42c1caaf1cedad12cca55d67e009f560bb383b9323b6c31fae1dad91533586f44320499affb7a82144d5e107d274dc3ebb60aa0d6270cd1cc5a1b1f849cfe024b7717df8e6beda7c18cf2cd376f6f7fa304d5ea08ee2204b005757a53888df8ef55b4fdd9e20aa6785a6c295371ddd25c03f450b4991ccb09dd8fb9e2ad1fa2e164ac8d9f48fc0c1f77c1259cf1595e62478e60d7167265409386e710f9d79efbbbf6c8cf13cdc3c2aa664eb750304d9f2f60f913a14366a099a42446a0e89db312b3367060eff0be8b449c4307c8ccbf98aedb84783efb85a1d5bce3ceccf159dc8d4e5a9aab5126952f24dc68b827d6bf11f4ff6e92c98f5c050a2ab6fc2798d8de3978ddc6a314d833c0ea924e0308a2ed6ad4f6563075fc7c24606037fad4a5a900364275645caa08e6d6874d784eada3aff56fe41ea2d612b47ec3d9b79860bea656110f766c9b09035da7839eb3eae7e6461779a2c1bb8440fd51f3ddaf5817b855f29398796f0e3c0ca11f34788708698d7c51451186deddd570b0eaea6389518aa48db855b2b8ff7224d14d43d5fcdf438c091a39aa34e198b7485b385fbb20a60a2b680694da897082b63ca40185c6357f4e6918840ec04dd6c98c4f78aa9a29923d8d3a3a9b40c7b99b3b1bc86e18a320f73bff2c22765b673e1ae28c4e98dfd6a7e5010ebf939fa59dfb47741f31c93ef59c2d86686abb4d20720942b578653c1ce49f76450d17a6d05521c291e2c636b4b2b55fea4723b3615a7d531ba23ba6ce33a8ce15470f6d0747533c2db791eaff0b36c25828e9a3b9078a915499214d1a51be9a4b5d3462bf5b9e6c67c1ad196da9f8e3259e8f45bca50dfe98b139737b3e225ffcae2955c50abcbf1bff61f18b0b3febca6b397a1dc206f953642cca9dec0d476fba131cb3c85ef941a1c80acc6c2d9e33bfa750219e8248fafe26f51997e023b4d74def9173ca2616ca4b8c357b72b2841924a6528c5ebe9d15d214df2f0b35b3d04259f6eb32590af6a607b860fbc65bbd839b0615f6fec3f00036ecec4571484c21f25229d7db440e916c968e42963dfa1283cb6f250ad0d8edd5bd5e9a7f9d1fb001db070ceac01bd61caccbac99a918fb160ff07327a401750404234d1e0b47678cd1fe11a12c8296e2fe10a77fc76639b8f085bff85f4e3f1be042f70e9de0b60200f598d1da83c1b2d289e018de2be5c6115efaa5ecbd861ce67e017c951a86bfb716088b2ed368f6f928a3be1e264c296c454b1bd4693aefcc5913576ecf6ec73fac0b3355cc0c0ebce55c19aa334b49073d0258b7d23a69caa75ee750692552f00da586611e91918ee4a9082257b187d9494c71a9abd57c169d15eac44ea7e27d793446ae77ea47a9bc5f7d826e122c8be090f1da78a43a721d0f46dc3e34b436e7798c568febf8b154929319026fca4691c52c24229de332b12fd59dbdbec04ca0e99980210847fbece38ca9ccc1ea066f7fc34e2f7972b9eb321e172fe765a8ac3a09bdfd72dc2b1dd2e42f999cc2431764ab5d4196ce13d54659dfab759b276055e6b86284b75e4fe42f1b692c6e75158cffdb448db0efb64e76837045b7d98f33ec5c8ee3918cfe335f0a91cf4cae5234a6ca39bc6e884ecca1650269fea3667196c54e18daf909f677f9c0fd38f947e4d87dc90fcb3f910ff1175bc4b88e3ad6e4a343c94cfc3f5755054ae9e213b256ef4fb3101d520a0cd6ec903674e03323a67ab8ae41ec6b5bfbedafd0c02ac23e8049647dd63d406c5056f2bfcc3f7f60a44c7d575870d777fedb87ff319db0ccba0c27221b6d6d3958ddb8285ad1870942b981653c0d3e76306fd12e59bdcba6117c32cda992c45a872927c812686428f2df6ced903b587452c50b9ecc63bdab674024a6a9fe46f134c7f31ef9458eb011b1a3b507bf8e7520f1c6d9878bbcce4f2fb32c5b2c71fc077389838fda1aa7eebadb8a41da50045e29a7e6c77a05390588b4e8e0e9a5e0389bd8fc3fae809d992acae1f2bc3a47ea8f1afa5a9d4a220e3aec35fadd6347fea7fbf92d871a8b9c0c3591f7cc62df32be3787bc8616e3873db01420aba62658f58296c7ca9f5574983297d5a61645247b0db6a90625658006136851bbe9424d2f786c6f6df787ceebb8ade3ba2b23562184b33528fd8bde05144e1c866c6d7499e18de625cb601f5ff80760f37c740c10555844f3adf963fdc6e192fdf62baab136891cf2d301400903b758e263b50c71e8abeb33230c36bed8fe37364b316416b73d90ca615c4d214193620e262cae067c04632a6245fcfcf34b368f067be2158dd92ceb540a6d09ffccab04ad1ce87e8c90a5a4f178b2497812ca2f773b545002cab33d33f3d934ab0824d9e7820fed0dd6fcca604ef5963a13d799053b3622c1f3ab039884a1b7e5db62a0f8e5ec72abc576ab9dea9b7593bcff5775ee747acd062d7aba3a9b96f5ef9cc0fed921cdb4f6f182522b677a99f9e281f15b30cca2b1eea1579bc85574a7430b20c3c6ef896b87e89c3ef53a71f385deffc2e42421a2c90a557940f710ced5da42c4d3fa2f9b05989b979841a7f26eab2ac0c32a601e0ba49c9907003b082bd40c7cbca4effea898c0d63c25015087ba4a576ab0fe380efe40364da65efe33861b4c0009081e12d8e93c1423748b0483b7ed04d7c6a9812dce976794e7907a3742d4fb4581803c97cc3dfd38be4aab0c1d0b3b1060ac77e367ddda157b806f51cafce6d5ce22af10981be4359b1f7a595e1c878628234d99cb57e3b875daf96cf874a0bc31de515bc206f1b7a144b8f0217d4702885318c507f8eefdea1ffaaeeb46c42d5d61bc97298f23d64898f7492b4932abbadca624ac3c06be7789e081a432dbc2d805126106f127eb34e65ee59bd63aa534c5bbf56367f38b29033905ac6b8ab8783408f50d6e650a5494cbbd93b7acfdf37a8fb51f5b7be47df233d3913066fd39098024270a73610aeabb5c21f61c54a61e6283cc2ed4e893025d658b9d55811a5188f7267d1be8dfecf3ff3ac6f01b01bddb5a6cd0147d9f03027349ea1990a174fab6a8a20278c778300732579b31ae14178008c6adb4e3c729a5288870bf7aee9faf3cdea54402e8a2c9ec3fa21d85b98758770d47633d85ab91a8e825195f0fcde67fa67c262b3a090a27209f86db216c324b0e834ab9724e32586570658845e12cf3a2d79253737269e6599fe4c603258449e2ae14a926294f1e02d7f8272ec7ee99b461a1284e6c525611dc09cadc1ffc0f0f51c675498fcdad0709144943060c0e92766b205d2c3e00d15d722b47d7a65ca9c6609503f613acac5ea72bd8d8c9ca0a864504c2a6e3bbb911ce46ac06b397ad7d435b50d3cbf06b0d06a1927fd0959b437f024d9f5e1bab27e313aa92bc759d2a9b2fea92665ef973a9e2fa65a08279ff5d956196f863098452b7aa081e05e17134f5f842188a1c1835027434698681be6024fc58e228f47101a91568b88089c167c22b25326f081a29ba119775754c4c8600eddcc84586e63deee3b1afda9b0de3a71df3d07121856cc3ce9a152d216ef336a1426093fafdad81134fc1c5f18b400b8ca9020e8db7154411d18ec7a7fbf41f8a19b2ddd9193afe0620003e9391c16c626e1b6962bafa89838afa017be05664762e17a7efc8346b03add6581b8aebba2a6f2616c1cbe93c552ae15fb24c0d44de7a554c840a874bd2c6372c313627521b016bb9cb37c70e0def3f4a5296995b851c4ca5987a65fd47337689f150ccea1e1bf2e88e164b21db272db493f85ca4dfadedab6d1cc1a38b7098d56860ccb7149a742300942f8aacab752a42916f4831ca1337dee4ec8a5fa2ca783850f0f72c9148af3b3e9fe64f3f6d0d28c4e68cc877c2da37e3f385c00e810e2b579ebf1901dfc83ecbd8f6430b6ebd0026a5830676862979d8cda6acae4637b9f7588e18d129c49559fc22f01621fd7091d9b56c07a0e3bb5154bbb72f13293f93162ef8d3e2818c1f401fdf0a2fd9bd66aa4e74b2217d03ba98302091a53a142623b2b44e8757bc4763c0c7755f6c099e60685baf74518d731d361af905b31e3a2191d6582837e6ea1eb6a08996ed8cb24908c90dbff4f3f8082ce4e05857775a830724d4b7b808d975708b78cdfd49125879367c26e74e79ce47b018dae7ae88d25bbcb9b60adaf87b020bb8a9f185ced89eb0944c67f47660ad86afaffcb059d190e775d6c815f92d347598d2b1def41bb74a6ca7b9246e52a392a26b158134f84a5689bc0fe0fae95fc8b8dabc2fdefe9e4063c0fadf770ee1437c8b05c24eab670fff33a2329ea39a7cd737c7e2306bdf00f7fc9d46720efc4fafd6cbabfa65fa3495dcc056423f1c628c8263c00fb604e03f613ec43bc9cc097dcb547deefb85081c629000c441dcc22c69dd8aeb33f899ca7c335fa88582aff6cc6d668bc08a2e78ed242ea295f58fe2d995cb8ced3b5f026bee9a54a1895295788266fe32a00121d6b746cbc08cdb7e41c6192eb94f319c672982acfb994d0d6399914f2fdd8a8ffb8982dad6a49fdac1265b5840b8f39f4ede8038c6b2898947863452d70ccdeaa5819a957cc8a67d945fe3781a9d9a21c6730c07d0d2dff6f0aaea8e5065bf379af0cb0b280dbcb59ef369030bb297cf3e6feec0f6c92db7bd077fb274a62bd74bdacf2cc8b8f5373fd9b1febd497ab3b96c7ad466f56b57ece3e2f2dafa1aa29cf8643386bd9e86cea7b1bc453b571c9be722dbea970fb168b14d077b45457d8fcf8523f828eb70917dc67b97d5c77759f8ea512567d68d80f9273d50b1bdd3a6847d9bacef2fc4d86386d60cce542e48058377ce40a03a9316acce779b7b0e4511d9a9b75fb76a3398338b369ff5dddbaed6d0685b2f12023970bbfc013afaa353bc3db91208567ad884838d8a38c09cbfec5709f208ec60ea7e55249bf214cb1448125c752e5a557799b4dea5791fc6b3cd5d3456e607ef7c1140b2584168b343d498213c6db00746dec71126793b9ce701607baa04e7122006b77fb2780f31239e594208112fbbf91bf90e1217481f4c09931460701466307ecb2b56b88eca056f9282bacf494986101af6488b90d6b39844a384f7e0a4cdd8e40cdb4942e8c28edfba28dd11dafe275e039346ec533f44ccf5d7c5a8ed8ba963bc1ccff82ddff8b73d3dcdf2482097d40c27060aeda4a10592501748909b7f0d351a8df3bd4189ebd7e58f933646218fa187fc264508d71df25b2ed342476a153ea2123bec7cde6109f321a13a490bf34cb804d0f92500070a9e7d4aa1215b45711e578a9c3258a45b938adbcfadbe6c123173185b8bd9a6f3a4d9ed70f43246e833cf1c32984cb583b9aa089c1af6a2caa405fba0fb4d98b7a82777e6ab1d7823d756376afda3f4868cc8c24e134cc99e21fd8f2c3ee086c122dc468e55abd1381e993cb2212c6cf3bf3f2d75feea21573f852fad4111ae2fb114b8fd9ad8e40a5b461fcd3186fbb5db1b5241eb0bd25788dfb97b2325b09b282cefbfd8ffb7b620f927ecf3ebdb3e54e9cdb47fca7f82d0109d41fe1b72d729f6db72a7996b7e782b52da24e95fb7c5a4d4c11b8f543d323ef5f5ea50e364635dbfb03e1d550085dd4b0fb62dfa9b5eef5a256538583690183acf4869604e5699d203cf33be517ee1529545e19a52ede4794e86cc767e855c62e1ca526d29b55714de51192aa7a47804eb08bbe53658179532ffefe2be3e5fed5e36c0e886f47d7f96bba29b593e548e9ab400d9c4766070d442d2983cb2eff299f0d435d8e20629b2b9e6940aac5dc75abb79d7c7e709f67352f5347bed73ebcdb7800da79a3a9d6c922d1c8678ce00a6e1008d60585c1c3442e38e2729cf06a12b815e74f814b66a87727e9cf02483c0f71de56b0a003f5a81442e47926ac05c19702567e0605a5aacc2ac9977893d248faad0259dbf7ca0b9a69084ee99e6675fceee1c66f8b0dc000086a2cdc35a0c18d1f4c9980818f32a1a96e4f3502562922671d84c52efeb0557579f139fc8f4238f752912393d6e60a80e5967b1db072c12671018cf1098b50e57d494610b8e0d891c3a7813a271d6c358b342c4b73352be4b94d918334dee3bbda9a89d391cb98b66e2f09fd5d67437b3d3a876e4ce76a337474e73fd5b2536823e5a3e26a870fc93891e275296bdf9a70a62c3ae6f5f33f9def0299306316f8bdad0bd5311893cd4324751d7509ea36f800154fe8bf92af980b2536b19f14f6a67fd4d02655b69acf530432af0b2df3d949a076d673a9aed3c27ad15f87f080e3abbae85b532ad4583f09cf680e2bc84bfa3af3b4143662445b26cc29b818182c78651f1a49a8dc7f64163a29cd827c7b6adba9ce829999252a15ecdb8e3ccacbfb6d645a0f6e09d61eee212e58e8817564d38244e58d3153a64f462b2d9a9fa7b81a548d3643b4ab755d96f208e976bd7610df113c0a5123694120db99ea6241e70f295c35847e95819f8b8f24a4655427b47ae2e0f0914a3d0cef1820bc39b5b24a74e5473c2b268a5784b94509104f70dcaf3d0a61c65bd64dc19e57c4a2259bc91dccabf7bc94f183990fd192c1677889d35725affbf2caec388566df1bdad9d57c9e964d3a6a9fd67746cfd40238dd84b4b1ca2b3c52b8a3eb59c38349eac31c5c5b271c6a8f8b9e54038bcf7175fd0ea76cd5041c1e1bada196e35f4db4a6124c53f89d4d3a6a3cf2bd78a72c1ccc0134260eebb84f31b1a11a370e1fff26edf6cd1fcbdf05e3ea4bd38a3792c3cd988961fcf451360348c0ccb66d89c7e34daa9bff27001b48e0264d9fe67ce29de2db61bb8b119afa74ba5b984561f6901121e81af35ca867c115082f835dedb4e2d88477e832565ee5eb8ce8325228f67c3326bdfe2bddc07f17f3e7b845e5fb500f257aa84abc88c1e2b1c03e9b34fedb76a1e8f29e970f782be04ee8c3add8b94796b7ae148078ad6bc616e0875dd9a1cb185d61f24926be62131878e4f715df912860a3195ff1e590fa2f16bbe79b65af90def1f2bf4d36b6be9d43f7028a37a876fbf03e92881acc0ec7b321687c7b33c0462c02660988ec52f349ed076a3a0d4129e4fd8c01ebb9ab146a440bb1ac80ba40de89561d0215092d72d6b3b6ebe2bbeaca89b585ebc6ad24484a7664f8cadff78d060111e742bf146c88e3a8bc60175f30a94d309489155e38fb020f2ba113b3d4d72dd798d79d3b89eec65371db9bd25ee248c4949dbe98dc42ea31c40c071ef7c0e0c93366a0cebd760a5bd60a936059a54f7b01eb363fe338958b725a448d6fd701bbfa044d43c37d7403222e8e8dd9c0ac0ae40a0ef223df508690522953eeb2397e4e7d385d34492b59db7f09cac090b250bcff63232f21eee588cb39f47</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">需要密码辅助查验</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> debug tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> gdb </tag>
            
            <tag> debug </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C++ usable example</title>
      <link href="/2022/03/15/C-usable-example/"/>
      <url>/2022/03/15/C-usable-example/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="e1af6f5d78d1f0fb29ba621fe61a68c01435c9da3620c97b6c248fafa0b1f493">d8d42b59f128a57d0f6a623c69489aeedc58485823473be982eedb9fdbd18630fbe49a19e34dd71ea5e86aa98e2bb8fc2a954fe62564ab725a573d99789d3d9cc8f795638d2edec66349bab0625328ebad4cae65b989a2db18f907a27bc6c325c825e9945fab253fb6dd3e9bf9b68783ae9145a31f97bab1ce0d4341e35c3b0672a940eb09a7ddd4f2ab3f45375ad20a171903028db382909e7fe935ae59d28171a78b2860df095be88f5d4d1889b56624f62f58c1705e98cf6a38d32890222c230a09b7889bafebe12b93606f8cf0003e3d94d265e4fae46710008ca0b92b79ed7c159aece7e688d0d78aec0a69a9315261e3c13906e9d81d956192e69a8f7f791cd330421d2004d612a38e0981aefc1ccea421fe253ff95035e96d35db4736504fe7113a3903a57bc52755afb0a6289c9709497729c505f022eeda5081f43e363b758f9833461d8717d8816baf7e4b460be3c2aecdfa4e961350fbaed6028d2e897bb0bf769248533e5b25c87194e0b65540d11724208842edb8ba9b8f6b24bdd8ab1c1493821cd7f7c8d9a27cbc68de5312e89e91da48e89406423be52636b21440119ade30c27f50aff48a322d3d55ea0c206b5ff500885faeeeafaecef82961f6586847a5863b29e23cd478734e623f4ea21fd5994afb797dcc06193d08b3af10fcdb16823443a9c606a4bfda5a26ab378c4103854e86f241222d45d8d58a73936fa7ad0d9fda48c6afc97c4673dae8d3d90dd465fd4c57a98f0fca2f59fc34f999569fba9769f01ef97eae8ee48222895a84926763ec56926f06a6554061bd8e71df971d71076f5318b1900a57ad40193037d97bfd7e877f33b7423858a52b5eccd792a560c9b88686af4f197e8a80923edc2ffcdd206a9ca121ec43ff988a671b7280f7cd4395f3a5514aa31aa2c7f0b991603c9f7f9f123af17ea9942b585c4caebbe872cbfa4509988e21891e7dfe6f298fc44e8ce210cd194b9afb5a0816fc6f59951ae4abbb17e72d675a148ab94358c0e6edfc7848d0bf3abf194ef03ad957b2c6e411d874772e5aaba5ea34f844c5fdd37dfcefae071179200e673c7f3547d76abf7981328847db7b3af788e4d0cde81e5ec6fc4cdf4076c5f084abbffff37cfc7eb8b8b7f5b3354513a07b14d3fc3fecc7826cec815a0a5262b183a59464eb5b70feb0b8d01daf1bbf90be1fd4bc01f1b25184292a2949c75e5021b2ed3ab57c1bd1ba3c7bc13957a94bc7c5fea47c1635aa8b597d451b73c2edb6eee475cdb7a1f2f20f298bada2055fbb9f480fc1ab1de779f1295dced39662e61894a026c852020b93dc121457aa1a3d525a897f393c6f6395a391daa2feb56cc6f654065a5c2461f5324a5c881ac4b435ab8cd6e40a87909be01cdfe26cf08fc92f29fef273569e5757421ca869980a7533e8fe01f7f1db6a94c48b9d6a0451f39f647fea3edf234958e526b1f2689940fd91361f53ba688c640cc6a00862587c185a410adbdf55b61c37353d12e873ae3ae765380e5ba71aaefeaa14d141b814387172c9ef91336c32a9f509edd51ab2bd3e3ac8c9118af2d75f7cf81f465fdbeb0ee0481f9b6beec4c2632e6cbe536f829b9757a3c13c0c6ca46bf7ae38023e23d037e6748ff1600481a5b36c7c306569a3d5db5b0398ef53cad1ec4730919ac0f6ab44737c103d292aefe63dd72d1e7f63a2e6f560b93b3f3b1bcccae05dc0822ef04e2c2168ec8f63818d8c9e0c9d46e7bda328f2e0968391352da20797c61ae53b925ff643dbeabfe12151ce36d16867a830c4b49c246b2b39b62284b00093b77bca55e7bbd0ce687efdbc022afcd07db07cf613723aae25533253412f2bcc423f2f1cc0cfadd42048c439ba28a8a347189ad764ececaa96b1f1d8b3c0fd7eb72edaed24d845b7849f853ac8006a97c1510cced15792dfa6486572f03f45a2f0ca0d5e535fe780929b6bfd3c337f39459a321c7da2d6e51cbe432b4b5183cc6a69a834d0e8080836d12e30100af5d60870946e5182df1c8626a250b2c2ad0b4e270508d6699cb2194e07b73d55cfefc09cbd99e6411e9817056fb6b72c98e1a09bfeae24fc23076d9b4de34fe06170171e0155042a1d5cb24e144db3bd7b3cbb182e63cb4f96d55bc0c6e5f283941d5abf7833c6aeb5760f07c910224c5c9d1cad2a57e38a815622d33ea89b1bee698d881004a904988b7f7421f81a5f5e4f755536e19006bcd802de48bbc59037007392a971e6a14d9c3a837e06b3e02dfaf8182601025d9f73cb6ebbb512a675fdfa33f321bef18b7805fc8a040d0f498104eac5016098164dec8e29d8f1e97a865d4bde2a19dfca369fab063fa0b4e07fdf226525bc69c4087eda5673a321e0a421f9587e1ae8614d05e70aeb991cef2cf378bcdeed23da9e1aa437f60b3944726670daa00b1fe170b7e83841106310b39409fa58c1931d32e9d9d60668baf72e67cf8aa7a7be681f7f2b9b0f2f65fc56baccb5ae909502a769b8781c424f99361b53e5652baf29c1b8d470d9e2543145911deaabe38081153821712a3ee1af0402370fd7db4e112ff420679ae3a6cdcd0ce323a36e22af470e4831bb0d52c3d52aaddb0ade338d1ce26a4bb1e05e418358da94e7ece09a11a46a020921219a56ef4b22a881fef0ef27f851aa3dfd2ce2da5a8a30e61ced4e8c88525c16e2ede46516c546b58bb165477c4306d6fb29a47c55885c6da76bf3b1c8b53fd4e855689e10a15bd0bb1f54433f30d0e0d38892fb960ba5766d9768713b6d73f84003676acaa8d7f63505a5bc5e93fd9627822aa40e40761ebaa985d81beea0328bc9b42d012168a1b84d9eb645814191459c43f94e807550fec4d9a5b51b0cd10d8cf6acf089bfaefac2a49ea739330060f6b28368f26b607398698f95fb4c1e3f2a03f4017ae7a9b26d6f9841ec387fe3f1a94b386f1d9645e06759afb05804a0a3b676cc2627bde26962201ed978d6c212c9ae59dd0b6ceaf4d2bcd91313ecbc48b1731ea5d5fc62515600d61ebdb64804dbf11d55d8bbf89ace05a091bb4ff081c63da9eddaa0e535b66513c08a1e8e080629eb350112cef6594a2d317e2c35dcefca77d0f05909329a759d9be15d4b4b6f1c919f490dd39168b73fe8684188d64a96bfed83f5b6ccb07c75d3502d3ac1d2e924e9779f89e115cf938ee67e8c3449d18b9e0ad3d28539c45a30e353b2a89451ac37ac1e2f175c8cc5c3db48564d371b4d4b24dee3bdf7e7ced770679f8fa873afbd0c46fdd100b0ff620a10295403df0d49f01e464e92e8260f579087d32130838da3f173afff051647dbff81e238155f95fa66e56baf403a5cdb1456de8cc6eaf6f438933cd2c23070232c7fae0942c1f9c901c97307d8dc5389caed23f37366f23fa2c48ce460b480c3bc1186585de627483770b76f35543506f3a609045ddc8edc6d8621dffedd1beefd7e98667152d1f8adf22d726f22dafcc45062cd641f1f3852d898a9125644b0369c6940003cf9517b02691de1b78a08a8f5457587cab4bdd2f1482d513ed74cd5b2cb0711b2c20b5fad1ca68ff47c3f992dde9b44415cb323ba16cf90c6b236637124a8647d77be52fe47e206ffd288bb143ae89aa1517ee230b7d0197e8940f08e60db7e7d0434bc1a4ee0bd69672cca937d61368756b922614b9b48e239edcbcd47a62eb7955acbac031db1c57d21aeb8e08e49c581f12298c63dc1403423f6c8d35b7df4e23cb9d981ac8afd59354db9d4bac5ede090ae56bde3a4b10abd3c3d476497d1c0e81f4adbd6a6402fafa3c593e4846e128680181abc2e763e2c4d547ed8d156ab321674ed91299a2e94c288aa84f898a6ff10aa96e758f4b955a57aa59c43c0a8238e824c14f125af5fc246980e4a741c0f7d0298930aa21fefe8e181156ccfd8ef238f2d7ff63f8c112791754bb1ea733e0ba8d019e1ad40eb3270dddaf38edbe24da793a7dbed9d6550e400f7254ecd4fd562a8fc85059c79cac1b54ef056ffc2657d3a7c5046bb9251d86be95b8025fd9f0c5c41518c18d540abf3b01fa724a89a4c5f42c05a2f3d6957d39bfb56b0ccec3080b382cc20e66a9131c7a8a1c3678e3d69f25ddb9f2d249daeaa6902ce38e3a90c964186445031f7ff2835586761cd9be42b82f395ce55c1953813f956b398476eefeef2a963152c24dcab9f0687d97c02d547cc897cf4f5c6f84c1e31f2a7adf9c6aab0c595e82aeb3efee658409a1bee6195b1280fbcd96c335645eaa64ca613c079f8ec85aa77af278d057bbe4e678148cb88b1190c62517d79341f6639fe2c3bfb2c602b59aad2dd2651131d1b63e734dd06ce6a91840d439495b1c8777bd805479db790657e26f027da03b40983f130a07107544bb3984c3ae9f89c5d0bed053f220d062a4ac2a4db78f902bfd0c40aaeaeef00abcad8ee0bb4653c2879e7cbe3f529e272dae156e0f081a59a8f589bcacd89d040f7eca2773dc64268140ecfe91222ff9039908cd459db644b818c1a9e692d03ff4939e4a84eb343706a90c49803335723308b6f95abe9097913adc3c5ae19965778b76738b0e7ac8881b22281a8c084b53ba0dfbc9c6e25de7a72798899ec8286e3c777da3368d6348ea48cb47ba2f1a16b2bfe5969421713a4c0fe07082ae40f6d2ba5fb198355e45bd5f48184c314eb8bb6f32e54f77f47d1ee704b056f544f70bb8760960359182a2d09f98f77d1a7d51a118d5eb5ebeb033f02d3bdb8eb9d1668f0b54b8fbaca1b87a3cd3dae633350de6108e5c4527e5c248ce9ba5bc038f5602796a0d97707c02c32856da47d74597583e705a9aba3a6f6a48d107b74c11ea231ff6c0fb7acbf09645dc1d22eef01dc89657af80bf78e10617cc38a4cca81a461fd3fb8746d9c61b004ca2e4782427b10f1730172e2f08371795336fbb04760d5eae19fe04d7c6b770a3182838c8d8940b1ba7d973ab63810e02d0e78fcf64e9362bbf7a582817af780769afd8b254795d591b67b80ff02296f8cd6373ea7f58f0770f39911232f3da881c68ad778e25763ec067c27200ddd2c2824e458cbf140595c18c48cd47b0f63c433bb8b3a22c88a13a9f208f862e3a81cb7ab5937df7f74d265874991c8c6b29ce6ae8e27f8156fcd9b20c17607c2c0b626c3e723ec914ec1574ecdcabecfc5dc878da0be6b9017f0074a3e93ca823859ad7fc277dd2d6a1ddd9c1aa83122d4eb92e014253ba4f4719c750df672a4fdb2e3ea1e5b8b30323461601c8dd437b72e63a771c9519fa9794e1bc6a14245d2fac594050f84f2dc40ef96bc2447bb42d233edc344f5f36706747e505b79c76b5ed70696842117549ac0024ecc4e85b6c3d368357a1a3ef940cf5e5660bb9852e30f58b43822eda4f3f5f126966397085f42ef6afe263ceb9ce05d1d5ca96caae8b03ac197c2277d0ccc33d0e1fd2f31c7982762c71216bc615387c391c438c4f0c4118cccbccb6c582073ee9b8805bcf8d18bd5ed88ca84a0e40543d11b93b55a0378400f87a67e29262d4772dcf0c1f7e334dfe3d71fedd8495d8e279c7277137c3bfdbd9293a28b0a072b8a8f9a4a639856054ebe1e1a8ae6432cddd701fe40f4c18f9627324c020f554a97f0a35a69b742275f06a32119a787188af19b8e21cc7e0ed447cbce14033754bd1105dc85eb667c0af692684db8d1a8ed8462914677d17017d7fed03b7f8ddd7c18b82cfa021e55fa7d7cb8e2b958e866f3712e932b67e849160269eb7458397699dd0464d28e9d1a32f960ae53b833846f336e4b9a8269c992890d0f2feea20b64e7b12d64ac072101005fadef537ffc0bd2a6790cb33dc056b5f1a3c769ea728ebdbcbf7e2b9e95e7ef73e5f55df1aeab4e23bf97f8407a039a601ba7e27e9d373381fa18c268ee26a8e8946bf6fd294515131033601d77901155a36ee2389eb093b88eddcf4f5fb92593adc9bf6251f952ed1ff2a4f686153d4a45a5480e8539594c5f5604577c3a67a1b78ec6565a7cb508f843d204b4075edafb3e26101abe5caca96c9ce5efb650076b7139ab4ce4e63fa3b45cb9338ecaf5604efe56f5880456629d8de6f190ce6285b5e9e74baecd0f3229513ed08733cbb0a94b268012cad4f204167b9d2fccfc4bb7cbcf3ffb1e2ba348fa38edc7ab223ca91240d23748a112a8f9ae6ce52f0c61995109181b3e95245facc30d36ef3213b9626913baea091d67f41b05eb90a465c8c70ca330034d64a399fe40d01972d1bdedd89fd1a4a1bef5ca9ae07cb3b2647404a01404ef06e33ad08e8e5a3215f3d42ddd931f2d8dc3c57b38a5dd10e3d6212e565e5b6316d9c95d2c82d11ffaf3442dc26e4c65b930824772c3b7bfb5143226ecd0743c25d8b23c9ce38b788b2f7827155c93a11162327657dc1199d54e7aebddedea79ba533b2e128b5a793383ad6d504865e51d371764ecb6f835381e4b670336b0b0adedddf19356942f563fc4234a83c0acfae0124946d59a6b88329b9d277a20e90b96093a38d3f50c7b6d3af5d33d0612046f212bb077f8c507b30fd37c7ee0c7286541dad9867efacf041f6ea8dca519561ad5defde12a50b0c4411e41cad0eb4b3f6c158e6fffbd0ec5850f2e39516378a8f071b0d7aeb895afbb15a803c76cf6eec4e0b028de39e6ba9b9d9d218c8a8cc51e20cbdd50669a64e95f17304dbdd650c345070b9d5b19677a1e45084c5f4f767e2926df8f20d3c2f44f8424dc810aa11620324b7c9aacf435be359fd3953aa3eadcc41e847506b3ce36ae53dd6726cde0d0476a04a5b3aff6db4b15a7da90cb3c0b4fc4edd6d6eb65ef98dfcd922c9da0ed83f82b81fbe67e12f9f9ef916c5414bf954763422f943a94d095d47dd0948bd0138a27fcfb0429a8f782ea97f4dcbdb2ae1871f6845941a1143df90516cb4a257044d08593c0bf49a9efa18dc066406c16274ef9e2f30e22c1ac91c2b980ae58b4f4b34497128e8b3fe2b18cb981bf3ea218d47f202827607d0668c6373582013f1b2f67ccead003bfd618b33dec6ba1ea9ad78ab94ed660f5c9b3a3faf279b361ec9a74cf0c3067c898eec37be2be2ae58c588846462e168ff6266698f4460a69fda419b1a9d3b6cf07786110a97132d54d5ba25a915ae08f728d58ddf61a29accf57df922352a4914024b954f57cf5c9a82b46ea1611a8c1b92c04b8c2c68a66a454dc4308920f4f67d88dd92aa269dd51efcb6ec16bc646665728d8d43381bb5afee599144e3e4f86b69a37c3bb7f22de1ccb8d90e3d38db5cc21cd80a6872a2995f8af06cac199e6864ad0dedd7a74dcd3f79fe94e501396c15f3c8b6e4d036e049b45af4b369fa9c94d570086f353e0c362815f35b40013948d297cc3e418dbadeb0bf4ab96a968f452421be66e1254bc714b074d1ea7ae32c61de5c5fbb474424155c6fa24f746187adc526d60b4123bb5f4a5a9dabaab62d3118648c362093691cc571a57a88fa2e1cc9b62ffcfebcf1073008bda9c481418d98a43e9e66a40faa6bfcecbeabf93f676cdb6987eddf84ea2f032282ce8db229aee5ac591f5846c84eccf501b1992844ebe9c006a5ac514ac0d99b9afd93e5d2ab6cd24b02c8be11c23e7a6642e2c2b4414c52ea240674c77a9f9dd9da83f23ffad6b82b2357e686849aab0fb183aef745642f2cb0dd14bbc0f7d84520808836c8640e74e7804cd43ef29b75cadf6f5b2848c19bbf4ea9e371ad85b6c319886f6673acfcbafcbc77ba2ac8193068c7b71ef5257043e3e47dd1082ede81f74ece3aa45de8b16fb555dcfb05431811e646bb0211ea0bd50e1de5af747a31ab1879fe9fcc7ddf49d7854fcfd9afa76a8bb65681af35b1e36feaf6df72bf85c12396197ea7689250adee6385de689f46806c8599ccb8475413bd4be6f018e2ff9dd3c49bfbb8544a328be4c871cb288d8c8207b8fd6671bded6344cc28d5d3f88836622413672339ac1ee2ecb3ca584912a496d095d8b9ba4d89d0c3ad47beaaa3d4c40539d57e31c102bba8e330ebdb716e6ab9427313dd4802f9f94c40471f77eb0ea66a09c479768a10f2b389a193a54736b16c261c5ecccb0654c2d80329b9e8e9fea7ea018243b791f0557e154a80630fd87f62fda3b66c6877811240e79cf95db0d5d5bae1fed255168930287d8a13f8aab0d4f0b0025afb933fa99b94f2fb437cbdf1ef99d1f1af6484b551123aeec9bd1671aea4d534d3bd81145edb9dd01c2e60be02020c081ba012c0275de8129d43d857de6f92a62aeaf399e8b0192b648e950b9395fa0628d9b576dab403c5a324513a49f511da76355ca5f7ec97bc8c90f0df300ae16b56bd5acc555bf12a126640c86de27c356accec8b7cf87ab81cdae3111e142494bf05b70ee9b67bb36bf526eed5cefe753e40cdbf1c7690ca69d14e868f033ab9183bb736fc6391d0d5d8c5c8579663d5235da26f22ccb466b329f12e7b7d6f337495dee6b628d87743806a26d41b7e8d08ec0373e63bbd23cdb1180b46e1f8c85392bff9949e97e73450068bc4f94d32be767a79b08b54728986f2bb0d9494b614f597c2aff250c7939fdbf95a172d3ee50e1782b7fd48df90643e552b036365cc04930c800864fbd9117755eda1d96c5451cade159c68ab45e8a56763401361bbe72af28c037fe273d9c65b21d8aa2f45d27a8918eac4ca715582d3608eaca45320c8c0bb990e99b4db6012c3bbcb646c3a604c9579213d3b30f274c8566108a8a9cdc5e6ffb0669feb5f68fc1958767edfaac79ad89e45f32b4e3d87ed8287ae15ac9c33c72d7ad156ce9e32ecbfb73908f48ea9dc7fd9d42cb74d3b514561b2fb69ef7483d4c929a90781ae1c1ec39905d8bb182238669b7a3804d268f82aba65ec73173d666205d5ec0bb143499a6310b549bbab61910143d61e3ccbb34998454cd483e93cb3e15234eb690652f17395b594768c9a709dbbc937bec8442b644dc6f5c5678b6420c4eb81efafc669115ca1da3f2d11d2b2980c401080f4f476598e1910011c58e10b0d0963e762b10014a2cea0c9680cc0eea8bb87765a212e96f59ce7ec2b1c7acae8c9aa61e665d259e033b6636fd388b7a009dced5012343c7d15a114c69c45f54e883d64fa2d96f01c9fa4036c8435d0de4f87f21e37832f5d565c96a083db792db6bec009ed69610c340b6b20b949eba86cdd7319dfb3c6e1d0620789206521c08f9ffc6a41d7fa55d99294910ae112503a8abd86bba4c5d9a63da2bc9aafb6f4b5e63abed33849ee3e484313ad6d4c920a5439596a12c633e4e1dd7b786c849bc2f7b6a11ab1d8e9bd0cbdfbf0a9dd8efc491750cc5c4f21a220e863d70b7f407107a95e8ee8be4f37a8420e544fb16fdcfec9c3e6e74e9de8be8e6336fc8fce6501d084f2b75e79b3111971fed6e5a9de96fe656be000405673ce505c2e7fa895c3645b02248b47d7e343573e6d1d890c519d7acb36df8b222209a4c12a2271505b9313d164684e51a075bf1664eebf7aac0dd1cef53eab193aae4da71d7d08ea906ce5437d1b69ac341ba29441c69c904dbd21571b2613b104fca5d3fe49a216f4c25e8088efec2f27e620c49a773776688fa9b2df6c1b497e2f1f5d92f184bfaab2abcf5d2b6b5885fe93162aaf00717aa369efe4c31b71fe75b2ecf1e9959970c909992a90ff1086bc5c6b77319a3181c4a747323010e5bdc793815fe5d291f3c658a3bc1c1bf0a3a73bb36d9e4c3a5152108c804408bba4fb3de3ed018680787a40c8171dde92f32050fbf85dcd4581d7c52dc61feb6f92e5c82d10c11c723fa36896371005dee2d960b41d3e2eee65aecbd4f64e64c14f5dca57ed06ca20bd1025be84eec4c13cf8f31481131aa93e5b5cc0db229c0db10a91db7fe5e2895d4a94907ae5c8c19a38f0defe0ada15c9a97f215669e73efce4fdb734cadde68cf746e5d53ea7ff1e7dba7a0c5cb7fed346695b6561452582d2d3f6588f7c3f5434187b0b131d46bb23d9143f2b17e77ceb384d36a7b0c5c5600bbb36da615e079f1d23ee9208f030de635d8a265d1f33f0d60e40482e60a1ddcb74f5419efa1eb03732cbf34e61de0dac63096b54b4b6000d96c411f62f7518bcacdf63e7a4e42493b25305fc06142ffcb04703e5f26833601ba1fb2e37a63fd911d02c4a27ebc6b3b149cd09c84b1380d63bd9a8740ed1bbc5c96cee81307fc65bbf72484581c6572d7071a2e0f6e3acea94d92bacba51aa5770a420f4a354ab2c196662f4611d61afcb94f6b5bab329bf9e17b8e535b3a92d08cd19e8d453b1fdffd183447faeae028ac926b7689b85ed0cbe561f4071435e9dfad1d52e23faf4088bd0ced4b70710b10bbb7118ff637021cd8f615dd0f6468b5360ca844ec03c19d8269fb6bfae21c3848a27e216ec50922d94b62c00d6e4ec69a97dc5280d2c92138ac4459a95872b876decfcdff39f0d0c7f38bf957c62dc382ca2c490a5d6cf77b092937e9460d89ca0877646a443cbdee8d4c9644b2980a45880fe92435da79a2bf0d912a5ea1363fb812ae9e2cd2fbc7e2d357377e77cbf885bc0184ad6376d69a0dbba469454efa285ef4a636f7f2d9e5a601cdde27eddd9c6494ee77b89b03e09f96fd16259020f72e2dad653407e1bff217f1a020a2598de7489cc450d35a3315ff9747f51a31e3beb76da0cfce0d529fb552d9534c6e17270b1d2e507fb88364337ff51cb179514688d67ca88c3dbd6570fdd826cb3a63be691ce22ba7e6a0fafd750a69397c83850e5c12f938881699562a508e8b446fb853eb6537913c72b6bf818d1cd0c5daf692184eb1d7ad609dbd591df04c3a404ec4d6454d04ce51fb34f262e9a9192ac72fd6c703317ad388e587ab63511a42b533d435f56811e108c97b5d921748886f6aeaee4d52379c5ca2c97874b3cd4f355099f0d8a2893962af432c3afbf3ae7e2fcc3383537c2cd063a4538a63c48ebe5076c3a8c19267ba0639134b34782b33273ec3009dc37725d6db91960d3a30eeba264f8da63e53e431ad4b9eb142dd7c8353828e0bbd77d2f67e5d64ccb02bb18f005cf116ca7f4b6336030f0eaf6ca77d7f70bf7a5d9a7f936adc3c3d49ba153e9acb787c089db3171acf1d79d442bb281d624230f8ac00e5d64dc1afc487173eb6350a258104cf9735860f06f99d9f79f543ddbb90d8bd7059e049fa44bd989632ae40e065b8f169b73866a4728dd7e0e46c79d5c48947a17141671a56000ac0a98e718935b8352fc6e78f9f27c1b537d24242ddf6ef91bc69a8d1e45b839aba8795ebe07586d953e0ecdbb01aa49fc91edb7d823e60da7e5a26a5b063667f4a56f2ed86d9a9497ee89e6dd151c332cac32b5f12546982dd45826015a88540b8301b2d6eaa969055360ef7f40d51a4d90a148c3a6c767c1399c21612a8fac50557b461104c89acf601b22a7ab5bf7039a3f4de699ec5a3c1434d6be17a58df2bc962350df6da53017876f26a22bb5f45ce3b422b48e75d880821ea3dbbcbfb25add3a8177dfc6944312628bd37fa644739d9631f1e3a8c3b6d7cf78f7d34b5f7c67c786be4be2d043cf93129029c0d47b208bd78e2f2b1bff1b888716cac17b39bfb59cfdf966eb5760b4ddc1fd4ee6149d8ad2ef34953f8ccf7de590e1ddaaecf24bf53e9a0e780cbfa5afdcb461419274db231510db760abd3def001dde29f473df875dd89d84c5a575f8f113b1671142fd5135245149f28d2f742bd3a690adb7c5c59eba4e1025d4bc19b4c3bdea95ca1e348e133cbbb632e6c9586755625d1333cf5051f0c5209774e7f8f2ab631e05b0ed8977dd449ebe61a425909e5e068ad676bc6b2aa1f8b53c8e0cea76430bb2bf83bcb45a22a3e334863521413dc9c3b58143effce3bd9a31ded4517a183aa6da1b12970db791710b2c5eb67b54c90b5618c8d7192d1a24f950d23884dda6785e600557720c9f15b981f1ef3f93d7970d4cca969c481d8773e8af5ac52ce39c524f999d9c240a6c0d9d7ac7ca0d7cfa36862918fc2ec3594c8f66e3fbf4f9d5601160b8ae4583b291be6491ec99d0cfab9f93f1ef90d22bb4ab20228b1cf9cc238986b3db0f4e87ddb1a968a3cb50b9bcc2d9801f8504cc3e4b00c20e444254cada5e7eae466edc21493249e0bdee946054b129b14dc416973f2cd9d57cd39fa8245595d12e610b90d79f7f49b77eb2a75d0e9e6b8851454ea8e32aad727872d6a9ba6955e820561dafd739b6113c0be93b40b39e8158dd7b52ab2eb4eff824d22ded7e1a97686b89c2e5125077605af08b704d16b505ab903bd72223520482acc699b569f2d2b8ba609ca787a810175e30c5766262e2d0444e6c64964524bd4efee7b06a8cf4059f88f8b8e0684498ad93a190485065622730b7b4d320819125b2dc327d9f278ecbc81a3a046001d9af536377b139c4d32e5c249f3253b877f92e52b1793d2bbfa6ea073b125ff0b653ad03c96ee87e91fd55347c1b81d034243bc1ae5217bf550562d6ec812836211f9387c203ca2201bcacc64ef7f6200ad9510f4abdc078e830d4b96b6695b9622bafa791b479fd8af2cd96ed406ac3e3d4fee91c8e2d56dfd99dd1b44e915909b04a0afe89321539c56e5ad7cf7b41a9698b5feeefaea3428ae0e137a4922813c7333019f4cbd97a2a9ea7236130cfa0be388d920f60a8178354c2569d19b0cf27b95d499b1751b1d096400e733196375062613d961d8d0173400d0597c109634d77d7c64554e2a799b146b8aeab71ae5ed344ec2d71b8fdd2bbd2aeeb3940e2b206c80c70e7788878072914f0c923c5573428e00a09f3481920868d7ff5c920b57ae7023ef29e9623c201ccdd0007ef1042e58878c3d05fab16d397e8bde9797f4db913910c649187e509be0d66d51c48cdf998864ed239acb4299c2b0d26b073c33afa9c603e0f369e637bdf34ff5af7f411f13199b6a98a33b8ad75b6d343e5164ca3f5012944aca236ae5b05cbd146e10746418a485a27b5fbc954de11a4f332b3b20a36c3d3671bad60ed14a665ca7d711ba9e389d34676967c89250359818177039ecdcaa6ae1b2e3f0dcb4cdbe3554bf9485e4c85c063466901eaab87be0194e7432087871d3d118fdc70fdd5ebbc1d21eb212f61d10dcbc66298aa6dbfbd647e0a4ce849e6f981a4c791e233ecc2af0febc228ac71d059dd526f04b6514cf3f778a0af5280580e37730ced6119b089a7a2dfd020dc839c31a6d675791f86d064b92bdbf184c1da86f80712391ad8b6134e69c0474ba37774e74d81541a938963cf4753ee852060eace496d7528a0098552dd92d584449f76faae9d8da4502339d8fbfbca591eabcba4718b078d39461f203aca40fe25e52cda43b75d85222d1d71a7f57973935119ba42d45c5f8122dcb</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> Coding Language </category>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
            <tag> HandBook </tag>
            
            <tag> Coding Technique </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>reg 正则表达式 (Python)</title>
      <link href="/2022/03/11/reg-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
      <url>/2022/03/11/reg-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="71b4ad8c6aea3d17751be3e79935b3c7176d433ddb8d0299969953340719d737">d8d42b59f128a57d0f6a623c69489aeedc58485823473be982eedb9fdbd18630d820d968d784f45c93e21a3459bdb9c7f48491a12cc88a1d03c089a35b3d3db24e38c416f416ebf71311332bc35cb868b5e569e7cf2189808636d46f4e58646d99bd99e6b1ff92cca2805f5bd351d0b5f113a059d4e559d27283a2d62527756ca69470569dcfd0595acc1a2f2ac74090d347a3e2bef045f286e211a7654c30a826a8c2a040ea107ed46099084859d492dd4b569ec6db112e0094dbcbc25cdd8cfb3b2dc19bb6ecb707897f165b3fa2c5e82650bc7e61536d9d5ec6b590d9a6aad6de5e07652f1eb9c8c5e262251486d94b9f5b5fa99331d84104f305a261ed8168962432f34d6b1eb1c06753e90ac34d29f918aa3b8eadec6ac9458f88ba035da39870e1821afbc354d4d2e3c1988dc7a9dc43980d16cf31828bb1e92f51652d049122bfb9ff5f74014702db755c4d0442a7eb4fdf9942674bc99ddaaf9b7d21f96e6a1d9961888f0b00280131b60b84534583512d184f19d21c74b614ba0cb5b5622671fcb8974889bd7f2a955bc14f1850c5c4132cfda8b6680b93207aafbd6f6ef19870d846b814248b39d56a27fc82b84f4297a2a7cc62ab9e5589ec1327d0cc8ed31c43ffce0cc45284718823c87e6321f0d60bf80801a74a14fda9b67b7d1953213d2d928d58da53ba4b843d6f685d1ac4c52d4420e7cd562fa85416b45f4fea1c2c5f331677071da154527bb519370d2f05029e6ad1247cbd08d31945e2188f30e5f891dd08524d800a4d8bc3b4558b488297ef818d252a73c4aaf8accaf33c76a6c811178b36507fb1f0573a9bc24f9a7e5a5a265c26becd5a0abf99fee007a35a2e0d6b66f1dd3d6d4bc4fa3cf7d869624f6a05e87eb76dc8a6f3f60f28039d3815e1522aa5e52e727f5d42eaf8c28af37efc4cb074849c451e2587cbc95068519db5ae0cc6269e69f5c324cc803a8b86fe1b3ad986513ec4f3fdf860e26a30370638a41d9e4de45045a71578c31650a96459013aaa1e061a14e28fac59ef02b2efa027505ca8bf6d4d35d3f4292479fb75c80cb7e0b0214852f11b346ac23f8e3c8dd7e5667b736815658f8b542b58536705a4de6fd12467d4f9bfe0420f793091f0c695c0d1c2e032b7651f4c4692272039901ea6fd0e46971445132918faccb5780f213a159c887f73ccc77d0d29c44d53a9ef984c2c901639dded099f2c31d8a6fc2bc32eede19921ba3d334a00336e3959414b970ac967d1bffdcd617bc1fb8f9fe2c3aa8d7976e5c0f7c3247527a7da3ee138ee0c91ca5b526a20aed8a343c890f066948aa7918751b3596fe59c0b06126a883fba2b26e236b40bbf3b6eea65976a72f964d28423b07576649cc5678182d6b93e0267592babff6b165c680658cedc4fc412aca446881870137e0be6fc2cd27a7ddb172bacd7786ddbba015e36c60500623c85d7cb8e7f6e05e560614b73c898c2737cf251f611097f80e5fbf3f3b3f4b49e60cbe09be933657674493bf7b507fc9b95fcce1fae1942e68c117b00949185620057684e40ac9d74d87167e91c3bdb1bb6bda4906ebfa9824db957e2eeb98b245dff951d6a2131510115de682f0fda84c114dbdb37c2b4e7ea0747fa28edf8651c5aea7e278a6f46e0b2f0d36b98c863cda4323fb702f094ab679df7d926ea0d2f7374d47f1b69c7f795b6bb761190f2c1eac83d720f120accc52066cf0cce30bda205b7660d2f68274d60de38b990db190b6a869ab4e44bf4813c6d0d42099ee017bfcd50f368f98b48b9788a3fde5d6527b5147192add3970e391e61b1498f8e2331fb53673618e19383cf08041d4d58374711645b67bf1386b151c8f59db62a46600a7f997480a967015c69e615bc6d9ecc8fe721cb10fed551fdb670a479389b1f2bff62a800941456d4ce207b3de1a67c4e653f5a84a6d50b9436cb8f318770594fa4783f4ecd52f1d03b99e22428a80823b5d96a31e418aeea615704b38bbfd999a09fc943d8d02b11b328a193bb8104d1a5d31c4666c5055a9e26eb8e0394095a3e4fa59310d6a99e23f73561c537f1f4401098573e570dbd7ad90706d63e2e61c14cf60f69b1bb2a3e753937e64f985edda6f77baab39330c1ae0ed356cbeabbae45d8f46cb25cfd253dadd57ba985c40411068e3013e14cd64a60bcc5f79664f08470a18bb42fb219db3cc865521c2453cfbe130245f67c045491e2d84962703b36aee9ba1a48b8746b61fedd208421b4c486ee14a12a450d28be2406c267121edce80fa285405e5f062cbfda681f265930deed5d542a57aa7073ffe4a74a82fceed46d9221df67acbb9c2205b7ace8c8a92794e2c1c914a862501f611fabebaec3d3ff6d284ce5a98102d83a9d58a0e010da69330f48bb753215de0c878bdc1cf88d4066eb971b9a15151047548d35c6a315e8708407eb4221358e5defe4184979554caa44523e350546c6cb7b55cf54b1f7c53226963342bf489fd265c067471eb531542c56f37c28e1f906f56dd71361ee5834e52e32950e11b7a68397104c32984df4073f3527729be8de7297d4884f52cf0a3888dd56276d02b9a8ea6147022ee95f571e96c272afe07544d624bd8aaf91dd4b5f00bcc5df7a7f773bddd42d48409067caaf92bb25fe86dec51026a15fbe9b6fb1f31c72c2d0d33814f761d1fcce4e4b596778f6bd7498ff285fe2bd93f63d8167979bfe15329b0188209f7ba635894bc39eeabf0e721791482860811cecf2c892f9083c7f20ba64a7fa3cd6e9f0337d42d2e952db3ffa4d8662adeb363c425fced7dfb7d65dd7d8f8e25e2f395db55efcdab129791018d28dead33757b98c5dbad323e47e993c899423693a35c99ff0c62ac42b564d5ec5acf37af95008e1164eea18da0758fdc295a732cb01d2627f158c12767fa48d86e6da6999e31315599d7f3537a84a6def027654154fb08612de791f92c3425c8f8e16e296b002e0ffac0b5698c5023a1edd170bf6d2c2c14e3a673617d05ae827acfc475351371e301f54ed3a2e867696b98698bd5d11b633990429fb56d12023a8a4c6b97ccf0a68e6c096a7416ab1c67291d175e222c94ceb7c7d22f242bd2d26d1c0065a15cfff084c8fe23d9c18f1a17936a400807738f712be79a33eda379f2acba8b98187f33dd0d203e251c2eb9973113a7b15ede1e9284edb667a8de51fdca8d1ef0792eb3d02cdb02caff3ee44282397eade3c32500072aa7de119d3951bc2aa8e56aaa84fc9f0e43a27629f8c15e5a7ce70f32d8609f65285df2de0d6601628d6dfece16383033f1515b02df6cef7e25ea02b7d2fc1a8e0882d730db5e1da24c05e085f069bb2d6a4eca40e8852bf2f670180adeeecc05fa40bc1a65b591acec54d8f86adb5fdfe2f2ae0259e04005bab65c2f01510f007fd199429aca9d9c6646b5cf6628ba3570fd775b993c3e1b3324b752f3c6b5964ee3d6b93d123be530a0f8bb0273fb0537452e634c37499c2ad8b8adf76e170cd738d8810a5ad24affced58b6bac4ee5032fe443e9b8b1215f32abc1e26068105599fd4a111ae3a2dd69a6574438f8e1f08d1ab6dddba80ca5f2c129f498c7467c311d4d2e4b6e00bf6854c5c36f7b61e2bfbb6139a60defd4dd3dd763e0d78162023e1b5f97356ae849312c7840c8b8675c50f81392c439b6103b87bf6cbca7cc832673b5bcd5fb9da129992c497774bb02eea314e4f905e1b201cec081d7012e8e2ac9a4d88fb60be1e8ee5f9903e38c9e1a5d3483a8bd4fc59a8c486f4dddb1e5437374042d20faea26a00a1858c5e801ed25e3641e0082a5b75a9c6164a403af9482a7ecaae56eb394dda634c2b9dbb442644693548352ab8a2fb82e0221c2dd7ff66dca7e5c1f4a29ff91b74e0254a4a4cb682a015b337428559522b0e7db007a8a8e4c290ef9f7a3ad770f80a4711c34dc512ec72698a71d13e1688171405e61f7eaaba7a0cadef833f7ac36089d7d5ee3b80274ea771dd7ec2c8ff69815576bae300b9ea46a8368e1b9a53f826e69a9bdcb32d02d4a4d87d243e86d6459b0566400865995c9a3a73fb28b6653a0773b71a7838eb1aec6440f63ea756ab02de08b74bac465b5cb89cccee42c719b47a4b094b2b549b78dfb3ba4524f6baf6abccd0a3d2e33cc91c01ee9b9655501cd13764fe79ec1bb66ae60e451db0532a374b6ef745233a10f1ede0214edf643d67522378e8a49f80cdf9973e4c2a63380ce37762e4d4a72536c4aa87c518d7b6e588c4ef9a77a3a2cc8ccc71b958fdf7994823d8a107fc4c34a6d1a64ca74530e5a5b68686e733ae6badfca9d3a2065313b43fbb9aaf5821bbf7de1932275d5bfd2310acd1b6adbb43e0a7a03bab06c16f3a395089027e2ffa715a97d705270cc75fe0b27fe08adcb2af1c98ade91fed2afe3fa48870189ae98e86e9a505bfcec89ab2753f972fcd21be61d4753f52804b6da16b5a0f1f665bf541686a14a29e6e034d1a1b3a1829f1bd4839aa757de5e10cf14206079ca3296e7cd15de8192a631aa81fe4cc0c670054059f195b90facbdf5e9e5c424b16afeeb5f0719e0a1a72605b61de11d7f70de5ff858ee5b1f6bfd54adc818cadfae5f12df7640c9d878020faff7953fc00ec919597999de93fe5e6baca344a5a3f06a7f97d0a5ed3b93610a6dd1c1d775715d6ec4ca90245f3c469022afc7c5e6d02b27c81d6367ad4852a41bfe351265a50937f862130979b56208991b203a672ac07bb287d6f2511c3d17a05500fc4d236c60e14cd714a5434bf14a806d8f4fbcbdeaff8989aaf6187963115a6a67751e1254be0ff5f3e2a5579e4847b03dd1b88bd82be072b0bb44dd107d8f58037f6d722b7302cdb784546c7fc5dcd00b24286237854b8b448844953a13421485fa833dacf2f72142ce8a4eda48e6861ee3882ab7a3790237c7f6594e165d71d78866297a7fc6f5d25744e3cd1e288cbc13a43fe2c5a7f8b6423d628c9d09946e69738e0ff9433f72746f1e7e8a3171cd1fa017f3e6a7d0f07ec8f7a3df8faaa306da94ab5c21a999800f0909b4dbff6bfae472855357e12310c48011d01cd654c2206b7dca08470162f7c3d56acf3be25ce8113e8a5e587b8bb5d041edd92bfe903382ceebf5ddd37e02db0bbb71c1d5625b0773a63bb7a4b2dad8a5cfcf1ec8659ef1c199e0273796e818975b5948dda41d8c77c606d2941529ec0c6eabffc843d40a30a8f3cdbad3f5aa72dc056ad3b1959206638986b17d1fc05813fe24b66d9e45772a96bcc8541952d99b52ec7938eb6b5bd9edfa874c9f3ca4fd640a0dac6a6c42d5935055b03ff7a28e47b45cd8004908dd3f7cc9c0f27420604c043e202782544aafea77b44c68cf27cd78a1c00274673e429515d46e2b75cd7632202297c90050741a97fd1f7799b219230cd101dab422d7ec8cdc86dae0a831b1005f9cce2ce4c94da28d1a8b545d2fd3111c3b76c30eecf4f8d1c28c0d531397f0ce00b6e7ef21d1bf94317ba50875e8164465d326ac95ade5a48f0d69bc860faa0a3387d72c6b5468ccc1e7e714a52bc629d446b44368ba165455083406f10d4e41f6eb381f20fea6c1549a7a6ce201ca2e72c0c1a786c4406270342af2f666b944a548bd67fb90e43d8626f73e80cc21b37dff3ac54f0a53fe570006601f95b94c86e18f9b31c7eabd04c4299fa578998e3d88abedea25d5bc02a7686560bee935debd4c9eaccd333c06af48a702e34a9d17f524588fe6b2db990b2372a3b490e4a855a3470eaeca113af253d46870b634ae6cde5d325d6d8e143a54da71c1f5af9614974869670ba82b8225fcf2d4fee34ee230aac18ae99470e50a4cac8f9999a51cebc78ee6434d2309deda0d8dad7b48cfba687bcec8686e4e509cc02d8f3607b8f7b1d76befab7616299128f0af3e0ae848653073f89b5fd9f88694d8b8943e35d45e54a55f3264cedee6829ed28255195fe722fd899809e14c8349d739b0b195dbcbf3297627c60192eb6b7463e2abac887da64118528b89308bc67cd8cd3043cb893a861429a3e7aba333420b4a0acb3154c42280de93c5bf6d8b1d4079b602f7406ae961dd92ee1b8516bebe6290e171afdbbd0953bf57c72633228eb79b411c42de57f04017f0c2a4f725536b832544eea6664ef06dc4ac1224447446d642210811c7bebace8bf7ea7260e36503363d18cde2a58915718952c33a6fa66ea152db603a0a511e0f2e530557a336882905403d80662497ce37944f9e38bbd1bcfebeadcd2ea9153127d01a99db4fcc35bb224620141f2d571ed713113da182731a178a15b2523c97fb343b6ba2f7783dca4e78f25175430a7afb602ad0e492c600bed7251f07ef3f1b65179a110830e7b309cecddc0f346e010bbc092e79a2e9735259ffe4b34a246e48c3b8e24c33770d773dcf1325daa81d84dc97a8fd35895a9a214d00c5120e8c5a93dd66465c3e481e95940d33939a32f5fba170011df2e0ed2f0af20d747376c83b0d4636af580ba01adb034993c2d62617a0adec62df517a2e38eefff0a4389bda220ba0d1c7b784478b1121dd271b644e2d08e4e4074b9aec58289c69472533ce04a7070040e39182ded9b9669c7c8892739fa323b0cd6df452c4483e6c90411059a86842b37a3e963a2cb12585e8bde3b7a923688fd95a33b5c285235feb8028f324141c1cc8a5bebdb084cffdcdf0f0ef5df4f0d1096a6fdaf47b599cfd980a6cbe0fb98a39392aeb394001831104e27eb824bd33421657f357a1b1c8387544722f9627d96888cb1cdb0e50e46f6e0d42a6f0d6de35198626075f42f38963ae67fd28704d4f109508d1131579e94a76ca7415afe482403b15d24b1e6611567d3a7d7360291253fe96274342c09cc882984d98e42c490abcdd65531199b8f73ae802160c13fe150bc023648de2081a83ab73b9d26adb69b1af91c18465352a7994e71d5b9b15a3329c561d9ac587b04f34b45ed435b1687dfac9f8cb450626248e27cdd6f37d89333250ef7d09d2bebcd4a6286fe405899f87dd7acde948718872d6da769994a18baf10b04a829a6e071280e80a68a0972a5f89f17fec8a6f983e00214762ed33b9c4e1abefc6156408b04e881cb331d640bd5e35f22fbf6ce006d8785afc038621876ae8a2a6882f99ac66729da828423fd127717df4f5e45f3873b1c6fe4f00ae70bd3f78452a230e81548dce7c18293240b74f8c4dba938a9c045a598a5d38a73de4cf30aae801701ebf3775cdee0e5f77b4dd1e083acbd06d381184e2ddc6e3dbadbde6caa0b17587c3e61a33f7ed1e17d49206d5e0d747087f280bf1f93c79acd061482d56986eae19007d29e02b91cf082b56783f082c2a08e79e45fb3d8950979514a8cf297a05a574d8502efed2e5f95ab3104525ccc630d99bfdbbee0633ca306d7eaabb2b07ca5dca2b7af4c78706ad899b44feb2369c2cf8d1b904acba4243ee6a37e4453d1046b3a12eef4f051cd6815d7e4a18ec2e62e8407100e9ceab7052dc1cab0b6e0f01a67b044395811583f7532fd5c35a3cd5ebb797d0982d091a6cbb55a7af6dd6d4f12c3a115adbbedb663a8904ebebf4d2d8980ec309d5a25f412a9b6de7d83c21aff0e7a013732d82ee87ab1e9306bdc1baaea4f02a2e8940f90f9ef0a372d2a4a9661e5ea8bf95f9fa919df3e2c675a639e1fa9b0f3e94803a65c6c53178039638fc388dca576c9fcdacd9d82ed59c783530af2b3bde8936d1487296e7bb887169bfcee32b5e61f9477482d6a8e3bfde80e6129d54fa6346a468144be2fc23e511db034988b25500a8806929aa2f2bf31539b2e038cc7141a9e8c895df3d2124edd90bdfa7982736aff048a3e5f5c979918146df155faa5cd76b6f3fee29440abc13c79d579e300d30fb5dd6b5913d062159e0c9d8dd378c29ddb316bd8bf0d4df6aebae40eeaef91424c2e106e72c3210723971151fea2ce03bed081767efb97a91996b2fcb9b56aa29d9c69f71a803a09b0c8fa37bca5cbb4c999b74339fcbf90530fe4d439284431cdf6ca1647f31008ed5307101788a9d4b13f4260ed592f87574a9127b33dfa2758888c567803d1e58cb2cb5879da248cba3b73009b7c17ab0a839cc1c1e6531ab9faa005cc45ae0a0ac29e1c4dda63f7b92a3d191ec2785f43fe0308d6e62afd6b902cc9f2d0485407f9b64b436e28e1c07d8d572c1bd872a3efc1d030355b34c7eb55c76b51a6bd38e71f674f34a5c1881e188ccccd76f01bf6712d62a60868d4bc96e24fec2ba4514121e291e5db215fdaca7071f0f22ca102f8ad035d460d1f117fb5ad1b64bb135d3d2d5f0c98bc074095f9</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">需要密码辅助查验</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 正则表达式 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> Regular Expression </tag>
            
            <tag> 正则表达式 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>git 子模块</title>
      <link href="/2022/03/02/git-%E5%AD%90%E6%A8%A1%E5%9D%97/"/>
      <url>/2022/03/02/git-%E5%AD%90%E6%A8%A1%E5%9D%97/</url>
      
        <content type="html"><![CDATA[<h3 id="前言-6">前言</h3><p>我们经常碰到这样的情况，当我们在开发某一个项目时，我们需要引入另一个项目的某一部分，它可能是一个第三方库，或者是我们自己开发的一个可复用的项目。这时我们可能希望能区分开这两个项目，但是能在其中一个项目中引用另一个项目。</p><p>我们的一种可能解决方法，是将其中一个项目(比如 library)完整得 copy 到自己的项目树里。但是可能这会导致个性化这个 library 很困难，而且得确保每个客户端都能包含该库 。另外， 如果将代码复制到自己的项目中，那么你做的任何自定义修改都会使合并上游的改动变得困难。</p><p>为了解决这个麻烦， git 使用了 submodule，它允许你将一个 git 仓库作为另一个 git 目录的子目录。这样，我们就可以将另一个仓库 clone 到我们自己的项目中，并且保证整个 commits 是分离开的。</p><h3 id="添加子模块">添加子模块</h3><p>通过以下指令，我们可以添加子模块（比如 DbConnector）到某一个项目中, 默认情况会放到统计目录中。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git submodule add https://github.com/chaconinc/DbConnector ## 相对/绝对 url</span><br></pre></td></tr></table></figure><p>这时会生成两个文件，其中一个是 <code>DbConnector</code>，另一个是 <code>.gitmodules</code></p><h4 id="gitmodules-文件"><code>.gitmodules</code> 文件</h4><p>该文件是用于保存项目 URL 与已经拉取的本地目录之间的映射</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[submodule &quot;DbConnector&quot;]</span><br><span class="line">    path = DbConnector</span><br><span class="line">    url = https://github.com/chaconinc/DbConnector</span><br></pre></td></tr></table></figure><p>多个子模块则会有多条记录，该文件也想 <code>.gitignore</code> 文件一样通过版本进行控制。它会和项目的其他部分一同被拉取推送。</p><h4 id="子目录文件">子目录文件</h4><p>虽然 <code>DbConnector</code> 是工作目录中的一个子目录，但 Git 还是会将它视作一个子模块。当你不在那个目录中时，Git 并不会跟踪它的内容， 而是将它看作子模块仓库中的某个具体的提交。</p><p>当你提交时，会看到类似下面的信息：</p><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git commit -am <span class="string">&#x27;added DbConnector module&#x27;</span></span></span><br><span class="line">[master fb9093c] added DbConnector module</span><br><span class="line"> 2 files changed, 4 insertions(+)</span><br><span class="line"> create mode 100644 .gitmodules</span><br><span class="line"> create mode 160000 DbConnector</span><br></pre></td></tr></table></figure><p>注意 <code>DbConnector</code> 记录的 <code>160000</code> 模式。 这是 Git 中的一种特殊模式，它本质上意味着你是将一次提交记作一项目录记录的，而非将它记录成一个子目录或者一个文件。</p><p>最后，推送这些更改：</p><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git push origin master</span></span><br></pre></td></tr></table></figure><h3 id="clone-含有子模块的项目">clone 含有子模块的项目</h3><p>当我们 clone 某一个含有子模块的项目时，如下：</p><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/chaconinc/MainProject</span><br></pre></td></tr></table></figure><p>我们会发现子模块目录下是空的，这时候我们还没有 clone 相应的子模块，通过执行以下两个指令，我们通过<code>git submodule init</code> 用来初始化本地配置文件，并使用 <code>git submodule update</code> 则从该项目中抓取所有数据并检出父项目中列出的合适的提交。</p><p>另外，还可以通过以下指令，一步完成 clone 操作，甚至完成嵌套子模块的 clone</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone --recurse-submodules https://github.com/chaconinc/MainProject</span><br></pre></td></tr></table></figure><h3 id="clone-但忘记拉取子模块">clone 但忘记拉取子模块</h3><p>如果我们已经将项目 clone 到了本地，但是忘记拉取子模块，则我们可以执行如下指令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git submodule update --init</span><br></pre></td></tr></table></figure><p>它会执行 <code>git submodule init</code> 与 <code>git submodule update</code> 指令，去拉取并检出子模块。</p><p>另外，如果子模块里面还有嵌套，我们可以执行以下指令，完成嵌套式的拉取和检出流程：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git submodule update --init --recursive</span><br></pre></td></tr></table></figure><h3 id="拉取子模块远端最新代码">拉取子模块远端最新代码</h3><p>我们可能不会修改子模块代码，但是想要接受其子模块的最新修改，则我们可以进入子模块目录，执行 <code>git fetch</code> 和 <code>git merge</code> 指令，合并上游分支的新代码到本地。并使用 <code>git diff --submodule</code> 可以看到子模块修改的内容。如果我们这时提交更新，会让子模块锁定为别人修改后的新代码。即大家 <code>git submodule update --init</code> 初始化子模块代码会变成修改后的子模块代码。</p><p>除此以外，还有一个更方便的指令完成上述拉取并检出子模块新修改的方法。就是使用如下指令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git submodule update --remote &lt;submodule&gt;</span><br></pre></td></tr></table></figure><h3 id="拉取主模块代码">拉取主模块代码</h3><p>注意拉取主模块代码只执行 <code>git pull</code> 或者 <code>git pull --rebase</code> 是不够的，它只是检查到了子模块有修改，并递归得抓取修改，但是它并不会更新子模块，想要更新子模块，我们还需要执行 <code>git submodule update --init --recursive</code>。或者 <code>git pull</code> 加上参数 <code>--recurse-submodules</code> 实现自动化。</p><p>在父级项目中，可能出现这样的情况：当我们拉取的提交中， 可能 <code>.gitmodules</code> 文件中记录的子模块的 URL 发生了改变。这时候执行 <code>git submodule update</code> 或者<code>git pull --recurse-submodules</code> 可能会发生错误，我们需要将新的 URL 复制到本地中:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git submodule sync --recursive</span><br></pre></td></tr></table></figure><p>再使用新的 URL 更新子模块即可。</p><h3 id="Reference-15">Reference</h3><p><a href="https://git-scm.com/book/zh/v2/Git-%E5%B7%A5%E5%85%B7-%E5%AD%90%E6%A8%A1%E5%9D%97">Git - 子模块</a></p>]]></content>
      
      
      <categories>
          
          <category> cmd line tools </category>
          
          <category> git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> git </tag>
            
            <tag> Devops </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>git 多用户配置</title>
      <link href="/2022/03/02/git-%E5%A4%9A%E7%94%A8%E6%88%B7%E9%85%8D%E7%BD%AE/"/>
      <url>/2022/03/02/git-%E5%A4%9A%E7%94%A8%E6%88%B7%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<h2 id="前言-5">前言</h2><p>之前会经常碰到这样一个问题：在一台电脑上，我们可能会需要开发公司的代码，这需要公司 gitlab 的相关用户，而这台电脑同时又可以作为自己 github 上博客的本地仓库开发地。这时候我们就需要区别不同的 git 用户，并做到轻松切换。否则，我们会经常出现无读写权限的问题。这篇博客主要讨论的，便是如何轻松在一台机器上使用多个 git 用户的方法。</p><h3 id="移除-Git-全局配置">移除 Git 全局配置</h3><p>如果我们 git 配置了全局的 username 或者 email 等，当这个配置与目标 git 所需配置不符时，就可能出现无权限读写的问题。因此，为了后面能使用多个 git。我们需要首先移除全局的 git 配置。步骤如下</p><ol><li><p>打开任意 command line terminal，比如 iterm2</p></li><li><p>输入 <code>git config --list</code> ，我们可以看到我们的全局配置</p></li><li><p>对已有的全局配置，比如 name, email, 和 password 等全局配置，我们使用一下指令去除</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git config --global --unset user.name</span><br><span class="line">git config --global --unset user.email</span><br><span class="line">git config --global --unset user.password</span><br></pre></td></tr></table></figure></li></ol><h3 id="生成不同-Git-公钥">生成不同 Git 公钥</h3><p>假设我们有两个用户如下</p><table><thead><tr><th>Git平台</th><th>username 用户名</th><th>email邮箱</th><th>hostname 主机名</th></tr></thead><tbody><tr><td>公司私有Git</td><td>yourname</td><td><a href="mailto:yourname@git.company.com">yourname@git.company.com</a></td><td><a href="http://git.company.com">git.company.com</a></td></tr><tr><td>Github</td><td>nickname</td><td><a href="mailto:nickname@github.com">nickname@github.com</a></td><td><a href="http://github.com">github.com</a></td></tr></tbody></table><p>我们分别生成两个公钥，到不同的文件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C &quot;yourname@git.company.com&quot; -f  ~/.ssh/id_rsa_gitlab</span><br><span class="line">ssh-keygen -t rsa -C &quot;nickname@github.com&quot; -f  ~/.ssh/id_rsa_github</span><br></pre></td></tr></table></figure><h3 id="公钥添加-私钥登记">公钥添加 &amp;&amp; 私钥登记</h3><p>将不同的公钥（比如 <code>id_rsa_gitlab</code>，<code>id_rsa_github</code>）添加到各个平台，以便 ssh 时能够 Authentization。</p><p>同时，将私钥使用代理模式登记到本地</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 启用代理模式</span></span><br><span class="line">ssh-agent bash</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 将 Gitlab 私钥添加到本地</span></span><br><span class="line">ssh-add ~/.ssh/id_rsa_gitlab</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 将 Github 私钥添加到本地</span></span><br><span class="line">ssh-add ~/.ssh/id_rsa_github</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 验证用户</span></span><br><span class="line">ssh -T git@git.company.com</span><br><span class="line">ssh -T git@github.com</span><br></pre></td></tr></table></figure><p>最终，可以通过执行 <code>ssh-add -l</code> 验证登记</p><h3 id="配置-ssh-的-config-文件">配置 ssh 的 config 文件</h3><p>config 文件目录在 <code>~/.ssh</code> 创建 <code>config</code> 文件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 公司gitlab</span></span><br><span class="line">Host gitlab</span><br><span class="line">    HostName git.company.com</span><br><span class="line">    User yourname</span><br><span class="line">    IdentityFile ~/.ssh/id_rsa_gitlab</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> GitHub</span></span><br><span class="line">Host github</span><br><span class="line">    HostName github.com</span><br><span class="line">    User nickname</span><br><span class="line">    IdentityFile ~/.ssh/id_rsa_github</span><br></pre></td></tr></table></figure><p>该文件分为多个用户配置，每个用户配置包含以下几个配置项：</p><ul><li>Host：Git 平台的别名，clone仓库时，可以替代 HostName 来使用</li><li>HostName：Git 平台的域名（PS：IP 地址应该也可以）</li><li>User：邮箱或用户名</li><li>IdentityFile：私钥路径</li></ul><h3 id="仓库配置">仓库配置</h3><p>每次 clone 后，需要给每个仓库配置用户名与邮箱，这样仓库在提交代码是，程序可以知道提交的服务器是哪个，也就清楚使用哪一个密钥。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git clone git@github.com:personal-username/xxx.git</span><br><span class="line"><span class="meta">#</span><span class="bash"> 配置用户名</span></span><br><span class="line">git config user.name &quot;nickname&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> 配置邮箱</span></span><br><span class="line">git config user.email &quot;nickname@github.com&quot;</span><br></pre></td></tr></table></figure><p>如果 repo 还未 clone 到本地，可以修改 clone 命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone git@personal:xxx.git</span><br></pre></td></tr></table></figure><p>注意这个 personal 就是 <code>config</code> 文件的 Host 的名字</p><h3 id="Reference-14">Reference</h3><p><a href="https://hanpanpan200.github.io/2019/10/14/setup-multiple-git-accounts-by-ssh-config/">通过 ssh config 配置 Git 多账户 SSH 登录 | 成长自习室</a></p><p><a href="https://emmxxx.com/archives/18">Git 配置多用户</a></p><p><a href="https://www.1024sou.com/article/9523.html">一台电脑，两个及多个git账号配置</a></p>]]></content>
      
      
      <categories>
          
          <category> cmd line tools </category>
          
          <category> git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> git </tag>
            
            <tag> Devops </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Presto for Hive</title>
      <link href="/2022/02/28/Presto-for-Hive/"/>
      <url>/2022/02/28/Presto-for-Hive/</url>
      
        <content type="html"><![CDATA[<h2 id="什么是-Presto？">什么是 Presto？</h2><p>Presto 是一种开源的分布式 SQL 查询引擎，它能面向大范围 size 的数据 (从 GB 到 PB)进行交互式的数据分析。它能从不同数据源中取数据，包括 Hive, Cassandra，关联性数据库等。它最大的特点就是使用内存分布式运行，处理数据反应比 hive 都快多个数量级。</p><h3 id="Presto-基本语句">Presto 基本语句</h3><h4 id="创建并写入表-I">创建并写入表 I</h4><p>基本的建表语句为</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> [ IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> ] table_name [ ( column_alias, ... ) ]</span><br><span class="line">[ COMMENT table_comment ]</span><br><span class="line">[ <span class="keyword">WITH</span> ( property_name <span class="operator">=</span> expression [, ...] ) ]</span><br><span class="line"><span class="keyword">AS</span> query</span><br><span class="line">[ <span class="keyword">WITH</span> [ <span class="keyword">NO</span> ] DATA ]</span><br></pre></td></tr></table></figure><p>可以看到其实整个表的创建和 hive 几乎一致，只是对于一些 <code>partition</code> 与 <code>format</code>等操作，Presto 将他们放到了 <code>property_name</code> 中，比如</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> orders (</span><br><span class="line">   order_date <span class="type">VARCHAR</span>,</span><br><span class="line">   order_region <span class="type">VARCHAR</span>,</span><br><span class="line">   order_id <span class="type">BIGINT</span>,</span><br><span class="line">   order_info <span class="type">VARCHAR</span></span><br><span class="line">) <span class="keyword">WITH</span> (partitioned_by <span class="operator">=</span> <span class="keyword">ARRAY</span>[<span class="string">&#x27;order_date&#x27;</span>, <span class="string">&#x27;order_region&#x27;</span>])</span><br></pre></td></tr></table></figure><p>需要注意的是每个 column 的类型和 hive 有一定的区别，presto 中的类型可以查询：</p><p><a href="https://prestodb.io/docs/current/language/types.html#string">Data Types — Presto 0.270 Documentation</a></p><p>且对于 table 中某个 column 的 type，我们可以用 <code>typeof(column_name)</code> 去获取。</p><p>如果我们希望查看整个 table 的列/分区/库结构，则可以输入</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> COLUMNS <span class="keyword">FROM</span> <span class="keyword">table</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">PARTITION</span> <span class="keyword">FROM</span> <span class="keyword">table</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">table</span></span><br></pre></td></tr></table></figure><h4 id="创建并写入表-II">创建并写入表 II</h4><p>对于已创建的表，我们可以使用 Insert Into 语句写入表中。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> table_name [ ( <span class="keyword">column</span> [, ... ] ) ] query</span><br></pre></td></tr></table></figure><p>我们可以看到，这个表除了可以全量插入数据，还可以对特殊的列进行插入操作。其他列会变成 NULL</p><p><strong>Notice:</strong> Presto 没有 Insert Overwrite 的操作，我们只能通过 Delete 然后 Insert Into 的方法写入已创建表</p><h4 id="删除表-I">删除表 I</h4><p>直接把表连同表结构进行删除</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span>  [ IF <span class="keyword">EXISTS</span> ] table_name</span><br></pre></td></tr></table></figure><h4 id="删除表-II">删除表 II</h4><p>对表的某个分区进行删除，或者删除整个表，但是保留表的列结构等信息。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> table_name [ <span class="keyword">WHERE</span> <span class="keyword">condition</span> ]</span><br></pre></td></tr></table></figure><h4 id="对表进行修改">对表进行修改</h4><h5 id="修改表名">修改表名</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> [ I <span class="keyword">EXISTS</span> ] name RENAME <span class="keyword">TO</span> new_name</span><br></pre></td></tr></table></figure><h5 id="增加表列">增加表列</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> [ IF <span class="keyword">EXISTS</span> ] name <span class="keyword">ADD</span> <span class="keyword">COLUMN</span> [ IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> ] column_name data_type [ COMMENT comment ] [ <span class="keyword">WITH</span> ( property_name <span class="operator">=</span> expression [, ...] ) ]</span><br></pre></td></tr></table></figure><h5 id="删除表列">删除表列</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> [ IF <span class="keyword">EXISTS</span> ] name <span class="keyword">DROP</span> <span class="keyword">COLUMN</span> column_name</span><br></pre></td></tr></table></figure><h5 id="修改表列名">修改表列名</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> [ IF <span class="keyword">EXISTS</span> ] name RENAME <span class="keyword">COLUMN</span> [ IF <span class="keyword">EXISTS</span> ] column_name <span class="keyword">TO</span> new_column_name</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Presto </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Presto </tag>
            
            <tag> Hive </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>git 多人开发 与 分支管理</title>
      <link href="/2022/02/27/git-%E5%A4%9A%E4%BA%BA%E5%BC%80%E5%8F%91-%E4%B8%8E-%E5%88%86%E6%94%AF%E7%AE%A1%E7%90%86/"/>
      <url>/2022/02/27/git-%E5%A4%9A%E4%BA%BA%E5%BC%80%E5%8F%91-%E4%B8%8E-%E5%88%86%E6%94%AF%E7%AE%A1%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h2 id="git-多人开发">git 多人开发</h2><p>在现实工作中，我们经常会碰到多人开发同一个模块或项目的情况，这中间需要注意许多问题，比如分支的理解，冲突的解决等，这片文章就主要讲讲在用 git 开发代码时可能碰到的问题与解决方法。</p><h3 id="Notice">Notice</h3><p>第一次开发的时候，有开发经验的老司机都会发出的警告：<strong>永远不要在本地 master 分支上开发</strong>，要保留一个干净的分支，以便后续切分支。后来在日常工作中，深刻得体会到了干净分支的重要性。</p><p>每个分支只 focus 在一个项目上，不要再同一个分支中搞多项目开发，这会给开发和维护带来很大的困难。</p><h3 id="抓取分支">抓取分支</h3><p>在确保本地已经安装 git 的前提下，要想在本地进行 git 项目的开发，首先我们需要让本地机器有这个项目的权限。则需要做两件事：</p><ol><li><p>确定自己有 git 账户对这个项目有开发权限，否则需要申请开发权限。如果没有开发权限，我们就无法自行得让本地连接到项目的远程分支仓库中</p></li><li><p>本地生成 ssh 秘钥，将公钥 Add 到项目 repo 的可识别 Key 中，这保证了本地机器能通过 ssh 对分支进行开发推送等。还需要注意本地 ssh 可能会有多个密钥，要确保 git 使用的是 post 到项目 repo 中的 key</p></li></ol><p>完成上述两步，应该就可以开始抓取远程分支进行开发了，使用的 cmd line 为</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone git@github.com:Jason24-Zeng/Jason24-Zeng.github.io.git $name</span><br></pre></td></tr></table></figure><p>这个指令的意思就是将远程分支拉取到本地，并写到当前路径下的 <code>$name</code> 目录，如果没有就创建。</p><h3 id="查看-Git-远程库信息">查看 Git 远程库信息</h3><p>进入 <code>$name</code> 的目录，可以通过输入 <code>git remote -v</code> 显示详细的远程库信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">origin    git@github.com:Jason24-Zeng/Jason24-Zeng.github.io.git (fetch)</span><br><span class="line">origin    git@github.com:Jason24-Zeng/Jason24-Zeng.github.io.git (push)</span><br></pre></td></tr></table></figure><p>origin 是远程仓库的默认名称，fetch 和 push 显示当前具有抓取与推送到 <code>origin</code> 的权限。</p><h3 id="推送分支">推送分支</h3><p>当我们本地进行提交后，我们可以将本地提交推送到远程库中。推送时的指令如下</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push origin master</span><br></pre></td></tr></table></figure><p>表示将当前本地提交的内容推送到 origin 这个远程仓库的 master 远程分支上。如果推送的结果与前面的结果有冲突，可以先 <code>git pull</code> 将当前的远程分支拉到本地，然后将冲突解决后，再 push 到远程分支上。如果远程分支只有一个人使用，且确认希望就将当前的内容完全 push 到远程分支上，则可以使用 <code>git push -f origin master</code>，它会清空 远程 <code>master</code> 分支的内容，然后把本地分支的内容全部推送给  master。</p><h3 id="不要在本地-master-分支上开发">不要在本地 master 分支上开发</h3><p>再次提到，不要再本地 master 分支上开发，每天让本地 master 分支追踪远程 master 分支，并拉取最新代码，同时保证 master 分支是干净的。这样，我们每次切出的分支才是干净的，这会减少大量可能存在的 bug 引入与 冲突解决。</p><p>检查当前分支：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch</span><br></pre></td></tr></table></figure><p>切回 master 分支</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout master</span><br></pre></td></tr></table></figure><p>拉取最新代码</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git pull --rebase</span><br></pre></td></tr></table></figure><p>从 master 分支切出新分支</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout -b dev-jason</span><br></pre></td></tr></table></figure><p>这时会已经切到了 dev-jason 分支，但是并没有声明当前分支所追踪的远程分支，则无法知道当前 diff。</p><p>所以跟踪远程 master 分支</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git branch --set-upstream-to=origin/master dev-jason</span><br><span class="line"><span class="meta">#</span><span class="bash">or</span></span><br><span class="line">git branch -u origin master</span><br></pre></td></tr></table></figure><p>这样就可以再新分支上开发并推送修改到远程 master 分支上了。</p><p>而多人协作时最常出现的情况就是在 push 远程分支上出现冲突，和前面提到的一样，这时因为远程分支已经进行了修改，但是我们切出的分支与远程分支已经分叉，需要做的就是将远程分支的修改拉到切出的分支上，使用 <code>git pull</code> 解决往冲突后，切出的分支实的修改实际就是基于当前更新后的远程 master 分支进行修改了。</p><h3 id="git-pull-操作"><code>git pull</code> 操作</h3><p><code>git pull</code> 命令先运行 <code>git fetch</code> 去下载相关仓库的内容。然后执行一个 <code>git merge</code> 操作，把远程的内容 ref 与 当前的 head merge, 并指向一个新的当地 merge commit。整个操作如同从图1</p><p><img src="https://jason24-zeng.github.io/img/git-%E5%A4%9A%E4%BA%BA%E5%BC%80%E5%8F%91-%E4%B8%8E-%E5%88%86%E6%94%AF%E7%AE%A1%E7%90%86/bubble-diagram_01.svg" alt="bubble-diagram_01.svg"></p><p>到图2</p><p><img src="https://jason24-zeng.github.io/img/git-%E5%A4%9A%E4%BA%BA%E5%BC%80%E5%8F%91-%E4%B8%8E-%E5%88%86%E6%94%AF%E7%AE%A1%E7%90%86/bubble-diagram_02.svg" alt="bubble-diagram_02.svg"></p><p>的整个流程。</p><p>相比 <code>git pull</code> 这个操作需要我们新更新一个 commit 以及 merge 切出去的分支的流程，我个人更喜欢用 <code>git pull --rebase</code> 这种换基的操作。这样做的好处是保证一个线性历史的追踪以及不必要的 merge commit。事实上，因为 --rebase 是一个非常常见的操作，所以我们可以直接设置一个 configuration, 保证使用 <code>git pull</code> 时，其实际操作是 <code>git pull --rebase</code>，这个操作是</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global branch.autosetuprebase always</span><br></pre></td></tr></table></figure><p>与 merge 整个分支不同，rebase 把已提交的本地 commits 复制并写到了远程分支 commits 后面，这样就保证了历史 commit 的线性。其图表示为：</p><p><img src="https://jason24-zeng.github.io/img/git-%E5%A4%9A%E4%BA%BA%E5%BC%80%E5%8F%91-%E4%B8%8E-%E5%88%86%E6%94%AF%E7%AE%A1%E7%90%86/bubble-diagram_03.png" alt="bubble-diagram_03.png"></p>]]></content>
      
      
      <categories>
          
          <category> cmd line tools </category>
          
          <category> git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> git </tag>
            
            <tag> Devops </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>搜索框架</title>
      <link href="/2022/02/19/%E6%90%9C%E7%B4%A2%E6%A1%86%E6%9E%B6/"/>
      <url>/2022/02/19/%E6%90%9C%E7%B4%A2%E6%A1%86%E6%9E%B6/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="98d5fe80a8563229fd3d8e68db47affcd085c719f03beeeb0c1f21b58f544fac">68a8c3278477baad47ac774912504a9cceb004670a82c9d08beb888f382dd542740dde5e6172bf72d004d7c3b89ea60b11543478adf904d0b2e5a667568c351b9c1abee2c5d58ca8c1e82497524efaa1deb973a4323b6d7bdeeae0a614f495249daa514636ff0f5c4069b767f990eb9da86c1e3f519ba112488ac4d34b75736250e51953735aed25611c4ef7dd978f71c32a7cef14e8937d1689b9d0d60e502c62a8bb6e8f1340d356680f483e347bf6587832d2917b70aa3a432395319c35c76268143d0574abd985c7034acaa3ed9820b7f87b229239104599450d2038ef1c65c168d40a6d5d21a3dcf5544f466508ee767caf338c9267cefbf77b8235dfc73dcd045984421e274be9088434f080256c8a2b36c0a54213a5c9bdadb534381fc1bac1b7103eed46bbd78b495f2b7bd5cf991dfc402e31568d321a2ce799f22bd88a2f5fd21be6b3ba6784b2d8609cddaf7b2f3234084d90579ab2905ecc52875410ff983b0d65394f5ef849db31c48f526e7a48f6110965b17c2ac53513c3875e7527e31134d4d013e4fd0194993faf3801c08f243a1d43510c89f73455ce7923b3e08325e6951b60493f051eba0ea7fb74503c711510d79a3a22fd2d0fb1501a8c3ba631942e7d50a10cf6e93292e2ef45b3dd6f9ab52bf33ed9f78451f50ee32ed8b26c7ba856b1c14cc5f193584e0d73db2e8e0f300aa229aced5da9b0be2e3c0dab89cfea02e1a03ace4157ea52fb122481927ea82ce5df055481f8dd2ec199694123dabba147ce2d69b9d9212984311728ec31fa064178dc9bcdfa1a0d8acc0ab542009d4b36887bae0b5439e9880224c0e68f3fec82c0a6d576998aae26df9176d341db107e03a4d0772e745e022e0e1c40cb134aed33bdf841cf43148dc86cbb9d52241b167154b7cabaca7c259b5025e0fe0a172109059abf50f0ad8884d3c1d6d2e1ac91a731d25d70dc76ac69eb710dd646cb68cfa1b08fc1f799612210abbccd7bbc647a196fb7ed94987b76f46fb0217e98010f8e2ff24f297f9c0738cdd69471a01c96fd441a60f7bcaca59edd18297c2eacacdc88f8053e4eb13326e7b54f16d6b5314b8a190ceac1bf68f2e0d34a3f4c34e9d14afc46b783121bef6333d0d440bc233d601ae17d24a8d972a61829373521341dcc6831065fcbe945b0ec8e299b0675f5000423acdfaedae136f6962751ec1ecb4e766bc006e64e4ca2907e5c7d54bec6f39c7dc7b9c1a888a49d1fdd1a1e4fca323e7ee3995969e73e91b44680bc50756c22f0cf0fc5082b3bd31ba22a8b1ae0ad0bc98df41168680c6c6a1bbc493f51d8f05c31c721d8b5eb9c33cdc309aae673e1e7a57ff1926a8d7e891ff232119128ce2476c9a6edf37f64e7597a45739416162fcf6923935a43bd7d9d047a044ac0564e5ba348ab41230b19ea5266b901f80e43ca48f63875dc7945c5d9bfd3e77ede09860d5fc0609c18d96f226ec99d221cc4e2decdbe5da0d0e5c74c42c3bb979d53255b73b352d7bd405ff129133643a5b8fed736f503c2b0bba5181ac2f559c287e29f3b683757efa34e527803861dfc17ce7b4e776d08e34ee2c6f040985bc72faa36e0629365d3f9ad8d0ddcdee0e0df6ee690e81aed820a977efc411c31b4c0f2af571e73a85c30761811f45e3852559be11cac8ef3cd2cbf5b8543ad8901097e1531d53b6e8539e739d3159409161eee76eb60aeed1d4040adad17f2d212f705898de341e09b963d9bb2b50d2ffc912553a29f29befec9f5161425995d6da7e2f00801c0576c558f756bb1a07d3c6b4f87a8c326f0cd142d76d06f9e4b92980c4ea2ddb4317234719609a9ca190aa150e87a4b02736b5da1b376653e6a2c2b8aa17dedd32ea211b48470b3d425530198b00922f8162db71fd04b5c8f217aed66f06a9dddca5980119235ad5d07cf9c000d16f66f69a98e3b11f0824340cc284af5f10d619fb485cd6748c5c0423584243bc5815cc7d84cdea409d7b68c4f7382f00cece8fd0fec52bb0f09836ede026bd12d6aa2bfeef8f80d4123468f7a083fd362928e40fa27dfc72f4a50830aaf49b4c99e120c32f1ff0fc7d318936f0b2ae5da5b400ea68c957448eb406ae21b2b130b7620f07490e6bc9bf1b707329f80dd337e61920c6b0cd663c8641e8ff99c6085e101e95c08cf3a096e51ac7b0bba9dc7690f6547320fc27a94c21b33d8d2927b225a6c3a2e0ef3c1843cfe163d8c801e481dca8e64b46f4c7dff986c75b8a4bc1ef1f5128f2d08a6f236841de00b6a0fa1b8b53dda5d2fc1eba9c86da767461afa9ffa855e564ea07fb118aed49743be1997c2b976b319f71b57ba70cb4a1dc3918d98b666fbbe0496602ae05947e030e5e6c22033adbeb05bfcaf780f3bdd18afc70fed5a104d9d431dd636349a8053e581d69d7a1710710d16bbf62bf60c0a1f3642fbe6807429c72120cf2166ff343a9bb7078840843f0169fa177f41a1c9a5db2fee488c66d29280cfc20237e221d2ca283543ca6d2999c345a5953da97e611e82ec4f924883023519dce7b17fced756c3a1843f7f0d6b7305c896affa6155f04a88ea0afd01f7bd908dba2648</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">需要密码辅助查验</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> Search </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Search Structure </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>command line 高级语法</title>
      <link href="/2022/02/19/vim-%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/"/>
      <url>/2022/02/19/vim-%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h2 id="vim-高级操作">vim 高级操作</h2><h3 id="输出清晰表格">输出清晰表格</h3><p>命令行参数输出为</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">column -t</span><br></pre></td></tr></table></figure><p>其实就是以 <code>\t</code> 作为分隔符将每行的数据分成不同列<br>例子：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount | column -t</span><br></pre></td></tr></table></figure><p>相应的指令</p><table><thead><tr><th>-s sep</th><th>指定一组字符，用于分隔-t选项的列</th></tr></thead><tbody><tr><td>-t</td><td>确定输入包含的列数并创建表</td></tr><tr><td>-n</td><td>禁用将多个相邻分隔符合并为单个分隔符行为</td></tr><tr><td>-c columns</td><td>输出格式化为显示columns列宽</td></tr><tr><td>-x</td><td>在填充行之前填充列</td></tr><tr><td>-e</td><td>不要忽略空白行</td></tr></tbody></table><h3 id="重复执行某段代码">重复执行某段代码</h3><p>在命令行或者 shell 脚本中经常使用的 while 循环就可以完成这样的操作</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">while true</span><br><span class="line">do </span><br><span class="line">ping -c 1 google.com &gt; /dev/null 2&gt;&amp;1 &amp;&amp; break</span><br><span class="line">done ;</span><br></pre></td></tr></table></figure><p>其中还牵涉到了重定向 <code>&gt; /dev/null 2&gt;&amp;1</code> 的操作。</p><h4 id="重定向">重定向</h4><table><thead><tr><th>命令</th><th>说明</th></tr></thead><tbody><tr><td>command &gt; file</td><td>将输出重定向到 file。</td></tr><tr><td>command &lt; file</td><td>将输入重定向到 file。</td></tr><tr><td>command &gt;&gt; file</td><td>将输出以追加的方式重定向到 file。</td></tr><tr><td>n &gt; file</td><td>将文件描述符为 n 的文件重定向到 file。</td></tr><tr><td>n &gt;&gt; file</td><td>将文件描述符为 n 的文件以追加的方式重定向到 file。</td></tr><tr><td>n &gt;&amp; m</td><td>将输出文件 m 和 n 合并。</td></tr><tr><td>n &lt;&amp; m</td><td>将输入文件 m 和 n 合并。</td></tr><tr><td>&lt;&lt; tag</td><td>将开始标记 tag 和结束标记 tag 之间的内容作为输入。</td></tr></tbody></table><p>重定向符 <code>&gt;</code> 与 <code>&lt;</code> 等的操作如上。另外需要注意的是</p><blockquote><p>文件描述符 0 通常是标准输入（STDIN），1 是标准输出（STDOUT），2 是标准错误输出（STDERR）。</p></blockquote><h3 id="对进程进行排序">对进程进行排序</h3><p>按照内存资源进行排序</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps aux | sort -nk 4</span><br></pre></td></tr></table></figure><p>按照 CPU 资源的使用量对进城进行排序</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps aux | grep -nk 3</span><br></pre></td></tr></table></figure><h3 id="返回之前的目录">返回之前的目录</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd -</span><br></pre></td></tr></table></figure><h3 id="会话关掉之后继续运行环境">会话关掉之后继续运行环境</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup ping -c 10 google.com &amp;</span><br></pre></td></tr></table></figure><p><strong>nohup</strong> 是一个 <a href="https://zh.wikipedia.org/wiki/%E5%8F%AF%E7%A7%BB%E6%A4%8D%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%8E%A5%E5%8F%A3" title="可移植操作系统接口">POSIX</a> 命令，用于忽略 <code>SIGHUP</code> (“<strong>sig</strong>nal <strong>h</strong>ang <strong>up</strong>” 译：挂断信号) 。 <code>SIGHUP</code>信号是终端注销时所发送至程序的一个信号。</p><p>最后的 <code>&amp;</code> 则是表示后台执行的意思</p><h3 id="创建指定大小的文件">创建指定大小的文件</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dd if=/dev/zero of=out.txt bs=1M count=10</span><br></pre></td></tr></table></figure><h3 id="以-root-用户来执行最后一个指令">以 root 用户来执行最后一个指令</h3><p>当我们发现用一般用户无法运行指令时，我们可以切换到 root 用户去执行，而使用一下指令，可以直接使用 root 用户执行操作前的最后一个指令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo !!</span><br></pre></td></tr></table></figure><h3 id="tr-命令"><code>tr</code> 命令</h3><p>我们可以用 <code>tr</code> 命令替换任意字符</p><h4 id="标签符号替换空格符">标签符号替换空格符</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat text.txt | tr `:[space:]` ` ` &gt; out.txt</span><br></pre></td></tr></table></figure><h4 id="大写转小写">大写转小写</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat myfile | tr a-z A-Z&gt; output.txt</span><br></pre></td></tr></table></figure><h3 id="Xargs-指令">Xargs 指令</h3><p>我们可以使用这个命令将命令的输出作为参数传递给另一个命令，比如</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">find. -name *.png -type f -print | xargs tar -cvzf images.tar.gz</span><br><span class="line">cat urls.txt | xargs wget</span><br><span class="line">ls /etc/*.conf | xargs -i cp &#123;&#125; /home/likegeeks/Desktop/out</span><br></pre></td></tr></table></figure><p>其中，第三行的 <code>-i</code> 与 <code>&#123;&#125;</code> 制定了命令行输出的位置</p><h2 id="vim-使用操作">vim 使用操作</h2><h3 id="窗口管理">窗口管理</h3><ul><li><p><code>:sp</code>，split，水平划分。前面加上数字以设置新的窗口高度</p></li><li><p><code>:vs</code>, vertical split，垂直划分。</p></li><li><p><code>ctrl + w + w</code> 光标切换到下一个窗口</p></li><li><p><code>ctrl + w + h/j/k/l</code> 将光标沿方向更改到指定窗口</p></li><li><p><code>ctrl + w + c</code> 关闭当前窗口</p></li><li><p><code>ctrl + w+</code> 增大窗口大小</p></li><li><p><code>ctrl + w-</code> 减少窗口大小</p></li><li><p><code>:only</code> 关闭当前窗口以外的所有窗口</p></li><li><p><code>ctrl + w + n</code> 打开新窗口，窗口使用新的缓冲区。</p></li></ul><h3 id="Tab-管理">Tab 管理</h3><p>我们可以分别管理每个选项卡的窗口布局。要创建标签，我们可以使用<code>:tabnew</code>命令打开一个新标签。</p><p>一些简单的选项卡管理方法是:</p><ul><li><code>:tabnew</code>:打开新标签</li><li><code>:tabclose</code>:关闭当前标签页</li><li><code>:tabn</code>:切换到下一个标签（<strong>n</strong>ext）</li><li><code>gt</code>:切换到下一个标签</li><li><code>:tabp</code>:切换到上一个标签</li><li><code>gT</code>:切换到上一个标签</li><li><code>:tab ball</code>:在单个选项卡中打开所有缓冲区</li><li><code>:tabs</code>:列出所有可用的标签</li></ul><p>随着缓冲区，窗口和选项卡的混排，有时会混淆您当前正在查看的文件。查找当前正在查看的文件名的快速方法是键入:</p><ul><li><strong>CTRL-g</strong>:显示当前文件名</li></ul><h3 id="vimrc-的使用"><code>vimrc</code> 的使用</h3><p>在 <code>vim</code> 中，我们可以通过 <code>:version</code> 命令查看 vim 载入配置的优先顺序，比如我所在的 macOS 系统的返回结果为：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">  system vimrc file: &quot;$VIM/vimrc&quot;</span><br><span class="line">    user vimrc file: &quot;$HOME/.vimrc&quot;</span><br><span class="line">2nd user vimrc file: &quot;~/.vim/vimrc&quot;</span><br><span class="line">     user exrc file: &quot;$HOME/.exrc&quot;</span><br><span class="line">      defaults file: &quot;$VIMRUNTIME/defaults.vim&quot;</span><br><span class="line"> fall-back for $VIM: &quot;/usr/share/vim&quot;</span><br></pre></td></tr></table></figure><p>可以看到 vim 会有限读取 user vimrc file: <code>&quot;$HOME/.vimrc&quot;</code>，当这个文件不存在时，vim 会去寻找 2nd user vimrc file：<code>&quot;~/.vim/vimrc&quot;</code>。了解这个对以后查询 <code>vim</code> 不生效的原因很重要。</p><h3 id="自动补全">自动补全</h3><h4 id="单词补全">单词补全</h4><p>这种补全方式属于单词的前缀匹配，在 Insert 模式下，我们输入一些单词，然后按 <code>ctrl + n</code>， vim 会自动出现下拉菜单，且默认选中第一个单词，此时可以使用上下光标进行单词的选择。而 <code>ctrl + p</code> 的功能也是这样的，只是默认选中列表的最后一个单词。</p><h4 id="行补全">行补全</h4><p>这种补全方式不再只补全其中一个单词，而是自动补全整句，使用的操作命令顺序为：<code>ctrl + x</code> 、 <code>ctrl + l</code></p><h4 id="字典补全">字典补全</h4><p>假定有一个候选字典表 <code>my_diction.txt</code>，里面每一行都会有一个单词，我们可以载入这个词典表，基于这个词典表进行 Vim 自动补全，设置步骤为：</p><ol><li><p>在 <code>$HOME/.vimrc</code> 配置文件中加入: <code>set dictionary-=~/dict.txt dictionary+=~/dict.txt</code></p></li><li><p>打开 <code>vim</code>，在插入模式下输入 <code>ctrl + x</code> 后输入 <code>ctrl + k</code>，就可以匹配字典中的单词</p></li><li><p>如果想要使用单词补全的方法显示列表，即使用 <code>ctrl + n</code>，可以考虑配置 <code>.vimrc</code> 文件，加入: <code>set complete-=k complete+=k</code></p></li></ol><h3 id="Reference-17">Reference</h3><p><a href="https://zhuanlan.zhihu.com/p/47383299">15个超实用的Linux 命令行使用技巧</a></p><p><a href="https://zhuanlan.zhihu.com/p/90721457">Vim 高级使用技巧汇总</a></p><p><a href="https://webdevetc.com/blog/tabs-in-vim/">Beginners Guide to Tabs in Vim</a></p><p><a href="https://www.youtube.com/watch?v=J0-N1nVTU4k">https://www.youtube.com/watch?v=J0-N1nVTU4k</a></p><p><a href="https://github.com/wsdjeg/vim-galore-zh_cn#%E4%BB%80%E4%B9%88%E6%98%AF-vim">Vim 从入门到精通</a></p><p><a href="https://vimjc.com/vim-auto-complement.html">Vim自带自动补齐功能-Vim入门教程(11)</a></p>]]></content>
      
      
      <categories>
          
          <category> cmd line tools </category>
          
          <category> vim </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vim </tag>
            
            <tag> cmd </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DSL 语句学习</title>
      <link href="/2022/02/19/DSL-%E8%AF%AD%E5%8F%A5%E5%AD%A6%E4%B9%A0/"/>
      <url>/2022/02/19/DSL-%E8%AF%AD%E5%8F%A5%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> ElasticSearch </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ElasticSearch </tag>
            
            <tag> DSL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>多机使用 Hexo</title>
      <link href="/2022/02/04/%E5%A4%9A%E6%9C%BA%E4%BD%BF%E7%94%A8-Hexo/"/>
      <url>/2022/02/04/%E5%A4%9A%E6%9C%BA%E4%BD%BF%E7%94%A8-Hexo/</url>
      
        <content type="html"><![CDATA[<h3 id="Reference-18">Reference</h3><p><a href="https://git-scm.com/book/zh/v2/Git-%E5%B7%A5%E5%85%B7-%E5%AD%90%E6%A8%A1%E5%9D%97">Git 工具 - 子模块</a></p><p><a href="https://git-scm.com/book/zh/v2/Git-%E5%88%86%E6%94%AF-%E5%88%86%E6%94%AF%E7%9A%84%E6%96%B0%E5%BB%BA%E4%B8%8E%E5%90%88%E5%B9%B6">Git 分支 - 分支的新建与合并</a></p><p><a href="https://mindawei.github.io/2018/05/01/%E5%A4%9A%E6%9C%BA%E4%BD%BF%E7%94%A8Hexo%E5%8D%9A%E5%AE%A2/">多机使用Hexo博客</a></p><h3 id="前言-11">前言</h3><p>因为工作原因，需要在新电脑上更新博客，为此，我特地研究了一下如何将源码传到博客上的方法。但是对于一些 prerequisite 的软件要求，还需要按照 <a href="https://jason24-zeng.github.io/2022/01/14/%E6%90%AD%E5%BB%BAHexo-blog/">搭建 Hexo 博客</a> 里的提示下载安装。</p><h3 id="思路">思路</h3><p>完成源码多机使用的关键是源码共享，为此，我们需要将 hexo 的根目录上传到一个远程仓库中，对其他机器可见，而其他有权限机器也能对其做修改。而 <code>git</code> 恰好可以满足我们的要求。</p><h3 id="实现步骤">实现步骤</h3><h4 id="创建贡献远程分支">创建贡献远程分支</h4><h5 id="在博客根节点上初始化-git">在博客根节点上初始化 git</h5><p><code>cd</code> 到相应目录，初始化根节点</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git init</span><br></pre></td></tr></table></figure><h5 id="创建并切换分支">创建并切换分支</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout -b &lt;branch_name&gt;</span><br></pre></td></tr></table></figure><h5 id="连接远程分支到根目录">连接远程分支到根目录</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote add origin git@…&lt;git_url&gt;</span><br></pre></td></tr></table></figure><h5 id="关联远程分支">关联远程分支</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -u origin master</span><br></pre></td></tr></table></figure><h5 id="push-远程分支到相应的-branch-分支">push 远程分支到相应的 branch 分支</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push origin &lt;branch_name&gt;</span><br></pre></td></tr></table></figure><h5 id="切换跟踪分支">切换跟踪分支</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -u orgin &lt;branch_name&gt;</span><br></pre></td></tr></table></figure><h5 id="更新分支">更新分支</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 方法 I</span></span><br><span class="line">git add .</span><br><span class="line">git commit -m &quot;your commit&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> push</span></span><br><span class="line">git push origin &lt;branch_name&gt;</span><br></pre></td></tr></table></figure><h4 id="新主机使用博客操作">新主机使用博客操作</h4><h5 id="拉取代码">拉取代码</h5><h5 id="注意事项">注意事项</h5><p>注意上述操作可能会出现 submodule 的缺失问题，需要使用 <code>git submodule init</code> 等操作进行更新。主要原因是上传的根目录下，存在一些其他的 git 节点，这些节点没有被上传。</p>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> Blog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ElasticSearch (VI) -- Kibana 使用</title>
      <link href="/2022/02/03/ElasticSearch-VI/"/>
      <url>/2022/02/03/ElasticSearch-VI/</url>
      
        <content type="html"><![CDATA[<h3 id="Kibana-介绍">Kibana 介绍</h3><p>Kibana 是一种辅助 ElasticSearch 进行可视化数据分析的工具，它的存在大大方便了我们对线上搜索日志数据或者机器性能等的 Inspection。可以简单得通过 docker-compose 启动一个 kibana 容器，并与 elastic 服务相连。</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">version: <span class="string">&quot;3.8&quot;</span></span><br><span class="line"></span><br><span class="line">services:</span><br><span class="line">  elasticsearch:</span><br><span class="line">    image: elasticsearch:<span class="number">7.16</span><span class="number">.2</span></span><br><span class="line">    container_name: elasticsearch</span><br><span class="line">    environment:</span><br><span class="line">      - discovery.type=single-node</span><br><span class="line">      - cluster.name=docker-cluster</span><br><span class="line">      - bootstrap.memory_lock=<span class="literal">true</span></span><br><span class="line">      - <span class="string">&quot;ES_JAVA_OPTS=-Xms512m -Xmx512m&quot;</span></span><br><span class="line">      # - cluster.initial_master_nodes=elasticsearch</span><br><span class="line">    ulimits:</span><br><span class="line">      memlock:</span><br><span class="line">        soft: <span class="number">-1</span></span><br><span class="line">        hard: <span class="number">-1</span></span><br><span class="line">    ports:</span><br><span class="line">      - <span class="number">9200</span>:<span class="number">9200</span></span><br><span class="line">      - <span class="number">9300</span>:<span class="number">9300</span></span><br><span class="line">    volumes:</span><br><span class="line">      - ./elasticsearch/data:/usr/share/elasticsearch/data</span><br><span class="line">      - ./elasticsearch/logs:/usr/share/elasticsearch/logs</span><br><span class="line">    networks:</span><br><span class="line">      - es-net</span><br><span class="line"></span><br><span class="line">  kibana:</span><br><span class="line">    image: kibana:<span class="number">7.16</span><span class="number">.2</span></span><br><span class="line">    container_name: kibana_1</span><br><span class="line">    depends_on:</span><br><span class="line">      - elasticsearch</span><br><span class="line">    ports:</span><br><span class="line">      - <span class="number">5601</span>:<span class="number">5601</span></span><br><span class="line">    environment:</span><br><span class="line">      - ELASTICSEARCH_HOSTS=http:<span class="comment">//elasticsearch:9200</span></span><br><span class="line">      - I18N_LOCALE=zh-CN</span><br><span class="line">      - xpack.monitoring.ui.container.elasticsearch.enabled=<span class="literal">false</span></span><br><span class="line">    volumes:</span><br><span class="line">      - ./kibana/kibana.yml:/usr/share/kibana/config/kibana.yml:rw</span><br><span class="line">    networks:</span><br><span class="line">      - es-net</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">networks:</span><br><span class="line">  es-net:</span><br></pre></td></tr></table></figure><p>注意在上面的配置中，我们使用 networks 连接，并将这个 network 取名为 es-net。如果这个 es-net 不存在，则使用上述配置，否则，network 项需要改成</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">networks:</span><br><span class="line">  es-net: </span><br><span class="line">    driver: <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>另外 kibana 环境在 docker-compose 中无法切换成中文，需要进入 <code>/usr/share/kibana/config</code> 目录中，修改或添加下列几项到 <code>kibana.yml</code> 文件中</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Default Kibana configuration for docker target</span></span><br><span class="line"><span class="attr">server.host:</span> <span class="string">&quot;0&quot;</span></span><br><span class="line"><span class="attr">elasticsearch.hosts:</span> [ <span class="string">&quot;http://elasticsearch:9200&quot;</span> ] <span class="comment"># 与 elasticsearch 中设定的名字有关</span></span><br><span class="line"><span class="attr">monitoring.ui.container.elasticsearch.enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">i18n.locale:</span> <span class="string">zh-CN</span></span><br></pre></td></tr></table></figure><h3 id="Kibana-使用简单入门">Kibana 使用简单入门</h3><p>当我们打开浏览器，连接 <code>http://127.0.0.1:5601/</code> 出现如下网页或者让我们添加集成时，就显式我们已经成功：</p><p><img src="https://jason24-zeng.github.io/img/ElasticSearch-VI/kibana_welcome.png" alt="kibana_welcome.png"></p><p>或者我们可以使用其开发工具输入 <code>GET _search</code>查看配置，便能看到相应的返回结果如下</p><p><img src="https://jason24-zeng.github.io/img/ElasticSearch-VI/discover_devops.png" alt="discover_devops.png"></p><h3 id="Discover-Overview">Discover Overview</h3><p>我们在使用 Kibana 时，最常使用的应该就是 Kibana 的 Discover 功能，他为我们提供了一个可视化过滤与汇总统计数据的方式，是我们使用 ElasticSearch 阶段不可缺少的工具。</p><p>首先在左侧选择栏中找到 「Management（管理）: Stack Management」&gt;&gt; 「Kibana: Index Pattern（索引模式）」中点击创建索引模式进行创建。这里就不单独介绍了，直接使用样例进行创建，创建后在索引模式中展现如下。</p><p><img src="https://jason24-zeng.github.io/img/ElasticSearch-VI/kibana_index_pattern.png" alt="kibana_index_pattern.png"></p><p>可以看到左侧选择栏有 「Analytics : Discover」这一栏，点击它，便进入了进行可视化数据统计的入口如下页面展示，接下来主要介绍这四个区域。</p><p><img src="https://jason24-zeng.github.io/img/ElasticSearch-VI/discover_overview.png" alt="discover_overview.png"></p><h4 id="区域-A">区域 A</h4><p>条件搜索框，用于根据条件返回有关信息。主要有两部分 搜索框 + 时段框 + 其他筛选条件，在设置好这两个条件框及其他筛选条件后，点击刷新，就完成了搜索。</p><h5 id="搜索框">搜索框</h5><p>有两种语言，一种是 KQL(Kibana Query Language)，一种是 Lucene。两者是一致的，只是 KQL 提供简化查询语法并支持脚本字段，同样KQL 还提供自动完成功能，用于条件的选择，而对 Lucene 的支持稍微差一点，需要手写 Lucene 条件匹配语句。搜索语句可以保存。</p><h5 id="时段框">时段框</h5><p>时段框用于对统计时间区间进行筛选，支持绝对筛选，相对筛选。</p><p>绝对筛选：即筛选从「某年某月某日某时某分某秒」到 「某年某月某日某时某分某秒」的数据</p><p>相对筛选：即筛选离「当前」「多少 秒/分钟/小时/日/周/月/季度/年/十年」「前/后」等的数据。注意，可以就筛选「当前」。</p><h5 id="其他筛选条件">其他筛选条件</h5><p>看到有一个「 + 添加筛选 」的选项，点击，选择想要进行筛选的字段和运算符，进行条件的筛选。这个筛选栏拿出来的目的是多个筛选可能会用到一些同样的条件，使用这个其他筛选条件可以保持这些筛选条件的固定。</p><h4 id="区域-B">区域 B</h4><p>区域 B 是一个统计柱状图，统计整个时间区间内，每个时段的数据 <code>count</code> 值，可以通过右上角 「图标选项」进行一定操作，比如隐藏图标，或者设定时段区间。</p><h4 id="区域-C">区域 C</h4><p>区域 C 为命中的 doc 及其相关信息，与其只展现 Time 与一些 区域 D 选中的相关字段。</p><h4 id="区域-D">区域 D</h4><p>区域 D 则为选择想要展示的字段，以及可选的字段。注意，每次请求发送所返回的响应体，会包含所有可选字段(域内所有字段)，而我们可以通过 区域 D 进行选择想要的字段。而选择字段可以通过一个个浏览的方式去选择，也可以通过字段名称的搜索匹配去选择，还可以通过类别筛选的方式进行。</p><h4 id="其他区域">其他区域</h4><p>其实 Discover 右上角还有一些 「选项」，「检查」等操作，可以用来查看更底层的发送请求与相应，同样支持保存操作，已被后续修改。</p><h4 id="后台运行搜索-session">后台运行搜索 session</h4><p>有时候我们可能想要搜索大量的数据，这可能会花很长的时间。这时候我们可以在后台运行我们的请求，从而可以继续进行其他工作。操作步骤：</p><ol><li><p>Load dashboard。搜索会话自动开始，在 dashboard 的 title 后的时钟 icon 会展示当前搜索会话的状态，是正在运行，还是结束。</p></li><li><p>为了告诉 Kibana 要持续后台搜索，点击那个时钟 icon ，然后点击「保存会话 / Save session」</p></li><li><p>而为了看我们保存的搜索，可以打开主菜单，然后点击 「Stack Management」&gt; 「Search Session」。</p></li><li><p>选择要看的那个搜索会话，点击</p><ol><li><p>「Inspect」查看造成这个搜索的请求和过滤条件</p></li><li><p>「Edit」 编辑一个会话的名字</p></li><li><p>「Extend」延长一个完整 session 的 expiration</p></li><li><p>「Delete」删除一个会话</p></li></ol></li></ol><h3 id="Dashboard">Dashboard</h3><p>Dashboard 就是我们常说的可视化看板，是为了将字段或者一些统计数据直观得展现出来的可视化界面。它可以是直接通过对源数据进行聚合进行展现，也可以通过上面的 Discover 保存的结果中进行 Add。主要展现形式是图标。</p><h5 id="将搜索结果加入看板">将搜索结果加入看板</h5><ul><li><p>打开一个 Dashboard</p></li><li><p>点击 「Add from Library」或「从库中添加」</p></li><li><p>从选项中选择保存过的搜索，然后点击 <strong>X</strong> 退出</p></li></ul><h3 id="Reference-9">Reference</h3><p><a href="https://www.tizi365.com/archives/796.html">Kibana Discover数据查询</a><br><a href="https://www.cnblogs.com/chenqionghe/p/12501218.html">Lucene查询语法汇总</a><br><a href="https://www.cnblogs.com/chenqionghe/p/12503181.html">Kibana详细入门教程</a><br><a href="https://zhuanlan.zhihu.com/p/102185616">ELK总结——第四篇Kibana的简介</a><br><a href="https://www.elastic.co/guide/en/kibana/current/discover-search-for-relevance.html">Search for relevance</a><br><a href="https://www.elastic.co/guide/en/kibana/current/dashboard.html#dashboard">Dashboard and visualizations</a></p>]]></content>
      
      
      <categories>
          
          <category> ElasticSearch </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ElasticSearch </tag>
            
            <tag> Apache </tag>
            
            <tag> Kibana </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ElasticSearch (V) -- 中文分词</title>
      <link href="/2022/02/02/ElasticSearch-V/"/>
      <url>/2022/02/02/ElasticSearch-V/</url>
      
        <content type="html"><![CDATA[<p>这一章节主要讲解如何下载安装与使用分词器。</p><p>ElasticSearch 镜像里有各式各样的英文分词器，比如特定语言分词器，正则分词器，stop 分词器，空白分词器，简单分词器，标准分词器等。但是对于中文分词的支持不是很好，我们需要单独下载安装中文分词的插件，这里介绍对中文分词器 IK-analyzer 的下载安装。</p><h3 id="分词器下载安装">分词器下载安装</h3><h4 id="使用-docker-compose-对集群进行安装">使用 docker-compose 对集群进行安装</h4><p>需要单独给每个节点安装，使用指令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker-compose exec es01 elasticsearch-plugin install https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v7.16.2/elasticsearch-analysis-ik-7.16.2.zip</span><br><span class="line">docker-compose exec es02 elasticsearch-plugin install https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v7.16.2/elasticsearch-analysis-ik-7.16.2.zip</span><br></pre></td></tr></table></figure><p>然后需要重启 es 容器</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker-compose restart es01</span><br><span class="line">docker-compose restart es02</span><br></pre></td></tr></table></figure><p>需要注意，分词器的版本需要与 es 的镜像版本保持一致，比如上面，我们使用的 elasticsearch 的版本就是 7.16.2。镜像更新后，其他 plugin 也需要相应得进行更新。否则可能有如下报错：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Exception in thread &quot;main&quot; java.lang.IllegalArgumentException: Plugin [analysis-ik] was built for Elasticsearch version 7.1.1 but version 7.16.2 is running</span><br></pre></td></tr></table></figure><h4 id="进入容器内对单点进行安装">进入容器内对单点进行安装</h4><p>另一种方法稍微麻烦一点，不使用 <code>docker-compose</code> 命令，整体操作如下</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 0x01. 进入容器</span><br><span class="line">docker exec -it elasticsearch_01 /bin/bash</span><br><span class="line">// 0x02. 使用 bin 目录的 elasticsearch-plugin install 安装插件</span><br><span class="line">bin/elasticsearch-plugin install https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v7.1.1/elasticsearch-analysis-ik-7.16.2.zip</span><br><span class="line">// 0x03. cmd + D 退出并重启容器</span><br><span class="line">docker restart elasticsearch_01</span><br></pre></td></tr></table></figure><h4 id="验证分词插件是否成功">验证分词插件是否成功</h4><p>首先先通过重启后的日志检查是否 load 了 <code>analysis-ik</code> 这个插件，具体如下图：</p><p><img src="/Users/zijianzeng/Documents/hexo/new_blog/source/img/ElasticSearch-V/ik_installed_info.png" alt="ik_installed_info.png"></p><p>则表示 load 成功了，再验证能否正常使用该插件。</p><p>使用 postman 发送分析请求</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET http://127.0.0.1:9200/_analyze</span><br></pre></td></tr></table></figure><p>使用 <code>ik_smart</code> 分词，请求体为</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;analyzer&quot;</span>: <span class="string">&quot;ik_smart&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;text&quot;</span>: <span class="string">&quot;我们是中国软件工程师&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>或使用 <code>ik_max_word</code> 分词</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;analyzer&quot;</span>: <span class="string">&quot;ik_max_word&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;text&quot;</span>: <span class="string">&quot;我们是中国软件工程师&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最终 <code>ik_smart</code> 返回结果是</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;tokens&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;token&quot;</span>: <span class="string">&quot;我们&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;start_offset&quot;</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;end_offset&quot;</span>: <span class="number">2</span>,</span><br><span class="line">            <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;CN_WORD&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;position&quot;</span>: <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;token&quot;</span>: <span class="string">&quot;是&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;start_offset&quot;</span>: <span class="number">2</span>,</span><br><span class="line">            <span class="attr">&quot;end_offset&quot;</span>: <span class="number">3</span>,</span><br><span class="line">            <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;CN_CHAR&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;position&quot;</span>: <span class="number">1</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;token&quot;</span>: <span class="string">&quot;中国&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;start_offset&quot;</span>: <span class="number">3</span>,</span><br><span class="line">            <span class="attr">&quot;end_offset&quot;</span>: <span class="number">5</span>,</span><br><span class="line">            <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;CN_WORD&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;position&quot;</span>: <span class="number">2</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;token&quot;</span>: <span class="string">&quot;软件&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;start_offset&quot;</span>: <span class="number">5</span>,</span><br><span class="line">            <span class="attr">&quot;end_offset&quot;</span>: <span class="number">7</span>,</span><br><span class="line">            <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;CN_WORD&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;position&quot;</span>: <span class="number">3</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;token&quot;</span>: <span class="string">&quot;工程师&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;start_offset&quot;</span>: <span class="number">7</span>,</span><br><span class="line">            <span class="attr">&quot;end_offset&quot;</span>: <span class="number">10</span>,</span><br><span class="line">            <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;CN_WORD&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;position&quot;</span>: <span class="number">4</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>ik_max_word</code> 与之稍有区别，如下：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;tokens&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;token&quot;</span>: <span class="string">&quot;我们&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;start_offset&quot;</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;end_offset&quot;</span>: <span class="number">2</span>,</span><br><span class="line">            <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;CN_WORD&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;position&quot;</span>: <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;token&quot;</span>: <span class="string">&quot;是&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;start_offset&quot;</span>: <span class="number">2</span>,</span><br><span class="line">            <span class="attr">&quot;end_offset&quot;</span>: <span class="number">3</span>,</span><br><span class="line">            <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;CN_CHAR&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;position&quot;</span>: <span class="number">1</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;token&quot;</span>: <span class="string">&quot;中国&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;start_offset&quot;</span>: <span class="number">3</span>,</span><br><span class="line">            <span class="attr">&quot;end_offset&quot;</span>: <span class="number">5</span>,</span><br><span class="line">            <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;CN_WORD&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;position&quot;</span>: <span class="number">2</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;token&quot;</span>: <span class="string">&quot;软件工程&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;start_offset&quot;</span>: <span class="number">5</span>,</span><br><span class="line">            <span class="attr">&quot;end_offset&quot;</span>: <span class="number">9</span>,</span><br><span class="line">            <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;CN_WORD&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;position&quot;</span>: <span class="number">3</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;token&quot;</span>: <span class="string">&quot;软件&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;start_offset&quot;</span>: <span class="number">5</span>,</span><br><span class="line">            <span class="attr">&quot;end_offset&quot;</span>: <span class="number">7</span>,</span><br><span class="line">            <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;CN_WORD&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;position&quot;</span>: <span class="number">4</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;token&quot;</span>: <span class="string">&quot;工程师&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;start_offset&quot;</span>: <span class="number">7</span>,</span><br><span class="line">            <span class="attr">&quot;end_offset&quot;</span>: <span class="number">10</span>,</span><br><span class="line">            <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;CN_WORD&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;position&quot;</span>: <span class="number">5</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;token&quot;</span>: <span class="string">&quot;工程&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;start_offset&quot;</span>: <span class="number">7</span>,</span><br><span class="line">            <span class="attr">&quot;end_offset&quot;</span>: <span class="number">9</span>,</span><br><span class="line">            <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;CN_WORD&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;position&quot;</span>: <span class="number">6</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;token&quot;</span>: <span class="string">&quot;师&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;start_offset&quot;</span>: <span class="number">9</span>,</span><br><span class="line">            <span class="attr">&quot;end_offset&quot;</span>: <span class="number">10</span>,</span><br><span class="line">            <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;CN_CHAR&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;position&quot;</span>: <span class="number">7</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>而非报错信息，即证明分词器可用。</p><h3 id="创建索引时设置分词器">创建索引时设置分词器</h3><p>操作例子如下</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PUT http://elasticsearch-1:9200/analyzer_index</span><br></pre></td></tr></table></figure><p>请求体为</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;settings&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;analysis&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;analyzer&quot;</span>: &#123;</span><br><span class="line">               <span class="attr">&quot;my_analyzer&quot;</span>: &#123;</span><br><span class="line">                    <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;whitespace&quot;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;mappings&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;properties&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;name&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;text&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;team_name&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;text&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;position&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;text&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;play_year&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;long&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;jerse_no&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;keyword&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;title&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;text&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;analyzer&quot;</span>: <span class="string">&quot;my_analyzer&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意 mapping 中的 title 使用了 analyzer 配置。当然，在 <code>&quot;title&quot;</code>里面设置 analyzer 还可以直接设置已有的 plugin，比如 <code>&quot;ik_max_word&quot;</code>。</p><h3 id="Reference-8">Reference</h3><p><a href="https://www.cnblogs.com/geoffreygao/p/13889696.html">ElasticSearch7.2简单命令实操(postman版)</a></p>]]></content>
      
      
      <categories>
          
          <category> ElasticSearch </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ElasticSearch </tag>
            
            <tag> Apache </tag>
            
            <tag> Ik 分词器 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ElasticSearch (IV) -- Elastic 搜索查询语法</title>
      <link href="/2022/02/02/ElasticSearch-IV/"/>
      <url>/2022/02/02/ElasticSearch-IV/</url>
      
        <content type="html"><![CDATA[<h3 id="DSL-搜索">DSL 搜索</h3><p>DSL 搜索时 Domain Speicific Search。我们不必如下式全局搜索展示的一样在搜索时写一连串的条件体。这样的做法在于方便 debug。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET http://localhost:9200/nba/_search?q=play_year:10&amp;q=name:库里</span><br></pre></td></tr></table></figure><h4 id="DSL-搜索形式">DSL 搜索形式</h4><p>DSL 以 JSON 请求体的形式发起搜索请求，允许更加复杂，强大的查询</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">POST http://localhost:9200/nba/_doc/_search</span><br><span class="line"><span class="meta">#</span><span class="bash">  请求</span></span><br><span class="line">&#123;</span><br><span class="line">    &quot;query&quot;: &#123;</span><br><span class="line">        &quot;match&quot; : &#123; # match 只是查询中的一种</span><br><span class="line">            &quot;play_year&quot; : 10</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>请求与返回结果如下：</p><p><img src="https://jason24-zeng.github.io/img/ElasticSearch-IV/DSL_1.png" alt="DSL_1.png"></p><h4 id="多条件判断">多条件判断</h4><p>复杂一点的范围查询，比如找出 <code>play_year &gt; 5</code> 且 <code>position = shooting guard</code> 的 NBA 球员</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">POST http://localhost:9200/nba/_doc/_search</span><br></pre></td></tr></table></figure><p>请求体：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;bool&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;filter&quot;</span> : &#123;</span><br><span class="line">                <span class="attr">&quot;range&quot;</span> : &#123;</span><br><span class="line">                    <span class="attr">&quot;play_year&quot;</span> : &#123;</span><br><span class="line">                        <span class="attr">&quot;gt&quot;</span> : <span class="number">5</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;must&quot;</span> : &#123;</span><br><span class="line">                <span class="attr">&quot;match&quot;</span> : &#123;</span><br><span class="line">                    <span class="attr">&quot;position&quot;</span> : <span class="string">&quot;shooting guard&quot;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这样搜索就可以了。返回结果</p><p><img src="https://jason24-zeng.github.io/img/ElasticSearch-IV/DSL_2.png" alt="DSL_2.png"></p><h4 id="或逻辑判断">或逻辑判断</h4><p>如果我们想返回 <code>name=Lebron 詹姆斯</code> 和 <code>name=James 哈登</code>两个匹配的结果，可以输入</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">POST http://localhost:9200/nba/_doc/_search</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;match&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;name&quot;</span> : <span class="string">&quot;Lebron James&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>返回结果如下，因为 match 是指找到所有能匹配请求体中 string 的结果。</p><p><img src="https://jason24-zeng.github.io/img/ElasticSearch-IV/DSL_3.png" alt="DSL_3.png"></p><h3 id="高亮显式">高亮显式</h3><p>想要高亮否一些 fields，可以通过在请求体中加入一个与 <code>query</code> 同级的 <code>highlight</code> 请求体</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">POST http://localhost:9200/nba/_doc/_search</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;match&quot;</span> : &#123; </span><br><span class="line">            <span class="attr">&quot;position&quot;</span> : <span class="string">&quot;shooting guard&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;highlight&quot;</span> : &#123;</span><br><span class="line">        <span class="attr">&quot;fields&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;position&quot;</span> : &#123;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="聚合">聚合</h3><p>类似于 SQL 中的 group by 操作</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">POST http://localhost:9200/nba/_doc/_search</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;aggs&quot;</span> : &#123;</span><br><span class="line">        <span class="attr">&quot;all_interests&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;terms&quot;</span> : &#123;</span><br><span class="line">                <span class="attr">&quot;field&quot;</span> : <span class="string">&quot;play_year&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="批量查询或插入数据">批量查询或插入数据</h3><h4 id="批量查询数据">批量查询数据</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">POST http://localhost:9200/nba/_doc/_mget</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;ids&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;2&quot;</span>,</span><br><span class="line">        <span class="string">&quot;23&quot;</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中有数据不存在，不影响结果的返回，只是对该 id 的返回体 <code>found</code> 为 <code>false</code></p><h4 id="批量插入、修改、删除数据">批量插入、修改、删除数据</h4><p>使用 <code>_bulk</code> api 完成如下请求格式</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;action : &#123;metadata&#125; &#125; \n</span><br><span class="line">&#123;request body        &#125; \n</span><br><span class="line">&#123;action : &#123;metadata&#125; &#125; \n</span><br><span class="line">&#123;request body        &#125; \n</span><br><span class="line">...</span><br></pre></td></tr></table></figure><h6 id="插入请求体示例">插入请求体示例</h6><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;create&quot;</span>:&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;nba&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="number">3</span>&#125;&#125;</span><br><span class="line">&#123;<span class="attr">&quot;name&quot;</span>: <span class="string">&quot;Anthony Davids&quot;</span>, <span class="attr">&quot;team_name&quot;</span>:<span class="string">&quot;Los Angles Lakers&quot;</span>, <span class="attr">&quot;position&quot;</span>:<span class="string">&quot;Center&quot;</span>, <span class="attr">&quot;play_year&quot;</span>:<span class="number">9</span>&#125;</span><br><span class="line">&#123;<span class="attr">&quot;create&quot;</span>:&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;nba&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>: <span class="number">12</span>&#125;&#125;</span><br><span class="line">&#123;<span class="attr">&quot;name&quot;</span>: <span class="string">&quot;Russel Westbrook&quot;</span>, <span class="attr">&quot;team_name&quot;</span>:<span class="string">&quot;Los Angles Lakers&quot;</span>, <span class="attr">&quot;position&quot;</span>:<span class="string">&quot;Point Guard&quot;</span>, <span class="attr">&quot;play_year&quot;</span>:<span class="number">10</span>&#125;</span><br></pre></td></tr></table></figure><p>注意每一行都需要 <code>\n</code></p><h6 id="删除请求体示例">删除请求体示例</h6><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;delete&quot;</span>:&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;nba&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="number">2</span>&#125;&#125;</span><br><span class="line">&#123;<span class="attr">&quot;delete&quot;</span>:&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;nba&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;htJWtX4BnmkKdz--Ip7s&quot;</span>&#125;&#125;</span><br></pre></td></tr></table></figure><p>批量请求大小多少才能使性能最高？并不是越大越好，因为请求越大，给其他请求可用的内存就越小，可以找到一个请求 bulk，超过这个，性能就不再提升。而这个 bulk 数与我们的硬件，文档大小和复杂度以及索引和搜索的负载有关。一个好的批次最好保持在 5 - 15 MB 之间。</p><h3 id="分页">分页</h3><p>和 SQL 中的 <code>LIMIT</code> 关键字相似，返回只有一页的结果， Elasticsearch 接受 <code>from</code> 和 <code>size</code> 参数，这两个参数和 C++ 中的 substr 一致，<code>from</code> 表示起始位置与 <code>0</code> 之间的 offset，而 <code>size</code> 则表示需要获取的结果数。</p><p>如果我们想要每页显示 5 个结果，页码从 1 到 3，请求结果为</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GET .../_search?size=5</span><br><span class="line">GET .../_search?size=5&amp;from=5</span><br><span class="line">GET .../_search?size=5&amp;from=10</span><br></pre></td></tr></table></figure><p><strong>Warning!</strong> ：需要注意，在集群中做深度分页会有问题。假设我们请求第 1000 页的 10 条结果，每页的 size 为 50 个，那意味着我们会请求节点排序 50050 条结果，但最终丢弃其中的 50040 条结果，排序结果的花销随着分页的深入而成倍增长。因此网络搜索引擎中任何语句都不能返回多余 1000 个结果。</p><h3 id="映射">映射</h3><p>Elasticsearch 可以自动判断类型，但有时其判断的类型和实际需求不符，这时我们需要明确字段类型。</p><p>自动判断的规则为：</p><table><thead><tr><th>JSON 类型</th><th>Field 类型</th></tr></thead><tbody><tr><td>Boolean: <code>true</code> of <code>false</code></td><td><code>&quot;boolean&quot;</code></td></tr><tr><td>Whole number: <code>123</code></td><td><code>&quot;long&quot;</code></td></tr><tr><td>Floating point: <code>123.45</code></td><td><code>&quot;double&quot;</code></td></tr><tr><td>String.valid date: <code>&quot;2014-09-15&quot;</code></td><td><code>&quot;date&quot;</code></td></tr><tr><td>String: <code>&quot;foo bar&quot;</code></td><td><code>&quot;string&quot;</code></td></tr></tbody></table><p>Elasticsearch 中支持的类型：</p><table><thead><tr><th>类型</th><th>表示的数据类型</th></tr></thead><tbody><tr><td>String</td><td><code>&quot;string&quot;,&quot;text&quot;,&quot;keyword&quot;</code></td></tr><tr><td>Whole number</td><td><code>&quot;long&quot;,&quot;byte&quot;,&quot;integer&quot;,&quot;long&quot;</code></td></tr><tr><td>Floating point</td><td><code>&quot;double&quot;,&quot;double&quot;</code></td></tr><tr><td>Date</td><td><code>&quot;date&quot;</code></td></tr><tr><td>Boolean</td><td><code>&quot;boolean&quot;</code></td></tr></tbody></table><p>Notice:</p><ol><li><p>Elasticsearch 5.x 不再支持<code>string</code>，而用 <code>text</code> 与 <code>keyword</code> 类型代替。</p></li><li><p>当一个字段要被全文搜索时 (需要分词)，比如 Email 内容，产品描述，应该使用 <code>text</code> 类型。这样字段内容会被分析，在生成倒排索引之前，字符串会被分析器分成一个个词，<code>text</code> 类型的字段不用于排序，很少用于聚合。</p></li><li><p><code>keyword</code> 类型则适用于索引结构化的字段，比如 Email 地址，主机名，状态码和标签。如果字段需要进行过滤、排序、聚合。<code>keyword</code> 类型的字段只能通过精确值搜到。</p></li></ol><h4 id="创建明确类型的索引">创建明确类型的索引</h4><p>操作</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PUT http://localhost:9200/itcast</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;settings&quot;</span> : &#123;</span><br><span class="line">        <span class="attr">&quot;index&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;number_of_shards&quot;</span> : <span class="string">&quot;2&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;number_of_replicas&quot;</span> : <span class="string">&quot;0&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;mappings&quot;</span> : &#123;</span><br><span class="line">        <span class="attr">&quot;person&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;properties&quot;</span> : &#123;</span><br><span class="line">                <span class="attr">&quot;name&quot;</span> : &#123;</span><br><span class="line">                    <span class="attr">&quot;type&quot;</span> : <span class="string">&quot;text&quot;</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">&quot;age&quot;</span> : &#123;</span><br><span class="line">                    <span class="attr">&quot;type&quot;</span> : <span class="string">&quot;integer&quot;</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">&quot;mail&quot;</span> : &#123;</span><br><span class="line">                    <span class="attr">&quot;type&quot;</span> : <span class="string">&quot;keyword&quot;</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">&quot;hobby&quot;</span> : &#123;</span><br><span class="line">                    <span class="attr">&quot;type&quot;</span> : <span class="string">&quot;text&quot;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上面这个例子在 ES 7.x 中是会报错的，报错为</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;error&quot;: &#123;</span><br><span class="line">        &quot;root_cause&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">                &quot;type&quot;: &quot;mapper_parsing_exception&quot;,</span><br><span class="line">                &quot;reason&quot;: &quot;Root mapping definition has unsupported parameters:  [person : &#123;properties=&#123;mail=&#123;type=keyword&#125;, name=&#123;type=text&#125;, age=&#123;type=integer&#125;, hobby=&#123;type=text&#125;&#125;&#125;]&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        ],</span><br><span class="line">        &quot;type&quot;: &quot;mapper_parsing_exception&quot;,</span><br><span class="line">        &quot;reason&quot;: &quot;Failed to parse mapping [_doc]: Root mapping definition has unsupported parameters:  [person : &#123;properties=&#123;mail=&#123;type=keyword&#125;, name=&#123;type=text&#125;, age=&#123;type=integer&#125;, hobby=&#123;type=text&#125;&#125;&#125;]&quot;,</span><br><span class="line">        &quot;caused_by&quot;: &#123;</span><br><span class="line">            &quot;type&quot;: &quot;mapper_parsing_exception&quot;,</span><br><span class="line">            &quot;reason&quot;: &quot;Root mapping definition has unsupported parameters:  [person : &#123;properties=&#123;mail=&#123;type=keyword&#125;, name=&#123;type=text&#125;, age=&#123;type=integer&#125;, hobby=&#123;type=text&#125;&#125;&#125;]&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;status&quot;: 400</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>报错原因是， ES 7 之后，对于 <code>document_type</code> 这个 mapping type 被移除了，具体的细节可以查询 <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/removal-of-types.html">Removal of mapping types</a></p><p>所以正确的构造请求体为</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;settings&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;index&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;number_of_shards&quot;</span>: <span class="string">&quot;2&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;number_of_replicas&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;mappings&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;properties&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;name&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;text&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;age&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;integer&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;mail&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;keyword&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;hobby&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;text&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个明确类型最大的效果实际上是在分词那部分。我们需要给我们需要的字段设定 <code>text</code> 类型，因为 <code>keyword</code>类型无法分词。</p><h3 id="结构化查询">结构化查询</h3><p>查询操作使用相同，只是请求体内容不同</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PUT http://localhost:9200/nba/_doc/_search</span><br></pre></td></tr></table></figure><h4 id="term-查询">term 查询</h4><p><code>term</code> 主要是用于精确匹配一些数字，日期，布尔值或 <code>not_analyzed</code> 的字符串</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;term&quot;</span>: &#123;<span class="attr">&quot;age&quot;</span>:    <span class="number">26</span>&#125;&#125;</span><br><span class="line">&#123;<span class="attr">&quot;term&quot;</span>: &#123;<span class="attr">&quot;date&quot;</span>:   <span class="string">&quot;2022-02-02&quot;</span>&#125;&#125;</span><br><span class="line">&#123;<span class="attr">&quot;term&quot;</span>: &#123;<span class="attr">&quot;public&quot;</span>:    <span class="literal">true</span>&#125;&#125;</span><br><span class="line">&#123;<span class="attr">&quot;term&quot;</span>: &#123;<span class="attr">&quot;tag&quot;</span>:    <span class="string">&quot;full_text&quot;</span>&#125;&#125;</span><br></pre></td></tr></table></figure><p>用例</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;query&quot;</span> : &#123;</span><br><span class="line">        <span class="attr">&quot;term&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;play_year&quot;</span> : <span class="number">10</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="terms-查询">terms 查询</h4><p>相比 <code>term</code> 查询，<code>terms</code> 查询可以查询 满足某个 term 的多个值</p><p>请求体的一个例子为：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;terms&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;play_year&quot;</span>: [</span><br><span class="line">                <span class="number">12</span>,</span><br><span class="line">                <span class="number">10</span></span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="range-查询">range 查询</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;range&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;play_year&quot;</span> : &#123;</span><br><span class="line">                <span class="attr">&quot;gte&quot;</span> : <span class="number">10</span>,</span><br><span class="line">                <span class="attr">&quot;lt&quot;</span>: <span class="number">20</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>范围操作符有：</p><ul><li><code>gt</code> : 大于</li><li><code>gte</code> : 大于等于</li><li><code>lt</code> : 小于</li><li><code>lte</code> : 小于等于</li></ul><h4 id="exists-查询">exists 查询</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;exists&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;field&quot;</span> : <span class="string">&quot;jerse_no&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>用于查询当前文档中包含该字段的文档</p><h4 id="match-查询">match 查询</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;match&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;play_year&quot;</span> : <span class="string">&quot;10&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>不管是全文查询还是精确查询基本上都要用到它。无论这个字段是结构化的数据还是非结构化的数据，都可以使用 <code>match</code> 进行查询。在多次搜索中，我们需要 specify 到底我们希望返回的是多词的交还是多词的并，则需要加入 <code>&quot;operator&quot;</code>，如下：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;match&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;team_name&quot;</span> : &#123;</span><br><span class="line">                 <span class="attr">&quot;query&quot;</span> : <span class="string">&quot;Anthony Davids&quot;</span></span><br><span class="line">                 <span class="string">&quot;operator&quot;</span> : <span class="string">&quot;or&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>多词查询实际上不会选取 <code>AND</code> 和 <code>OR</code> 这种极端，更可能是使用一个相似度得分去查询数据。通过 <code>minimum_should_match</code> 来制定匹配度。</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;query&quot;</span> : &#123;</span><br><span class="line">        <span class="attr">&quot;match&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;name&quot;</span> : &#123;</span><br><span class="line">                <span class="attr">&quot;query&quot;</span> : <span class="string">&quot;Anthony Davids&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;minimum_should_match&quot;</span> : <span class="string">&quot;90%&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="bool-查询">bool 查询</h4><p>bool 查询是用于合并多个查询结果的布尔逻辑的查询，其主要关键字如下：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;bool&quot;</span> : &#123;</span><br><span class="line">        <span class="attr">&quot;must&quot;</span> : &#123;<span class="attr">&quot;term&quot;</span> : &#123;<span class="attr">&quot;folder&quot;</span> : <span class="string">&quot;inbox&quot;</span>&#125;&#125;, <span class="comment">// 可以理解为 and</span></span><br><span class="line">        <span class="attr">&quot;must_not&quot;</span> : &#123;<span class="attr">&quot;term&quot;</span> : &#123;<span class="attr">&quot;tag&quot;</span> : <span class="string">&quot;spam&quot;</span>&#125;&#125;, <span class="comment">// 可以理解为 not</span></span><br><span class="line">        <span class="attr">&quot;should&quot;</span> : [                              <span class="comment">// 可以理解为 or</span></span><br><span class="line">            &#123;<span class="attr">&quot;term&quot;</span> : &#123;<span class="attr">&quot;starred&quot;</span> : <span class="literal">true</span>&#125;&#125;,</span><br><span class="line">            &#123;<span class="attr">&quot;term&quot;</span> : &#123;<span class="attr">&quot;unread&quot;</span> : <span class="literal">true</span>&#125;&#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>距离如下</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;bool&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;must_not&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">                    <span class="attr">&quot;play_year&quot;</span>: <span class="number">10</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;must&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">                    <span class="attr">&quot;team_name&quot;</span>: <span class="string">&quot;Los&quot;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="过滤查询">过滤查询</h3><p>前面讲到结构化查询， 而 ES 其实还支持过滤查询，如 term、range、match 等</p><p>一个例子如下</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;bool&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;filter&quot;</span> : &#123;</span><br><span class="line">                <span class="attr">&quot;term&quot;</span> : &#123;</span><br><span class="line">                    <span class="attr">&quot;play_year&quot;</span> : <span class="number">15</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>那这个例子与结构化查询之间有什么区别呢？</p><ul><li><p>一个过滤语句会询问每个文档的字段值，去判断是否包含着特定值</p></li><li><p>查询语句则会询问每个文档的字段值与特定值的匹配程度。也就是会计算每个文档与查询语句的相关性，给出一个相关性评分 <code>_score</code>，然后再按照相关性对匹配的文档进行排序，这种评分方式适用于一个没有完全配置结果的全文本搜索。</p></li><li><p>一个简单的文档列表，快速匹配运算并存入内存是十分方便的。这些缓存的过滤结果集合或许请求的结合使用非常高效。</p></li><li><p>查询结果不仅要查找相匹配的文档，还计算每个文档的相关性，所以一般来说查询语句更耗时，且不缓存结果。</p></li></ul><p>所以，当我们做精确匹配搜索时，最好用过滤语句，这样可以缓存数据，且不必计算相关性。</p><h3 id="Reference-7">Reference</h3><p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/removal-of-types.html">Removal of mapping types</a></p>]]></content>
      
      
      <categories>
          
          <category> ElasticSearch </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ElasticSearch </tag>
            
            <tag> Apache </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ElasticSearch (III) -- Elastic 使用入门 + Postman 使用</title>
      <link href="/2022/01/31/ElasticSearch-III/"/>
      <url>/2022/01/31/ElasticSearch-III/</url>
      
        <content type="html"><![CDATA[<h3 id="ElasticSearch-使用入门">ElasticSearch 使用入门</h3><h3 id="RESTful-api-的创建与使用">RESTful api 的创建与使用</h3><p>From Wiki:</p><blockquote><p>REpresentational State Transfer, REST 是一种软件架构风格，定义了一组创建 Web 服务的约束。RESTful Web 服务允许请求系统通过使用统一和预定义的无状态操作集来访问和操作 Web 资源的文本表示。</p></blockquote><p>所以，REST 到底是什么？就是客户端向服务端请求访问制定数据，或者在服务端推送、保存数据，服务端相应客户端请求的过程。从编程的角度可能更加容易解释，服务端提供一个端点 URL 给客户端，客户端连接这个端点并发送数据（REST 不负责存储携带的数据）、服务端返回相应。这样的流程就是 REST 的流程。这里面主要有几个模块需要简单了解。</p><ol><li><p>资源 Resource：真是的对象数据，可以是集合也可以是单个个体，每一种资源都有特定的 URI（统一资源定位符）与之对应。资源里面还可以包含子资源。</p></li><li><p>表现形式 Representational：信息实体，是资源具体呈现的形式，比如 json，xml 等。</p></li><li><p>状态转移 State Transfer：通过HTTP 动词实现增删查改等操作，从而引起资源状态的改变。这个处于 Server 端。</p></li></ol><h4 id="REST-接口规范">REST 接口规范</h4><p>REST 接口指令主要由四部分组成：动作 + 路径 + 过滤信息 + 状态码，动作主要是用于 specify 增删查改等操作，而路径又称 “endpoint”，是 API 的具体网址。</p><h5 id="动作">动作</h5><ul><li><p>GET: 请求服务器获取特定资源</p></li><li><p>POST：在服务器上创建一个新的资源</p></li><li><p>PUT：更新服务器上的资源（倾向于整体更新）</p></li><li><p>PATCH：更新服务器上的资源 （倾向于部分更新）</p></li><li><p>DELETE：从服务器删除特定的资源</p></li></ul><h5 id="路径">路径</h5><p>对路径在开发过程中会有一定的规范要求</p><ol><li><p>网址中不能有动词，只能有名词，API 中的名词也应该使用复数。如果 API 调用并不涉及资源（如计算，翻译等操作），可以使用动词。</p></li><li><p>不用大写字母，建议用 <code>-</code> 而非 <code>_</code></p></li></ol><h5 id="过滤信息-Filtering">过滤信息 (Filtering)</h5><p>在查询是可以添加特定的条件，建议使用 url 参数的形式。比如</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET /merchandise?is_live=true&amp;size=10</span><br></pre></td></tr></table></figure><h5 id="状态码">状态码</h5><p>状态码范围：</p><table><thead><tr><th>2xx：成功</th><th>3xx：重定向</th><th>4xx：客户端错误</th><th>5xx：服务器错误</th></tr></thead><tbody><tr><td>200 成功</td><td>301 永久重定向</td><td>400 错误请求</td><td>500 服务器错误</td></tr><tr><td>201 创建</td><td>304 资源未修改</td><td>401 未授权</td><td>502 网关错误</td></tr><tr><td></td><td></td><td>403 禁止访问</td><td>504 网关超时</td></tr><tr><td></td><td></td><td>404 未找到</td><td></td></tr><tr><td></td><td></td><td>405 请求方法不对</td><td></td></tr></tbody></table><h3 id="Elasticsearch-接口语法">Elasticsearch  接口语法</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X&lt;VERB&gt; &#x27;&lt;PROTOCOL&gt;://&lt;HOST&gt;:&lt;PORT&gt;/&lt;PATH&gt;?&lt;QUERY_STRING&gt;&#x27; -d &#x27;&lt;BODY&gt;&#x27;</span><br></pre></td></tr></table></figure><p>其中：</p><table><thead><tr><th>参数</th><th>解释</th></tr></thead><tbody><tr><td>VERB</td><td>适当的 HTTP 方法 或 谓词 : GET 、 POST 、 PUT 、 HEAD 或者 DELETE 。</td></tr><tr><td>PROTOCOL</td><td>http 或者 https （如果在 Elasticsearch 前面有一个 https 代理）</td></tr><tr><td>HOST</td><td>Elasticsearch 集群中任意节点的主机名，或者用 localhost 代表本地机器上的节点。</td></tr><tr><td>PORT</td><td>运行 Elasticsearch HTTP 服务的端口号，默认是 9200 。</td></tr><tr><td>PATH</td><td>API 的终端路径（例如 _count 将返回集群中文档数量）。</td></tr><tr><td>QUERY_STRING</td><td>任意可选的查询字符串参数 (例如 ?pretty 将格式化地输出 JSON 返回值，使其更容易阅读)</td></tr><tr><td>BODY</td><td>一个 JSON 格式的请求体 (如果请求需要的话)</td></tr></tbody></table><p>比如：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">curl -XGET -HContent-Type:application/json &#x27;http://localhost:9200/_count?pretty&#x27; -d &#x27;</span><br><span class="line">&#123;</span><br><span class="line">    &quot;query&quot;: &#123;</span><br><span class="line">        &quot;match_all&quot;: &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x27;</span><br></pre></td></tr></table></figure><p>它会返回整个 json 格式的结果</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;count&quot;</span> : <span class="number">0</span>,</span><br><span class="line">  <span class="attr">&quot;_shards&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span> : <span class="number">0</span>,</span><br><span class="line">    <span class="attr">&quot;successful&quot;</span> : <span class="number">0</span>,</span><br><span class="line">    <span class="attr">&quot;skipped&quot;</span> : <span class="number">0</span>,</span><br><span class="line">    <span class="attr">&quot;failed&quot;</span> : <span class="number">0</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="POSTMAN-使用">POSTMAN 使用</h4><p>Postman 是一个非常好用的对容器服务做增删查改操作的接口测试工具。其下载地址为 <a href="https://www.postman.com/downloads/">官方网址</a>。下载后直接解压即可使用，注意将解压后的执行文件移至「应用」文件夹。</p><h5 id="界面基础功能介绍">界面基础功能介绍</h5><p>刚进入界面时，需要自己新建一个 Collection 与 Workspace，然后会进入如下界面。</p><p><img src="https://jason24-zeng.github.io/img/ElasticSearch-III/postman_intro_1.png" alt="postman_intro_1.png"></p><p>主要有四个部分：</p><ol><li><p>左上 Collection（可以理解成文件夹，可以把一个项目的请求放到 Collections 中方便管理）， History 等 Toolbox，用于查找相关的项目，接口集或者历史等</p></li><li><p>右上请求方式与请求网址等。用于 specify 测试的接口。</p></li><li><p>右中请求参数，可以使 key-value 或者其他任意形式的参数，可以理解成过滤信息。</p></li><li><p>右下相应内容，一般使用 Pretty 格式化响应内容。里面包含 HTTP 响应测试码，响应时间与大小等。</p></li></ol><h5 id="集群设置-自动创建索引">集群设置-自动创建索引</h5><p>集群在初始化设置时，不会有 persistent 这个参数，导致使用默认参数 <code>persistent = true</code>，这时，当我们指定一个不存在的索引，新增文档就会报错。而当 <code>persistent = false</code> 时，则会新建文档，同时创建这个不存在的索引。</p><ol><li><p>查看集群设置</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET http://localhost:9200/_cluster/settings</span><br></pre></td></tr></table></figure><p>response 为</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;persistent&quot;</span>: &#123;&#125;,</span><br><span class="line">     <span class="attr">&quot;transient&quot;</span>: &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>修改集群设置<br>操作如下图，可看到返回体中 <code>persistent.action.auto_create_index=false</code><br><img src="https://jason24-zeng.github.io/img/ElasticSearch-III/postman_intro_2.png" alt="postman_intro_2.png"></p></li></ol><h5 id="索引操作-index">索引操作 - index</h5><h6 id="创建索引">创建索引</h6><p>动作 + 路径</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PUT http://localhost:9200/nba</span><br></pre></td></tr></table></figure><p>JSON 格式的请求体</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;mappings&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;properties&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;name&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;text&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;team_name&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;text&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;position&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;text&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;play_year&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;long&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;jerse_no&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;keyword&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>图示</p><p><img src="https://jason24-zeng.github.io/img/ElasticSearch-III/postman_intro_3.png" alt="postman_intro_3.png"></p><h6 id="获取索引">获取索引</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET http://localhost:9200/nba</span><br></pre></td></tr></table></figure><h6 id="关闭索引">关闭索引</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">POST http://localhost:9200/nba/_close</span><br></pre></td></tr></table></figure><h6 id="删除索引">删除索引</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DELETE http://localhost:9200/nba/</span><br></pre></td></tr></table></figure><h5 id="映射操作">映射操作</h5><h6 id="创建映射">创建映射</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PUT http://localhost:9200/nba/_mapping</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;properties&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;name&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;text&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;team_name&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;text&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;position&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;keyword&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;play_year&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;keyword&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;jerse_no&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;keyword&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;country&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;type&quot;</span> : <span class="string">&quot;keyword&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>需要注意到如果不是新建索引，而是在之前索引的基础上进行修改，会有如下报错。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mapper [play_year] cannot be changed from type [long] to [keyword]</span><br></pre></td></tr></table></figure><p>表明我们对已经构建的索引类型进行修改。</p><h6 id="获取索引-2">获取索引</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET http://localhost:9200/nba/_mapping</span><br></pre></td></tr></table></figure><h5 id="文档操作">文档操作</h5><h6 id="新增文档-指定-ID">新增文档-指定 ID</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PUT http://localhost:9200/nba/_doc/23</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;name&quot;</span> : <span class="string">&quot;Lebron 詹姆斯&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;team_name&quot;</span> : <span class="string">&quot;Los Angle Lakers&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;position&quot;</span> : <span class="string">&quot;small forward&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;play_year&quot;</span> : <span class="number">15</span>,</span><br><span class="line">    <span class="attr">&quot;jerse_no&quot;</span> : <span class="string">&quot;23&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="新增文档-不指定-ID">新增文档-不指定 ID</h5><p>注意与上一节的区别是，用的操作类型由 <code>PUT</code> 改成了 <code>POST</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">POST http://localhost:9200/nba/_doc</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;name&quot;</span> : <span class="string">&quot;James 哈登&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;team_name&quot;</span> : <span class="string">&quot;Houston Rockets&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;position&quot;</span> : <span class="string">&quot;shooting guard&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;play_year&quot;</span> : <span class="number">10</span>,</span><br><span class="line">    <span class="attr">&quot;jerse_no&quot;</span> : <span class="string">&quot;13&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;country&quot;</span> : <span class="string">&quot;庞各庄&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>响应体信息</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;_index&quot;</span>: <span class="string">&quot;nba&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;_type&quot;</span>: <span class="string">&quot;_doc&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;_id&quot;</span>: <span class="string">&quot;htJWtX4BnmkKdz--Ip7s&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;_version&quot;</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;result&quot;</span>: <span class="string">&quot;created&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;_shards&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;total&quot;</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="attr">&quot;successful&quot;</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">&quot;failed&quot;</span>: <span class="number">0</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;_seq_no&quot;</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;_primary_term&quot;</span>: <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其他的相关内容可以查看 <a href="https://www.cnblogs.com/geoffreygao/p/13889696.html">ElasticSearch7.2简单命令实操(postman版)</a>。例子非常生动形象。</p><h3 id="Reference-6">Reference</h3><p><a href="https://chinese.freecodecamp.org/news/rest-api-tutorial-rest-client-rest-service-and-api-calls-explained-with-code-examples/">REST API 教程：REST 客户端，REST 服务及 API 调用（含代码示例）</a></p><p><a href="https://www.woshinlper.com/system-design/restful-api/">RestFul API 简明教程</a></p><p><a href="https://www.cnblogs.com/geoffreygao/p/13889696.html">ElasticSearch7.2简单命令实操(postman版)</a></p>]]></content>
      
      
      <categories>
          
          <category> ElasticSearch </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ElasticSearch </tag>
            
            <tag> Apache </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ElasticSearch (II) -- docker 启动 + docker-compose</title>
      <link href="/2022/01/30/ElasticSearch-II/"/>
      <url>/2022/01/30/ElasticSearch-II/</url>
      
        <content type="html"><![CDATA[<h2 id="安装与运行-Elasticsearch">安装与运行 Elasticsearch</h2><p>假设已经下载 Docker、Elasticsearch 和 Kibana，接下来讲解在 docker 里面启动 Elasticsearch 和 Kibana，并对 Elasticsearch 集群启用多个节点。</p><h3 id="Docker-中启动单节点-Elasticsearch">Docker 中启动单节点 Elasticsearch</h3><p>使用如下指令以实例化 ElasticSearch 服务</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --name es -d -p 9200:9200 -p 9300:9300 -e &quot;discovery.type=single-node&quot; elasticsearch:7.16.2</span><br></pre></td></tr></table></figure><p>以上将 9200 端口与 9300 端口映射到 docker 相应端口，如果不做端口映射，浏览器无法访问 elasticsearch 服务。其中 9200 为供 http 访问端口，9300 为供 tcp 访问端口。注意 <code>discovery.type=single-node</code>  指令，对于单机只生成一个节点的情况而言，这个必须指明，否则 docker 启动 elasticsearch 会闪退，相关报错为：<code>the default discovery settings are unsuitable for production use; at least one of [discovery.seed_hosts, discovery.seed_providers, cluster.initial_master_nodes] must be configured</code>。</p><p>如果想要实现数据持久化，则需要通过 -v 参数将 docker 宿主机 (host) 上的目录 mount 到 ElasticSearch 容器里。相关指令如下（<code>/usr/local/es</code> 为宿主机的目录地址）：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --name es -d -v /usr/local/es:/usr/share/elasticsearch/data -p 9200:9200 -p 9300:9300 -e &quot;discovery.type=single-node&quot; elasticsearch:7.16.2</span><br></pre></td></tr></table></figure><p>需要注意的是，宿主机的目录需要赋权，否则会报错：failed to bind service AccessDeniedException</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod 777 /usr/local/es</span><br></pre></td></tr></table></figure><p>执行 <code>docker ps</code> 查看容器是否成功运行。在打开浏览器访问 <code>localhost:9200</code>，如果展现如下，则说明服务启动成功。</p><p><img src="https://jason24-zeng.github.io/img/ElasticSearch-II/local_host.png" alt="local_host.png"></p><p>如果需要可视化管理界面，可以通过 Chrome 浏览器安装插件 ElasticSearch Head.</p><p><img src="https://jason24-zeng.github.io/img/ElasticSearch-II/elasticsearch_head.png" alt="elasticsearch_head.png"></p><p>则最终的展示为</p><p><img src="https://jason24-zeng.github.io/img/ElasticSearch-II/elasticsearch_head2.png" alt="elasticsearch_head2.png"></p><h3 id="ElasticSearch-测试环境配置修改">ElasticSearch 测试环境配置修改</h3><p>配置文件的修改是很有必要的，因为原始的配置文件可能在网络或者资源环境要求上无法满足/overqualify 了测试环境的要求。</p><h4 id="修改-ES-配置文件">修改 ES 配置文件</h4><p>进入容器后，需要修改 es 配置文件，设置宿主机的 ip 地址为任意网络均可访问。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vim config/elasticsearch.yml</span><br><span class="line"><span class="meta">#</span><span class="bash"> 修改如下 host network ip address</span></span><br><span class="line">network.host: 0.0.0.0</span><br></pre></td></tr></table></figure><h4 id="修改启动参数">修改启动参数</h4><p>如果 Elasticsearch 中的 network.host 不是 localhost 或者 127.0.0.1 的话，该容器环境会被认为是生产环境，这个环境要求的一些内存等比较高，测试环境不一定满足，因此需要修改一些配置。</p><p>修改 jvm 启动参数</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vim config/jvm.options</span><br><span class="line"><span class="meta">#</span><span class="bash"> 修改如下配置，将 heap 内存启动参数和最大参数从 4g 修改成 256m</span></span><br><span class="line">-Xms256m</span><br><span class="line">-Xmx256m</span><br></pre></td></tr></table></figure><p>设置一个进程在 VMAs (Virtual Memory Areas) 创建内存映射的最大数量。这个操作需要使用 root 用户去操作。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/sysctl.conf</span><br><span class="line"><span class="meta">#</span><span class="bash"> 加上如下配置</span></span><br><span class="line">vm.max_map_count=655360</span><br><span class="line"><span class="meta">#</span><span class="bash"> 记得需要用 root 权限生效该配置。不过也可能因为虚拟机是 OpenZV 而无法修改</span></span><br><span class="line">sysctl -p</span><br></pre></td></tr></table></figure><p>以 root 权限登入容器</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it --user root f9c23e8de222 /bin/bash</span><br></pre></td></tr></table></figure><p>任何用户组的权限都可以这样切换。如果忘记了用户组名，可以在容器中输入 <code>id</code>, 可以从 <code>groups</code> 中看到组内所有用户。</p><p>如果想要使用 jps、jstack 等 jvm 监控命令，则可能需要换一个 JDK 镜像，因为 docker 中使用的 JDK 镜像是精简版，没有这些额外的 JDK 辅助工具包</p><h3 id="Docker-Compose-使用">Docker-Compose 使用</h3><p>通过上面这些指令去启用 docker 会比较麻烦，主要是后续需要修改一些配置，比如 mount 文件与内存映射最大数量等，这些需要在启动的时候就执行成功，且给予相应的权限，否则进入容器后会因为容器内文件的只读性质而无法更新。同样的，如果写一条冗长的指令满足上述要求的同时，却失去了命令行的简洁直观。这种情况下，提前在宿主机上设置好配置文件，在启动容器时就配置好容器内的一些参数，会是非常必要的方法。而 Docker-Compose 恰好可以承担这样的任务。</p><p>对于下载和安装了 Docker Desktop 或者 Decker for Mac 等的 Mac 用户，我们就不必再单独安装 docker-compose 了。而对于 Linux 用户，则需要如下操作：</p><h4 id="Linux-下-Compose-的安装">Linux 下 Compose 的安装</h4><ol><li><p>下载 Docker Compose 稳定版本</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo curl -L &quot;https://github.com/docker/compose/releases/download/v2.2.2/docker-compose-$(uname -s)-$(uname -m)&quot; -o /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure></li><li><p>给予 binary 可执行权限</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo chmod +x /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure></li><li><p>构建软链，供执行命令调用</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ln -s /usr/local/bin/docker-compose /usr/bin/docker-compose</span><br></pre></td></tr></table></figure></li><li><p>测试是否安装成功</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose --version</span><br></pre></td></tr></table></figure></li></ol><h4 id="配置启动文件-docker-compose-yaml">配置启动文件 <code>docker-compose.yaml</code></h4><p>通过配置启动文件，我们可以将一些参数从宿主机直接传到容器。</p><h5 id="单-es-节点-kibana-配置">单 es 节点 + kibana 配置</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3.8&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">elasticsearch:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">elasticsearch:7.16.2</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">elasticsearch</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">discovery.type=single-node</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">cluster.name=docker-cluster</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">bootstrap.memory_lock=true</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;ES_JAVA_OPTS=-Xms512m -Xmx512m&quot;</span></span><br><span class="line">      <span class="comment"># - cluster.initial_master_nodes=elasticsearch</span></span><br><span class="line">    <span class="attr">ulimits:</span></span><br><span class="line">      <span class="attr">memlock:</span></span><br><span class="line">        <span class="attr">soft:</span> <span class="number">-1</span></span><br><span class="line">        <span class="attr">hard:</span> <span class="number">-1</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">9200</span><span class="string">:9200</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./elasticsearch/data:/usr/share/elasticsearch/data</span></span><br><span class="line">  <span class="attr">kibana:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">kibana:7.16.2</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">kibana_1</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">elasticsearch</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">5601</span><span class="string">:5601</span></span><br><span class="line"></span><br><span class="line"><span class="attr">volumes:</span></span><br><span class="line">  <span class="attr">es-data:</span></span><br><span class="line">    <span class="attr">driver:</span> <span class="string">local</span></span><br></pre></td></tr></table></figure><p>注意：单节点 <code>single-mode</code> 模式下，<code>cluster.initial_master_nodes</code> 是不被允许设置的。</p><h5 id="单-es-节点-kibana-配置-使用网络">单 es 节点 + kibana 配置 + 使用网络</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3.8&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">elasticsearch:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">elasticsearch:7.16.2</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">elasticsearch</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">discovery.type=single-node</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">cluster.name=docker-cluster</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">bootstrap.memory_lock=true</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;ES_JAVA_OPTS=-Xms512m -Xmx512m&quot;</span></span><br><span class="line">      <span class="comment"># - cluster.initial_master_nodes=elasticsearch</span></span><br><span class="line">    <span class="attr">ulimits:</span></span><br><span class="line">      <span class="attr">memlock:</span></span><br><span class="line">        <span class="attr">soft:</span> <span class="number">-1</span></span><br><span class="line">        <span class="attr">hard:</span> <span class="number">-1</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">9200</span><span class="string">:9200</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">9300</span><span class="string">:9300</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./elasticsearch/data:/usr/share/elasticsearch/data</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./elasticsearch/logs:/usr/share/elasticsearch/logs</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">es-net</span></span><br><span class="line">  <span class="attr">kibana:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">kibana:7.16.2</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">kibana_1</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">elasticsearch</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">5601</span><span class="string">:5601</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">ELASTICSEARCH_HOSTS=http://elasticsearch:9200</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">I18N_LOCALE=zh-CN</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">xpack.monitoring.ui.container.elasticsearch.enabled=false</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./kibana/kibana.yml:/usr/share/kibana/config/kibana.yml:rw</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">es-net</span></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">es-net:</span></span><br><span class="line">    <span class="attr">external:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>需要注意的是，我们这里 <code>volumes</code> 不知用到了 data，还需要在当前目录 <code>touch  -e ./kibana/kibana.yml</code> 和 <code>mkdir -p ./elasticsearch/logs</code></p><p>另外需要注意</p><p><code>external</code> is to use an existing network. If you want compose to make networks you simply do:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">networks:</span><br><span class="line">  network1:</span><br></pre></td></tr></table></figure><h5 id="多-es-节点-kibana-配置">多 es 节点 + kibana 配置</h5><p>这里我们用三个节点来做简单配置。需要根据节点数量配置 memory 的大小，刚开始我只设置了 1 G 的内存，因为启动时就需要 1.5 G 内存，结果容器直接启动失败，且无相关日志产出。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.8&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">es01:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">elasticsearch:7.16.2</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">es01</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">node.name=es01</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">cluster.name=es-docker-cluster</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">discovery.seed_hosts=es02,es03</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">cluster.initial_master_nodes=es01,es02,es03</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">bootstrap.memory_lock=true</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;ES_JAVA_OPTS=-Xms512m -Xmx512m&quot;</span></span><br><span class="line">    <span class="attr">ulimits:</span></span><br><span class="line">      <span class="attr">memlock:</span></span><br><span class="line">        <span class="attr">soft:</span> <span class="number">-1</span></span><br><span class="line">        <span class="attr">hard:</span> <span class="number">-1</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./es01/data:/usr/share/elasticsearch/data</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">9200</span><span class="string">:9200</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">elastic</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">es02:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">elasticsearch:7.16.2</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">es02</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">node.name=es02</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">cluster.name=es-docker-cluster</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">discovery.seed_hosts=es01,es03</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">cluster.initial_master_nodes=es01,es02,es03</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">bootstrap.memory_lock=true</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;ES_JAVA_OPTS=-Xms512m -Xmx512m&quot;</span></span><br><span class="line">    <span class="attr">ulimits:</span></span><br><span class="line">      <span class="attr">memlock:</span></span><br><span class="line">        <span class="attr">soft:</span> <span class="number">-1</span></span><br><span class="line">        <span class="attr">hard:</span> <span class="number">-1</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./es02/data:/usr/share/elasticsearch/data</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">elastic</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">es03:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">elasticsearch:7.16.2</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">es03</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">node.name=es03</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">cluster.name=es-docker-cluster</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">discovery.seed_hosts=es01,es02</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">cluster.initial_master_nodes=es01,es02,es03</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">bootstrap.memory_lock=true</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;ES_JAVA_OPTS=-Xms512m -Xmx512m&quot;</span></span><br><span class="line">    <span class="attr">ulimits:</span></span><br><span class="line">      <span class="attr">memlock:</span></span><br><span class="line">        <span class="attr">soft:</span> <span class="number">-1</span></span><br><span class="line">        <span class="attr">hard:</span> <span class="number">-1</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./es03/data:/usr/share/elasticsearch/data</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">elastic</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">kib01:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">kibana:7.16.2</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">kib01</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">5601</span><span class="string">:5601</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">ELASTICSEARCH_URL:</span> <span class="string">http://es01:9200</span></span><br><span class="line">      <span class="attr">ELASTICSEARCH_HOSTS:</span> <span class="string">&#x27;[&quot;http://es01:9200&quot;,&quot;http://es02:9200&quot;,&quot;http://es03:9200&quot;]&#x27;</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">elastic</span></span><br><span class="line"></span><br><span class="line"><span class="attr">volumes:</span></span><br><span class="line">  <span class="attr">data01:</span></span><br><span class="line">    <span class="attr">driver:</span> <span class="string">local</span></span><br><span class="line">  <span class="attr">data02:</span></span><br><span class="line">    <span class="attr">driver:</span> <span class="string">local</span></span><br><span class="line">  <span class="attr">data03:</span></span><br><span class="line">    <span class="attr">driver:</span> <span class="string">local</span></span><br><span class="line"></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">elastic:</span></span><br><span class="line">    <span class="attr">driver:</span> <span class="string">bridge</span></span><br></pre></td></tr></table></figure><h4 id="启动容器">启动容器</h4><p>在启动容器之前，还需要根据配置提前设置到 <code>volumes</code>。比如在单节点模式下，我们进入一个目录，假设是 <code>$Home</code>，那么我们需要</p><ol><li><p>提前创建宿主机上的映射目录 <code>mkdir -p elasticsearch/data</code></p></li><li><p>给予相关目录 777 权限 <code>chmod -R 777 elasticsearch</code></p></li></ol><p>设置好之后，在<code>$Home</code> 目录下执行如下命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure><p>docker 就会去访问<code>$Home</code>目录下 <code>docker-compose.yaml</code> 等相关配置文件。根据配置文件去从网络或者本地拉取镜像，新建并使用镜像启动服务等。而上面的 <code>-d</code> 是 detach 的意思，也就是不仅如此容器。</p><p>可以通过 <code>docker ps -a</code> 等指令查看容器的相关状态，比如是否是 <code>up</code> 拉起的状态，或者因为某一些原因<code>Exited</code>退出等。拉起一段时间后，可以通过访问 <code>localhost:5601</code> 查看 kibana 服务是否正常。</p><h4 id="关闭容器等相关操作">关闭容器等相关操作</h4><p>停止当前目录下 <code>docker-compose.yaml</code> 文件启动的相关容器，使用 <code>docker-compose stop</code> 或 <code>docker-compose kill</code> 停掉 docker。这两者的主要区别是 <code>stop</code> 支持优雅退出，也就是会先接受 SIGTERM 请求，做一些预处理工作保存状态，10 s 后再执行 SIGKILL 请求。而 <code>kill</code> 则是直接执行 SIGKILL 请求对应的操作。</p><p>要查看当前<code>docker-compose.yaml</code> 启用的容器的状态，可以使用 <code>docker-compose ps</code></p><p>关闭服务后的容器的启动可使用 <code>docker-compose start</code> 指令，而如果因为更新配置要重启服务，可以使用 <code>docker-compose restart</code> 指令。</p><p>如果想要看当前 docker 运行情况，可以通过指令<code>docker-compose top</code> 完成</p><h2 id="Reference-5">Reference</h2><p><a href="https://juejin.cn/post/6844904202204872711">Docker部署ElasticSearch及使用</a></p><p><a href="https://www.i4k.xyz/article/Dooonald/87931435">ElasticSearch 6.x 增删改查操作汇总 及 python调用ES中文检索实例_私人天地-程序员信息网</a></p><p><a href="https://stackoverflow.com/questions/65295961/elasticsearch-server-with-docker-compose-java-nio-file-accessdeniedexception">ElasticSearch Server with Docker Compose: java.nio.file.AccessDeniedException: /usr/share/elasticsearch/data/nodes</a></p><p><a href="https://zysite.top/archives/elasticsearch-docker-compose-install">docker-compose部署ElasticSearch集群 | January</a></p><p><a href="https://blog.csdn.net/u011790603/article/details/105227925">elasticsearch:7.4.2 的docker compose文件</a></p>]]></content>
      
      
      <categories>
          
          <category> ElasticSearch </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ElasticSearch </tag>
            
            <tag> Apache </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Docker Intro (I)</title>
      <link href="/2022/01/29/Docker-Intro-I/"/>
      <url>/2022/01/29/Docker-Intro-I/</url>
      
        <content type="html"><![CDATA[<p>Docker 是一个开源的应用容器引擎，让开发者可以打包他们的应用以及依赖包到可移植的镜像中。这样的镜像可以被在任意的 Linux 或 Windows 等包含特定输入输出规则的机器上。它完全使用沙箱机制，相互之间无任何接口。</p><h3 id="Docker-安装">Docker 安装</h3><h4 id="命令行-Homebrew-安装">命令行 Homebrew 安装</h4><p>通过 homebrew 下载并安装到应用目录</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install --cask --appdir=/Applications docker</span><br></pre></td></tr></table></figure><h4 id="Docker-Desktop-for-Mac-安装包安装">Docker Desktop for Mac 安装包安装</h4><p>Docker Desktop for Mac 是 Docker 的一种桌面管理 IDE，用于在 Mac 上构建，调试和测试 Dockerized 应用程序。它是一个完整的开发环境，与 Mac OS Hypervisor 框架，网络与文件系统深度继承，是在 Mac 上运行 Docker 的最快，最可靠的方法。</p><p>在Docker官方网站下载安装文件：<a href="https://link.zhihu.com/?target=https%3A//yq.aliyun.com/go/articleRenderRedirect%3Furl%3Dhttps%253A%252F%252Fhub.docker.com%252Feditions%252Fcommunity%252Fdocker-ce-desktop-mac">https://hub.docker.com/editions/community/docker-ce-desktop-mac</a><br>下载 Docker.dmg安装文件，直接双击安装完成就可以了。</p><h3 id="Docker-更新镜像源">Docker 更新镜像源</h3><p>运行镜像拉取时，可能因为网络原因出现下面 ERROR</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ERROR: Get https://registry-1.docker.io/v2/: net/http: request canceled while waiting for connection (Client.Timeout exceeded while awaiting headers)</span><br></pre></td></tr></table></figure><p>为了解决这个原因，我们可以手动指定镜像源，在 Mac OS 系统中，更新镜像源的文件为</p><p><code>~/.docker/daemon.json</code> 文件，只用加入 以下 json 配置即可更换镜像源</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;registry-mirrors&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;https://registry.docker-cn.com&quot;</span>， <span class="comment">// 中国区官方镜像</span></span><br><span class="line">        <span class="string">&quot;http://hub-mirror.c.163.com&quot;</span>,  <span class="comment">// 网易镜像</span></span><br><span class="line">        <span class="string">&quot;https://docker.mirrors.ustc.edu.cn&quot;</span>  <span class="comment">// 中科大镜像</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如果通过 Homebrew 安装的 Docker，可以尝试点击右上角的🐳图标 &gt; Preference &gt;  Docker Engine 去直接修改那个 configuration 文件</p><h3 id="Docker-容器内安装-vim-等命令行参数">Docker 容器内安装 vim 等命令行参数</h3><p>我们登入 docker 的容器，发现没办法使用 vim 等命令去修改 config 文件或者编辑其他文件，会提示：<code>vim: command not found</code></p><p>为了 solve 这个问题，我们可以进入容器并安装 vim 命令</p><h4 id="可以使用-apt-get-的-sudo-权限安装">可以使用 <code>apt-get</code> 的 <code>sudo</code> 权限安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt-get update</span><br><span class="line">apt-get install vim</span><br></pre></td></tr></table></figure><h4 id="可以使用-yum-的-root-权限安装">可以使用 <code>yum</code> 的 <code>root</code> 权限安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 进入docker 是开启 root</span></span><br><span class="line">docker exec -it --user root 473f6e871544 /bin/bash</span><br><span class="line"><span class="meta">#</span><span class="bash"> 更新下列配置，否则会报错</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Error: Failed to download metadata <span class="keyword">for</span> repo <span class="string">&#x27;appstream&#x27;</span>: Cannot prepare internal mirrorlist: No URLs <span class="keyword">in</span> mirrorlist</span></span><br><span class="line">sed -i &#x27;s/mirrorlist/#mirrorlist/g&#x27; /etc/yum.repos.d/CentOS-Linux-* &amp;&amp;\</span><br><span class="line">sed -i &#x27;s|#baseurl=http://mirror.centos.org|baseurl=http://vault.centos.org|g&#x27; /etc/yum.repos.d/CentOS-Linux-*</span><br><span class="line"><span class="meta">#</span><span class="bash"> 更新 yum</span></span><br><span class="line">yum upgrade -y</span><br><span class="line"><span class="meta">#</span><span class="bash"> 下载安装 vim</span></span><br><span class="line">yum install vim</span><br></pre></td></tr></table></figure><h4 id="安装-top、ps-等命令行">安装 <code>top</code>、<code>ps</code> 等命令行</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install procps</span><br></pre></td></tr></table></figure><p>不过需要注意的是，最好不要在 docker 容器中修改文件，而是将经常修改的文件挂载到宿主机上，这样避免重启时无法回复修改。</p><h3 id="Docker-挂载本地目录">Docker 挂载本地目录</h3><p>Docker 支持把一个宿主机上的目录挂载到镜像里，这样我们就不需要通过修改镜像内的文件去修改配置了。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -v /usr/local/es:/usr/share/elasticsearch/data -e &quot;discovery.type=single-node&quot; -p 9200:9200 -p 9300:9300 --name es elasticsearch</span><br></pre></td></tr></table></figure><h3 id="Docker-相关问题与解决">Docker 相关问题与解决</h3><h4 id="Docker-无法通过指令停止">Docker 无法通过指令停止</h4><p>今天出现了一个无法通过 stop 与 kill 等相关的指令停止或终止容器的问题。</p><p>首先是在已经有一个容器正常运行的基础上，重新 <code>docker-compose up -d</code> 了一个新容器，调用了同一个端口作为映射，导致错误</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br><span class="line">-----------------------------</span><br><span class="line">Creating network &quot;elasticsearch_default&quot; with the default driver</span><br><span class="line">Creating volume &quot;elasticsearch_es-data&quot; with local driver</span><br><span class="line">Creating elasticsearch_01 ...</span><br><span class="line"></span><br><span class="line">ERROR: for elasticsearch_01  UnixHTTPConnectionPool(host=&#x27;localhost&#x27;, port=None): Read timed out. (read timeout=60)</span><br><span class="line"></span><br><span class="line">ERROR: for elasticsearch_01  UnixHTTPConnectionPool(host=&#x27;localhost&#x27;, port=None): Read timed out. (read timeout=60)</span><br><span class="line">ERROR: An HTTP request took too long to complete. Retry with --verbose to obtain debug information.</span><br><span class="line">If you encounter this issue regularly because of slow network conditions, consider setting COMPOSE_HTTP_TIMEOUT to a higher value (current value: 60).</span><br></pre></td></tr></table></figure><p>这时候通过 <code>docker ps -a</code> 可以看到，容器 STATUS 是 CREATED，但是没办法启动，因为接口不对。所以想要停止之前的容器，然后再启动新容器的服务。这时候发现新容器停不下来了，看容器内服务信息<code>docker logs container-id</code>为</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;type&quot;: &quot;server&quot;, &quot;timestamp&quot;: &quot;2022-01-31T07:15:51,250Z&quot;, &quot;level&quot;: &quot;ERROR&quot;, &quot;component&quot;: &quot;i.n.u.c.D.rejectedExecution&quot;, &quot;cluster.name&quot;: &quot;docker-cluster&quot;, &quot;node.name&quot;: &quot;8d619a059150&quot;, &quot;message&quot;: &quot;Failed to submit a listener notification task. Event loop shut down?&quot;, &quot;cluster.uuid&quot;: &quot;S33uPEbYT4iKRFfqRiul-Q&quot;, &quot;node.id&quot;: &quot;To5wb_cQRg-BheySS5Nliw&quot; ,</span><br><span class="line">&quot;stacktrace&quot;: [&quot;java.util.concurrent.RejectedExecutionException: event executor terminated&quot;,</span><br><span class="line">&quot;at io.netty.util.concurrent.SingleThreadEventExecutor.reject(SingleThreadEventExecutor.java:923) ~[netty-common-4.1.66.Final.jar:4.1.66.Final]&quot;,</span><br><span class="line">&quot;at io.netty.util.concurrent.SingleThreadEventExecutor.offerTask(SingleThreadEventExecutor.java:350) ~[netty-common-4.1.66.Final.jar:4.1.66.Final]&quot;,</span><br><span class="line">&quot;at io.netty.util.concurrent.SingleThreadEventExecutor.addTask(SingleThreadEventExecutor.java:343) ~[netty-common-4.1.66.Final.jar:4.1.66.Final]&quot;,</span><br><span class="line">&quot;at io.netty.util.concurrent.SingleThreadEventExecutor.execute(SingleThreadEventExecutor.java:825) ~[netty-common-4.1.66.Final.jar:4.1.66.Final]&quot;,</span><br><span class="line">&quot;at io.netty.util.concurrent.SingleThreadEventExecutor.execute(SingleThreadEventExecutor.java:815) ~[netty-common-4.1.66.Final.jar:4.1.66.Final]&quot;,</span><br><span class="line">&quot;at io.netty.util.concurrent.DefaultPromise.safeExecute(DefaultPromise.java:842) [netty-common-4.1.66.Final.jar:4.1.66.Final]&quot;,</span><br><span class="line">&quot;at io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:499) [netty-common-4.1.66.Final.jar:4.1.66.Final]&quot;,</span><br><span class="line">&quot;at io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616) [netty-common-4.1.66.Final.jar:4.1.66.Final]&quot;,</span><br><span class="line">&quot;at io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:609) [netty-common-4.1.66.Final.jar:4.1.66.Final]&quot;,</span><br><span class="line">&quot;at io.netty.util.concurrent.DefaultPromise.setFailure(DefaultPromise.java:109) [netty-common-4.1.66.Final.jar:4.1.66.Final]&quot;,</span><br><span class="line">&quot;at io.netty.channel.DefaultChannelPromise.setFailure(DefaultChannelPromise.java:89) [netty-transport-4.1.66.Final.jar:4.1.66.Final]&quot;,</span><br><span class="line">&quot;at io.netty.channel.AbstractChannelHandlerContext.safeExecute(AbstractChannelHandlerContext.java:998) [netty-transport-4.1.66.Final.jar:4.1.66.Final]&quot;,</span><br><span class="line">&quot;at io.netty.channel.AbstractChannelHandlerContext.write(AbstractChannelHandlerContext.java:796) [netty-transport-4.1.66.Final.jar:4.1.66.Final]&quot;,</span><br><span class="line">&quot;at io.netty.channel.AbstractChannelHandlerContext.writeAndFlush(AbstractChannelHandlerContext.java:758) [netty-transport-4.1.66.Final.jar:4.1.66.Final]&quot;,</span><br><span class="line">&quot;at io.netty.channel.DefaultChannelPipeline.writeAndFlush(DefaultChannelPipeline.java:1020) [netty-transport-4.1.66.Final.jar:4.1.66.Final]&quot;,</span><br><span class="line">&quot;at io.netty.channel.AbstractChannel.writeAndFlush(AbstractChannel.java:311) [netty-transport-4.1.66.Final.jar:4.1.66.Final]&quot;,</span><br><span class="line">&quot;at org.elasticsearch.http.netty4.Netty4HttpChannel.sendResponse(Netty4HttpChannel.java:34) [transport-netty4-client-7.16.2.jar:7.16.2]&quot;,</span><br><span class="line">&quot;at org.elasticsearch.http.DefaultRestChannel.sendResponse(DefaultRestChannel.java:134) [elasticsearch-7.16.2.jar:7.16.2]&quot;,</span><br><span class="line">&quot;at org.elasticsearch.rest.RestController$ResourceHandlingHttpChannel.sendResponse(RestController.java:588) [elasticsearch-7.16.2.jar:7.16.2]&quot;,</span><br><span class="line">&quot;at org.elasticsearch.rest.action.RestActionListener.onFailure(RestActionListener.java:55) [elasticsearch-7.16.2.jar:7.16.2]&quot;,</span><br><span class="line">&quot;at org.elasticsearch.rest.action.RestActionListener.onResponse(RestActionListener.java:40) [elasticsearch-7.16.2.jar:7.16.2]&quot;,</span><br><span class="line">&quot;at org.elasticsearch.action.support.TransportAction$1.onResponse(TransportAction.java:88) [elasticsearch-7.16.2.jar:7.16.2]&quot;,</span><br><span class="line">&quot;at org.elasticsearch.action.support.TransportAction$1.onResponse(TransportAction.java:82) [elasticsearch-7.16.2.jar:7.16.2]&quot;,</span><br><span class="line">&quot;at org.elasticsearch.action.ActionListener.completeWith(ActionListener.java:447) [elasticsearch-7.16.2.jar:7.16.2]&quot;,</span><br><span class="line">&quot;at org.elasticsearch.action.support.nodes.TransportNodesAction.newResponseAsync(TransportNodesAction.java:181) [elasticsearch-7.16.2.jar:7.16.2]&quot;,</span><br><span class="line">&quot;at org.elasticsearch.action.support.nodes.TransportNodesAction.newResponse(TransportNodesAction.java:156) [elasticsearch-7.16.2.jar:7.16.2]&quot;,</span><br><span class="line">&quot;at org.elasticsearch.action.support.nodes.TransportNodesAction$AsyncAction.lambda$finishHim$0(TransportNodesAction.java:295) [elasticsearch-7.16.2.jar:7.16.2]&quot;,</span><br><span class="line">&quot;at org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:718) [elasticsearch-7.16.2.jar:7.16.2]&quot;,</span><br><span class="line">&quot;at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) [?:?]&quot;,</span><br><span class="line">&quot;at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) [?:?]&quot;,</span><br><span class="line">&quot;at java.lang.Thread.run(Thread.java:833) [?:?]&quot;] &#125;</span><br></pre></td></tr></table></figure><p>出现问题的最主要原因可能是，新创建的容器的某一个配置抢占了旧容器的端口，也阻止了旧容器重新生成旧名称的新容器，因为系统认为旧容器依然存在。</p><p>首先我找到新创建的异常容器，使用 <code>docker rm container-id</code>删除掉了，但是依然 stop 旧容器，报错是 <code>Cannot kill container: : tried to kill container, but did not receive an exit event</code>。</p><p>最后没有办法，直接重启了 docker desktop，就看到旧容器已经 dead 了，然后删除容器即可。</p><h3 id="Reference-3">Reference</h3><p><a href="https://zhuanlan.zhihu.com/p/22382728">一篇不一样的docker原理解析</a></p><p><a href="https://zhuanlan.zhihu.com/p/22403015">一篇不一样的docker原理解析 提高篇</a></p>]]></content>
      
      
      <categories>
          
          <category> Docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ElasticSearch (I) -- 概念与 docker 启用</title>
      <link href="/2022/01/29/ElasticSearch-I/"/>
      <url>/2022/01/29/ElasticSearch-I/</url>
      
        <content type="html"><![CDATA[<h2 id="ELK-Intro">ELK Intro</h2><p>ELK 实际上是三款软件的简称，分别是 Elasticsearch、Logstash、Kibana 组成，在发展过程中，又有新成员 Beats 的加入，所以就形成了 Elastic Stack。</p><p>ELK 主要是用于做日志分析的软件。其中，Elasticsearch 主要是核心存储和检索引擎，而 Kibana 则是用于将 Elasticsearch 的数据可视化化，logstash 是一个高吞吐量数据处理引擎，其将事件日志等通过 Parse 和 Transform 的方式处理后传给 Elasticsearch。而 Beats 则用于采集一切数据，再将这些数据创给 LogStash 或直接传给 Elasticsearch。整个流程框图可简化为：</p><p><img src="https://jason24-zeng.github.io/img/ElasticSearch/elastic_stack_workflow.png" alt="elastic_stack_workflow.png"></p><p>上面初步讲解了四个软件之间是如何协调合作的，下面先简单定义一下这四个软件：</p><ul><li><p><strong>Elasticsearch</strong>: 基于 java，是一个开源分布式搜索引擎，其特点是：分布式、零配置、自动发现、索引自动分片、索引副本机制、restful 风格接口，多数据源、自动搜索负载等。</p></li><li><p><strong>Logstash</strong>：基于 Java，是一个开源的用于收集、分析和存储日志的工具</p></li><li><p><strong>Kibana</strong>：基于 nodejs，可以为 Logstash 和 Elasticsearch 提供日志分析友好的 Web 界面，可以汇总、分析和搜索重要数据日志</p></li><li><p><strong>Beats</strong>：elastic 公司开源的采集系统监控数据的代理 agent，是被监控服务器上以客户端形式运行的数据收集器的总称。由如下组成：</p><ul><li><p>Packetbeat: 网络数据包分析器，用于监控、收集网络流量信息。支持 ICMP(v4 and v6)、DNS、HTTP、MySQL、PostgreSQL、Redis、MongoDB 等协议</p></li><li><p>Filebeat：用于监控、收集服务器日志文件，取代 logstash forwarder</p></li><li><p>Metricbeat：定期获取外部系统的监控指标信息，可以监控、收集 Apache、HAproxy、MongoDB、MySQL、Nginx、PostgreSQL、Redis、Zookeeper 等服务</p></li><li><p>Winlogbeat： 监控收集 Windows 系统的日志信息</p></li></ul></li></ul><h2 id="Introduction-to-ElasticSearch">Introduction to ElasticSearch</h2><p>ElasticSearch 是一种开源的实时搜索引擎，其是基于 Apache Lucene™ 开发的。被认为是目前最先进、功能最齐全的搜索引擎库。需要注意的是 Lucene 只是一个库，需要使用 Java 并将其集成到应用中。要想明白其工作原理，我们还需要充分的了解检索相关的知识才行。</p><p>而 Elasticsearch 便是一个使用 Java 编写的使用 Lucene 建立索引并实现搜索功能的一种引擎。它隐藏了 Lucene 的复杂性，而是让程序员能简单得通过 RESTful API 包装调用。</p><p>除 Lucene 和全文搜索引擎外，ES 还提供了：</p><ul><li><p>分布式的实时文件存储，每个字段都被索引并可被搜索。</p></li><li><p>实时分析的分布式搜索引擎</p></li><li><p>可扩展性，可扩展至上百台服务器，处理 PB 级的结构化或非结构化数据</p></li></ul><p>而所有的这些功能，都被集中到一台服务器，通过 RESTful API 以及各种语言的 client stub 轻松进行交互。它的另一个特点就是极易上手，隐藏了复杂的搜索引擎理论。</p><h3 id="ES-核心概念">ES 核心概念</h3><h4 id="Near-Real-Time-近实时-NRT">Near Real-Time 近实时 NRT</h4><p>搜索平台近实时意味着我们从对文档构建索引到文档能被搜索到之间的时延很短，通常是秒级的。</p><h4 id="Node-节点">Node 节点</h4><p>一个节点可以理解成 Elasticsearch 中的一个服务器，是整个 ES 集群中的一部分，它存储数据，并参与集群的索引与搜索。一个节点需要一个名字作为标识，这个名字会是随机漫威角色的名字，在启动的时候赋予。这个名字需要额外关注，因为我们会需要确定网络中的服务器对应的节点。</p><p>通过配置集群名，一个节点被加入指定集群(default 情况下是名为 elasticsearch 的集群)。一个集群可以拥有无指定上限个节点。如果当前网络中没有任何 Elasticsearch 节点，这时启动一个节点，会默认创建并加入一个叫做 elasticsearch 的集群。</p><h4 id="Cluster-集群">Cluster 集群</h4><p>一个集群就是有一个或多个节点组成的，共同提供整个数据，并一起提供索引和搜索功能的抽象。一个集群会有唯一的名字标识，默认为 elasticsearch。</p><p>Note: 集群名很重要，节点需要制定集群名，才能加入该集群。所以才产品环境中，通常需要显式设定该集群名</p><h4 id="Index-索引">Index 索引</h4><p>一个索引可以认为是根据某一些特征将相似文档分到一起后的集合。可以类比关系型数据库 Database。比如，产品类目的索引，订单数据的索引。一个索引需要一个名字(小写字母) 来表示。当我们要对索引中文档进行索引、搜索、更新和删除时，都需要这个名字。</p><h4 id="Type-类型">Type 类型</h4><p>类型类似于关系型数据库中 Table 的概念。在一个索引中，可以定义一种或多种类型。一个类型可以理解为索引中的逻辑分类/分区。通常会为具有一组共同字段的文档定义一个类型。</p><h4 id="Document-文档">Document 文档</h4><p>文档是可被索引的基础信息单元。比如，一个客户的文档，一个商品的所有信息。文档以 JSON (JavaScript Object Notation) 格式表示。</p><p>在一个 index / type 里，我们可以存储任意多的文档。需要注意的是，文档虽然物理上是存在于索引之中，但文档必须索引、赋予一个索引的 type。类似于关系型数据库中 Record 的概念。除了用户定义的数据外，文档还需要包括 <code>_index</code>，<code>_type</code> 与 <code>_id</code> 字段</p><h4 id="Shard-Replicas-分片与复制">Shard &amp; Replicas 分片与复制</h4><p>有时候一个索引存储的数据超过了任意一个节点对应硬件的负荷要求，比如磁盘空间，或者 CPU 处理相应时延等。ElasticSearch 的解决方法便是分片，将索引划分成多份。每个分片本身也是功能完善并且独立的 “索引”，可被分配给任意节点。</p><p>分片的优势：</p><ol><li><p>提升扩展性，允许扩展内容容量</p></li><li><p>分布式并行操作，提高性能/吞吐量</p></li></ol><p>除此以外，ES 还管理了分片分布以及文档索引聚合的工作。</p><p>另一个问题是，当网络/云环境中，失败发生是很频繁的事情，这可能导致某个节点突然无法工作，需要一个故障转移机制去 back up 这种情况。而 ElasticSearch 的解决方法是允许创建分片的一份或多份拷贝，这个操作被称为 Replica / 复制。</p><p>复制的优势：</p><ol><li><p>分片/节点失败时，可以从其他分片/节点索引，提高引擎可用性。也因为这个原因，复制的分片不能与原分片处于同一节点上</p></li><li><p>扩展了搜索量/吞吐量。</p></li></ol><p>需要注意：分片与复制的数量可以在索引创建的时候指定。但索引一旦创建，分片数就固定了，我们只能动态改变复制的数量。而一个索引的多个分片可以存放在集群中的一台主机，也可以存在多台主机上，主要取决于集群机器数量。主分片和复制分片的具体位置被 ES 内在的策略决定。</p><h4 id="ES-版本选择">ES 版本选择</h4><p>ES 5.0 之前， Elastic Stack 的各个版本都不同意，容易出现版本号混乱问题。从 5.0 开始，所有的 Elastic Stack 中的项目全部统一版本号。方便大家维护和更新。</p><h3 id="elasticsearch-下载和安装">elasticsearch 下载和安装</h3><h4 id="安装-docker">安装 docker</h4><p>详情可参考 <a href="https://jason24-zeng.github.io/2022/01/29/Docker-Intro-I/">Docker Intro (I)</a>，首先安装 Docker，后续 ES，kibana 的使用都在 docker 里运行。</p><h4 id="下载-ES-和-Kibana">下载 ES 和 Kibana</h4><p>先运行</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker search elasticsearch</span><br></pre></td></tr></table></figure><p>查看 docker hub 公用镜像中存在的 elasticseaerch 镜像。可看到显示如下：</p><p><img src="https://jason24-zeng.github.io/img/ElasticSearch/docker_search_elasticsearch.png" alt="docker_search_elasticsearch.png"></p><p>可以考虑 pull elasticsearch-kibana 镜像，使用下面指令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull nshou/elasticsearch-kibana</span><br></pre></td></tr></table></figure><p>或者考虑分别下载 es 和 kibana</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker pull elasticsearch:7.16.2</span><br><span class="line">docker pull kibana:7.16.2</span><br></pre></td></tr></table></figure><p>安装时可以看到如下的信息提示：</p><p><img src="https://jason24-zeng.github.io/img/ElasticSearch/docker_id.png" alt="docker_id.png"></p><p>可以看到 docker 的镜像 ID</p><h5 id="检查机内已安装镜像">检查机内已安装镜像</h5><p>通过下面指令，可以看本机已安装的镜像</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br></pre></td></tr></table></figure><p>或者通过 docker desktop 可视化界面查看。</p><p>如图，可以看到相关的 tag， IMAGE ID 以及创造时间</p><p><img src="https://jason24-zeng.github.io/img/ElasticSearch/image_on_disk.png" alt="image_on_disk.png"></p><h5 id="运行镜像">运行镜像</h5><p>需要映射容器和本机端口 port 9200, 9300, 5601(kibana 专用)</p><p>指令为</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 9200:9200 -p 9300:9300 -p 5601:5601 --name eskibana nshou/elasticsearch-kibana</span><br></pre></td></tr></table></figure><h4 id="Docker-内执行">Docker 内执行</h4><h5 id="查看当前运行容器">查看当前运行容器</h5><p>指令：</p><ul><li><p><code>docker ps</code> （查看正在运行的容器）</p></li><li><p><code>docker ps -a</code> （查看所有容器）</p></li></ul><p>如下图，可以看到 CONTAINER ID 为 f9c23e8de222，NAMES 指定为 eskibana</p><p><img src="https://jason24-zeng.github.io/img/ElasticSearch/docker_ps.png" alt="docker_ps.png"></p><p>进入容器指令： <code>docker exec -it f9c23e8de222 /bin/bash</code></p><p>后续的许多操作都是在该容器中执行的。</p><p>如果不存在 bash，可考虑下面指令 <code>docker exec -it f9c23e8de222 sh</code></p><p>退出容器，则是 <code>cmd + d</code> 或者输入 <code>exit</code></p><h5 id="启动一个已退出的容器">启动一个已退出的容器</h5><p>指令 <code>docker start container-id</code>比如上一节的 <code>docker stop f9c23e8de222</code></p><h5 id="停止容器">停止容器</h5><p>指令: <code>docker stop container-id</code></p><h5 id="删除容器">删除容器</h5><p>指令: <code>docker rm container-id</code></p><h5 id="移除正在运行的容器">移除正在运行的容器</h5><p>指令：<code>docker rm -f webserver</code></p><h5 id="列出本地镜像">列出本地镜像</h5><p>指令：<code>docker list</code></p><h5 id="后台运行">后台运行</h5><p>在大部分场景下，我们希望 docker 的服务是后台运行的，可以通过 <code>-d</code> 执行容器的运行模式。比如下式，启动 <code>elasticsearch:7.16.2</code> 镜像，但是不进入容器，如果不加 <code>-d</code>，默认会直接进入 docker</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -itd elasticsearch:7.16.2 /bin/bash</span><br></pre></td></tr></table></figure><h5 id="重命名容器">重命名容器</h5><p>执行指令: <code>docker rename origin-Names new-Names</code></p><p>如下图，将一个 Names 为 clever_mcnulty 的容器重命名为 abc</p><p><img src="https://jason24-zeng.github.io/img/ElasticSearch/docker_rename.png" alt="docker_rename.png"></p><h3 id="总结">总结</h3><p>这一章节主要简单介绍了一下 Elastic Stack 以及 Elasticsearch，并介绍了如何在 docker 中安装和运行容器 elasticsearch 与 kibana。</p><h3 id="Reference-4">Reference</h3><p><a href="https://www.cnblogs.com/sunsky303/p/9438737.html">Elasticsearch入门，这一篇就够了</a></p><p><a href="https://zhuanlan.zhihu.com/p/135939591">如何系统学习ElasticSearch：死磕 Elasticsearch 方法论（初学者必看</a></p><p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html">Elasticsearch Guide</a></p><p>[Mac中docker版本的ElasticSearch和Kibana安装及操作](<a href="https://blog.csdn.net/m0_37609579/article/details/82698173">Mac中docker版本的ElasticSearch和Kibana安装及操作_十步杀一人-千里不留行-CSDN博客_docker elasticsearch mac</a>)</p>]]></content>
      
      
      <categories>
          
          <category> ElasticSearch </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ElasticSearch </tag>
            
            <tag> Apache </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Golang-Intro (I)</title>
      <link href="/2022/01/28/Golang-Intro-I/"/>
      <url>/2022/01/28/Golang-Intro-I/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="03f46b48879dd598d3b1421da18b574644998157c2e0e90bc0e63032ed5ec788">288c496f07cd7a970f0e86fc14828c2c7ff54ab2cc0761c06bcad47f6660946924e3d2bcb9311f6d61fc5adc8abe0cce8e2f418451136ce065041fbdf8d994ba0cbb39f1961b50683fb5104f8a6ed9d5964bef8b363f9cf2e6c50e549b272606ad765679fca2e0fb49a251ecfb7df84729647dd7e5c293598111ca32343ef2c95e6ea0f5ef697d655684438589f9047f65806a1d05ea4a4e6d619a71a7129d32227cab84b5ed02e72cad349a7e4b39dce96980f871129650a97aa6d2c759ff3befe239323dbb16cd13c23370ca9c3f07ca84f2d441e0cc1e9bdae108c32fde93fae1dea5ca1e963ac8b4cdbdade89014b54b50cd4d24bf76e14f5d086cd2794de33bd4db6e85038f36f3bd7c37f7af11fdc39f89fbd2d4604d3b982c8a8baebb57d2507edaf220b63ff48a4febfc2d6934e75abb4d90a407aeea89811fe87d81</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">需要密码辅助查验</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> golang </category>
          
      </categories>
      
      
        <tags>
            
            <tag> golang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>gRPC and protobuf</title>
      <link href="/2022/01/26/grpc-and-protobuf/"/>
      <url>/2022/01/26/grpc-and-protobuf/</url>
      
        <content type="html"><![CDATA[<h2 id="gRPC">gRPC</h2><h3 id="什么是-RPC">什么是 RPC?</h3><p>RPC 是 Remote Procedure Call 的缩写，即远程过程调用，该调用包含了传输协议和编码协议等。无需额外的变成，就能实现一台计算机的程序为另一台计算机的程序调用的交互过程。我们常称之为 RPC 调用。从抽象的角度来说，RPC 不在本地执行，其都拥有三个特点：</p><ul><li><p>需要事先约定调用的语义 – Interface</p></li><li><p>需要网络传输</p></li><li><p>需要定义网络传输的数据结构</p></li></ul><h3 id="什么是-gRPC">什么是 gRPC?</h3><p>gRPC 是主要由 google 开发的开源，免费的 基于 Protobuf 开发的跨语言的 RPC 框架，其特点主要有：</p><ol><li><p>使用 ProtoBuf 进行数据编码，从而提升了数据的压缩。ProtoBuf 是一种 Interface Description Language (IDL) 借口描述行语言。</p></li><li><p>使用 HTTP/2 带来诸如双向流、流控、头部压缩、单 TCP 连接上的多复用请求等特性传输协议，相比 HTTP 1.1 协议在移动设备上性能和空间占用上都有优化。</p></li><li><p>同时在调用方 (Stub/Client) 与服务端 (Server) 使用协议约定文件，可以通过增加 protobuf 结构，为版本兼容留下缓冲空间。</p></li></ol><h3 id="gRPC-基本组成">gRPC 基本组成</h3><p>下图为一个简单的调用模型</p><p><img src="https://jason24-zeng.github.io/img/grpc-and-protobuf/grpc_concept_diagram.jpeg" alt="grpc_model"></p><p>我们可以看到其主要的模块有：</p><ul><li><p>客户端 (gRPC Stub)，通过程序调用方法，发起 RPC 调用</p></li><li><p>对请求信息事先 pb 对象序列化</p></li><li><p>服务端 (gRPC Server) 接受请求 Proto Request，解码 (反序列化) 请求内容结构，进行相关业务逻辑处理，并返回 Proto Responses.</p></li><li><p>从服务端传会客户端，也需要进行对象序列化，从而压缩传递空间。</p></li><li><p>客户端接收服务端的 Response，对其进行解码 (反序列化)。唤醒正在等待响应的客户端调用并返回响应结果。</p></li></ul><h3 id="gRPC-的优势">gRPC 的优势</h3><ol><li><p>快速序列化，server 端和 stubs 端</p></li><li><p>序列化结构较小，从而需要传输的带宽小</p></li><li><p>基于 HTTP/2 协议进行设计，有显著的优势</p></li><li><p>相比于 JSON、XML，定义更简单明了。</p></li></ol><h3 id="gRPC-的缺点">gRPC 的缺点</h3><ol><li><p>Protobuf 序列化后的数据可读性查，无法想 HTTP/1.1 那样调试。</p></li><li><p>需要额外的组建协助浏览器调用 gRPC 服务，同时对浏览器的支持是有限的。</p></li><li><p>各大组建对 HTTP/2 的支持较差，即使支持，社区相关资料较少。</p></li></ol><h2 id="ProtoBuf">ProtoBuf</h2><h3 id="什么是-ProtoBuf">什么是 ProtoBuf ?</h3><p>Protocal Buffers (ProtoBuf) 是一种 IDL，具有可扩展的序列化结构化。它与平台，语言无关，常用于通信协议，数据存储等等。相比 JSON、XML 等结构，它更小、更快，收到广泛开发人员的青睐。</p><h3 id="ProtoBuf-基本语法">ProtoBuf 基本语法</h3><figure class="highlight protobuf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 声明使用 proto3 语法，如果不声明，默认使用 proto2 语法</span></span><br><span class="line">syntax = <span class="string">&quot;proto3&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> helloworld;</span><br><span class="line"></span><br><span class="line"><span class="comment">// RPC 服务定义</span></span><br><span class="line"><span class="class"><span class="keyword">service</span> <span class="title">Greeter</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 定义了一个 RPC 方法，叫做 SayHello，入参为 HelloRequest 结构体，出参为 HelloReply 结构体</span></span><br><span class="line">    <span class="function"><span class="keyword">rpc</span> SayHello (HelloRequest) <span class="keyword">returns</span> (HelloReply) </span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 消息体，</span></span><br><span class="line"><span class="class"><span class="keyword">message</span> <span class="title">HelloRequest</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 消息体中的字段，定义了字段类型，字段名称，以及 idx</span></span><br><span class="line">    <span class="built_in">string</span> name = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">message</span> <span class="title">HelloReply</span> </span>&#123;</span><br><span class="line">    <span class="built_in">string</span> <span class="class"><span class="keyword">message</span> = 1;</span></span><br><span class="line"><span class="class">&#125;</span></span><br></pre></td></tr></table></figure><p>proto 文件通常以 <code>.proto</code> 后缀结尾，通常进行编译并生成对应语言的 proto 文件。根据 Protobuf 编辑器选择的语言或者调用的插件情况的不同，生成相对应的 Service Interface Code 和 Stubs</p><h4 id="Proto-编译">Proto 编译</h4><p>前面已经提到，protobuf 支持多语言，而语言之间的切换实际是通过使用一个编译器的不同插件完成的。这个编译器就是 <code>protoc</code>，对 <code>.proto</code> 文件进行编译</p><h5 id="protoc-安装"><code>protoc</code> 安装</h5><p>为了安装 <code>protoc</code> ，我们依次执行以下安装 command</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/google/protobuf/releases/downloads/v3.11.2/protobuf-all-3.11.2.zip</span><br><span class="line">unzip protobuf-all-3.11.2.zip &amp;&amp; cd protobuf-3.11.2/</span><br><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure><p>安装完成后，可以通过执行 <code>protoc --version</code> 检查是否安装成功</p><h5 id="protoc-gen-go-插件安装"><code>protoc-gen-go</code> 插件安装</h5><p>假设我们已经完成了上面关于 <code>protoc</code> 编译器的安装，但是仅仅有这个编译器还是不够的。前面提到，针对不同的语言，我们需要调用不同的 <code>protoc</code> 插件，从而完成相关语言 <code>.proto</code> 文件的转换。</p><p>因此，我们主要执行以下命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> Instal a specific version.</span></span><br><span class="line">go install example.com/cmd@v1.2.3</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Install the highest available version.</span></span><br><span class="line">go install example.com/cmd@latest</span><br></pre></td></tr></table></figure><p>需要注意：<code>Go 1.17</code> 之后，使用 <code>go get</code> 去安装插件的方式不再被推荐，取而代之的是使用 <code>go install</code> 方法，因为这个原因，我刚开始使用</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">go</span> get -u google.golang.org/protobuf/cmd/protoc-gen-<span class="keyword">go</span></span><br></pre></td></tr></table></figure><p>会有下述错误</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">can&#x27;t load package: package google.golang.org/protobuf/cmd/protoc-gen-go: cannot find package &quot;google.golang.org/protobuf/cmd/protoc-gen-go&quot; in any of ...</span><br></pre></td></tr></table></figure><p>根据这个社区讨论  <a href="https://stackoverflow.com/questions/62190610/cannot-find-package-google-golang-org-protobuf-cmd-protoc-gen-go">cannot find package “google.golang.org/protobuf/cmd/protoc-gen-go”</a>，我们可以有一些其他的解决方法，但是，比较推荐的方式还是使用 <code>go install</code></p><p>在安装以后，还需要给 golang 添加路径（否则会出现报错：<a href="https://stackoverflow.com/questions/57700860/protoc-gen-go-program-not-found-or-is-not-executable">protoc-gen-go: program not found or is not executable</a>）：</p><ol><li><p>执行 <code>vim ~/.bash_profile</code></p></li><li><p>添加</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export GO_PATH=$HOME/go</span><br><span class="line">export PATH=$PATH:/$GO_PATH/bin</span><br></pre></td></tr></table></figure></li><li><p>执行 <code>source ~/.bash_profile</code></p></li></ol><p>另一种方法是直接将二进制文件目录 <code>bin</code> 移到默认路径上。不过这种方法需要当前执行者具有移到 local 路径的权限。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv ~/go/bin/protoc-gen-go /usr/local/go/bin</span><br></pre></td></tr></table></figure><h2 id="Reference-16">Reference</h2><ol><li><p><a href="https://golang2.eddycjy.com/posts/ch3/01-simple-grpc-protobuf/">Go 语言编程之旅</a></p></li><li><p><a href="https://zhuanlan.zhihu.com/p/148139089#:~:text=gRPC%E6%98%AF%E4%B8%80%E6%AC%BERPC,%E5%85%BC%E5%AE%B9%E7%95%99%E4%B8%8B%E7%BC%93%E5%86%B2%E7%A9%BA%E9%97%B4">gRPC系列(一) 什么是RPC？</a></p></li><li><p><a href="https://developers.google.com/protocol-buffers/docs/cpptutorial">Protocol Buffer Basics: C++</a></p></li></ol>]]></content>
      
      
      <categories>
          
          <category> gRPC </category>
          
      </categories>
      
      
        <tags>
            
            <tag> gRPC </tag>
            
            <tag> ProtoBuf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Effective C++ (III)</title>
      <link href="/2022/01/24/Effective-C-III/"/>
      <url>/2022/01/24/Effective-C-III/</url>
      
        <content type="html"><![CDATA[<p>资源是一种有借有还的“东西”，一旦使用它，就需要未来的某个时间段还给系统。而资源的形式多种多样，C++ 程序中最长使用的资源就是动态分配内存 (如果不归还，会导致内存泄漏)。除此以外，file descriptors，mutex locks，图形界面的字型和笔刷、数据库连接，网络 sokcet等，都是一种资源。</p><p>资源管理的手段还不充分，但是确保资源归还给系统很重要。而这篇博客中就主要讲解一些基于对象的资源管理办法，并加入一些专属条款弥补一般化条款的不足，从而保证管理内存的对象能适当并正确的进行。</p><h3 id="Item-13-使用对象管理资源"><a href="#Item-13-使用对象管理资源" class="headerlink" title="Item 13. 使用对象管理资源"></a>Item 13. 使用对象管理资源</h3><p><strong>use objects to manage resources</strong></p><p>首先，我们将资源放进对象内，就可以依赖 C++ 的析构函数自动调用机制确保资源被释放。</p><p>对于我们创造的一个对象（比如调用工厂函数动态分配一个对象），我们可能因为跳过释放对象语句过早退出而形成了内存泄漏。这种过早退出的可能有：</p><ul><li><p>一个过早的 <code>return/continue/goto</code> 语句</p></li><li><p>抛出异常</p></li></ul><p>无论是那种情况，都不是单纯通过判断 “总是执行 delete 语句” 能够解决的。因为代码可能被增加，但是人们可能无法注意到后面的 delete 语句。</p><p>许多资源被动态分配到 heap 后，被用在一个单一区域或函数内，这些资源应该在控制流离开区域时就被释放。标准库中提供的智能指针 auto_ptr 正是针对这种形式设计的。它是一种 “pointer-like object” 类指针现象。其<strong>析构函数自动对其所指对象调用 delete</strong>。比如下面的例子，我们调用了 <code>auto_ptr</code> 创造对象后就不用再自己释放对象对应资源了。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">f</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">std::auto_ptr&lt;Investment&gt; <span class="title">pInv</span><span class="params">(createInvestment())</span></span>;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 其中</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Investment</span>&#123;</span>...&#125;;</span><br><span class="line"><span class="function">Investment* <span class="title">createInvestment</span><span class="params">()</span></span>; <span class="comment">// 通过共产函数供应某特定的 Investment 对象</span></span><br></pre></td></tr></table></figure><p>这显示了本节的两个关键想法：</p><ol><li><p>获取到资源后立即放进管理对象中。RAII: Resource Acquistion Is Initialization</p></li><li><p>管理对象运用析构函数确保资源的释放。</p></li></ol><p>注意，一定不要让多个 <code>auto_ptr</code> 指向同一个对象，因为每个 <code>auto_ptr</code> 被销毁时都会自动删除它所指的对象。为了避免这个问题，如果通过 copy constructor 或者 copy assignment 去复制<code>auto_ptr</code>，被复制的 <code>auto_ptr</code> 会变成 null，而复制后的 <code>auto_ptr</code> 拥有取得资源的唯一权。比如下例：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">std::auto_ptr&lt;Investment&gt; <span class="title">pInv1</span><span class="params">(createInvestment())</span></span>;  <span class="comment">// pInv1 is not null</span></span><br><span class="line"></span><br><span class="line"><span class="function">std::auto_ptr&lt;Investment&gt; <span class="title">pInv2</span><span class="params">(pInv1)</span></span>; <span class="comment">// pInv1 is null, while pInv2 is not null</span></span><br><span class="line"></span><br><span class="line">pInv1 = pInv2;  <span class="comment">// pInv1 is not null, while pInv2 is null</span></span><br></pre></td></tr></table></figure><p>因为 <code>auto_ptr</code> 的这个性质，使其无法成为管理动态分配资源的好工具。如果 STL 容器要求能有正常的复制行为，则不能使用 <code>auto_ptr</code>。</p><p>其替代方法是大家都应该比较了解的「引用计数型智能指针」(reference-counting smart pointer; RCSP)。它表示的是，该指针会追踪有多少对象指向了该资源，如果 counting 为 0 则会自动删除该资源。</p><p>这种方法依然会有一定的问题，主要问题出现在 cycle of references 环状引用上：即两个对象彼此互指，及时已经没有使用这两个对象了，依然因为 counting  不为 0 而不被销毁。</p><p><code>shared_ptr</code> 就是这样一个 RCSP。</p><h3 id="Item-14-资源管理类中的-copying-行为需要慎重考虑"><a href="#Item-14-资源管理类中的-copying-行为需要慎重考虑" class="headerlink" title="Item 14. 资源管理类中的 copying 行为需要慎重考虑"></a>Item 14. 资源管理类中的 copying 行为需要慎重考虑</h3><p><strong>Think carefully about copying behavior in resource-managing classes</strong></p><p>上一节描述了 RAII 在资源管理中的重要意义，同时描述了智能指针如何将这些观念运用到 heap-based 的资源上。但需要注意，不是所有资源都是 heap-based，而智能指针不适合作为 resource handlers。我们对于这种情况，可能需要建立自己的资源管理类。</p><p>这一章节需要记住：</p><ul><li><p>在 Copy RAII 对象时必须一并复制它管理的资源，因此资源的 copying 行为会决定 RAII 对象的 copying 行为。</p></li><li><p>普遍常见的 RAII 类拷贝行为有：阻止 copying，使用引用计数法。也可能有其他实现行为。</p></li></ul><h3 id="Item-15-资源管理类中提供原始资源访问"><a href="#Item-15-资源管理类中提供原始资源访问" class="headerlink" title="Item 15. 资源管理类中提供原始资源访问"></a>Item 15. 资源管理类中提供原始资源访问</h3><p><strong>provide access to raw resources in resource-managing classes</strong></p><p>我们要善用资源管理类来处理和资源之间的所有互动，而非直接处理原始资源。但是许多 APIs 都直接引用资源，这使我们只能直接绕过资源管理对象直接访问原始资源。</p><p>在实际操作中，如果我们需要一个函数可将 RAII class 对象转换成其所内含的原始对象，有两种方式可以达成目标：显式 casting 或者 隐式 casting。是否该提供一个显式转换函数（比如 get 成员函数）还是提供隐式转换，主要取决于 RAII 被设计执行的特定工作，以及它被使用的情况。最佳的设计是需要坚持 Item 18 的忠告：让接口容易被正确使用，不易被误用。做开始时需要做的就是隐藏客户不需要看的部分，但准备好客户需要的所有东西。</p><p>这一章节，需要记住：</p><ul><li><p>APIs 通常要求访问原始资源，所以每个 RAII class 都应该提供一个 ”取得所管理资源“ 的方法。</p></li><li><p>对原始资源的访问可以有显式转换，也可以是隐式转换。通常，显式转换更加安全，但隐式转换对客户更加方便。</p></li></ul><h4 id="Item-16-使用相应的-new-和-delete-操作时要采用相同的形式"><a href="#Item-16-使用相应的-new-和-delete-操作时要采用相同的形式" class="headerlink" title="Item 16. 使用相应的 new 和 delete 操作时要采用相同的形式"></a>Item 16. 使用相应的 new 和 delete 操作时要采用相同的形式</h4><p>一开始，文中举了个例子：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">std::string* stringArray = <span class="keyword">new</span> std::string[<span class="number">100</span>];</span><br><span class="line">...</span><br><span class="line"><span class="keyword">delete</span> stringArray;</span><br></pre></td></tr></table></figure><p>看起来没毛病，但 <code>stringArray</code> 中所含的 100 个 <code>string</code> 对象中 99 个不太可能被适当得删除，因为它们的析构函数很可能没被调用。</p><p>当使用 <code>new</code> 时，有两件事发生</p><ol><li><p>内存通过 <code>operator new</code> 的函数被分配出来</p></li><li><p>针对这个内存，一个（或多个）构造函数被调用。</p></li></ol><p>而当使用 <code>delete</code> 时，也有两件事发生</p><ol><li><p>针对这个内存会有一个（或多个）构造函数被调用</p></li><li><p>内存通过 <code>operator delete</code> 的函数被释放</p></li></ol><p>上面的问题在于，被删除的内存之内存在多少对象？这个问题决定了多少个析构函数必须被调用。数组所用的内存通常还包括 ”数组大小“ 的记录，从而方便 <code>delete</code> 调用析构函数的次数。</p><p>当我们对一个指针使用 <code>delete</code>，唯一能让其知道 ”数组大小的方式“ 就是显式得告诉它。如果 <code>delete</code> 时加上方括号，则表明指针指向的是数组，否则认为其指向单一对象。因此我们需要如下得匹配删除相应的对象</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">std::string* stringPtr1 = <span class="keyword">new</span> std::string;</span><br><span class="line">std::string* stringPtr2 = <span class="keyword">new</span> std::string[<span class="number">100</span>];</span><br><span class="line">...</span><br><span class="line"><span class="keyword">delete</span> stringPtr1;</span><br><span class="line"><span class="keyword">delete</span> [] stringPtr2;  <span class="comment">// 删除一个由对象组成的数组</span></span><br></pre></td></tr></table></figure><p>当程序员以 <code>new</code> 创建 <code>typedef</code> 类型对象时， <code>typedef</code> 的作者必须说清该以哪种 <code>delete</code> 形式删除它。而为了避免 <code>typedef</code> 数组类型带来的不清楚使用哪个 <code>delete</code> 函数的问题，我们最好不要对数组形式做 <code>typedef</code> 动作。</p><h3 id="Item-17-用独立语句将新建-newed-对象存储进智能指针"><a href="#Item-17-用独立语句将新建-newed-对象存储进智能指针" class="headerlink" title="Item 17. 用独立语句将新建 (newed) 对象存储进智能指针"></a>Item 17. 用独立语句将新建 (newed) 对象存储进智能指针</h3><p><strong>Storing newd objects in smart pointers in standalone statements</strong></p><p>不要写如下的函数：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">processWidget</span>(std::shared_ptr&lt;Widget&gt;(<span class="keyword">new</span> Widget), <span class="built_in">priority</span>())</span><br></pre></td></tr></table></figure><p>因为这个函数在执行之前需要执行三个步骤:</p><ol><li><p><code>new Widget</code></p></li><li><p><code>priority()</code></p></li><li><p><code>call shared_ptr function</code></p></li></ol><p>其中 <code>priority()</code> 这个函数的调用次序不固定。我们假定函数当前遵循上述调用步骤，如果<code>priority()</code> 抛出异常，我们就碰到了 Item 13 中谈到的问题，<code>new Widget</code> 对象因为没有使用 <code>shared_ptr</code> 函数调用而无法自行销毁，这样便容易造成内存泄漏。</p><p>正确的做法是，使用独立语句新建对象，然后将智能指针传给函数：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">std::shared_ptr&lt;Widget&gt;  <span class="title">pw</span><span class="params">(<span class="keyword">new</span> Widget)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">processWidget</span>(pw, <span class="built_in">priority</span>());</span><br></pre></td></tr></table></figure><p>这样，我们就保证了执行秩序，从而避免了一些内存泄漏问题的发生，或者说避免了分开 <code>new Widget</code> 与 <code>call shared_ptr function</code> 的动作。</p>]]></content>
      
      
      <categories>
          
          <category> Coding Language </category>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
            <tag> 书籍笔记 </tag>
            
            <tag> Resource Management </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Effective C++ (II)</title>
      <link href="/2022/01/23/Effective-C-II/"/>
      <url>/2022/01/23/Effective-C-II/</url>
      
        <content type="html"><![CDATA[<h4 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h4><p>一个月前，因为工作调 动原因，有了充分的时间去拜读 C++ 相关书籍，于是决心从 <em>effetive C++</em> 开始，通过简单得学习了前 8 个条款，感觉自己茅塞顿开，发现自己之前工作中的许多不愉快都源于自己的代码习惯不够好。希望自己能在入职前，将这本工程师必读之作整体拜读一次，并以博客代替日记的方式记录下来，以备未来回顾。</p><h4 id="Item-09-不要再构造函数与析构函数中调用虚函数"><a href="#Item-09-不要再构造函数与析构函数中调用虚函数" class="headerlink" title="Item 09. 不要再构造函数与析构函数中调用虚函数"></a>Item 09. 不要再构造函数与析构函数中调用虚函数</h4><p><strong>Never call virtual functions during construction or destruction</strong></p><p>使用 C++ 时，不要在这两个函数中调用 virtual 函数，否则可能会得到预想以外的结果。这时 C++ 与 Java 或 C# 的区别。</p><p>下面有一个看似合理，实则反直观的例子，来解释这种行为的不合理性：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 构建一个 base class, 创建交易对象，同时调用函数记录日志</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Transaction</span> &#123;</span></span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Transaction</span>();</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">logTransaction</span><span class="params">()</span> <span class="keyword">const</span> </span>= <span class="number">0</span>;    <span class="comment">// base 中的日志记录接口</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Transaction::<span class="built_in">Transaction</span>() &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="built_in">logTransaction</span>();                        <span class="comment">// base 构造函数中调用 virtual 函数</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BuyTransaction</span> :</span> <span class="keyword">public</span> Transaction &#123;</span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">logTransaction</span><span class="params">()</span> <span class="keyword">const</span></span>;    <span class="comment">// 继承类 BuyTransaction 内定义的日记函数</span></span><br><span class="line">    ...</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SellTransaction</span> :</span> <span class="keyword">public</span> Transaction &#123;</span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">logTransaction</span><span class="params">()</span> <span class="keyword">const</span></span>;    <span class="comment">// 继承类 SellTransaction 内定义的日记函数</span></span><br><span class="line">    ...                                </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这上面的函数继承构造看似合理，但如果我们初始化一个 <code>BuyTransaction</code> 对象，就会发现问题了。初始化构造继承类对象时，基类对象的成分会首先构造妥当，这个行为发生在继承类单独成分构造之前。而基类 <code>Transaction</code> 构造时会调用 <code>logTransaction</code> 函数，且被调用的是 <code>Transaction</code> 中的版本，而非 <code>BuyTransaction</code> 中的版本。导致我们如上初始化的 <code>BuyTransaction</code> 对象表现与基类一样。也就这样理解，在 base class 构造期间，virtual 函数并非 virtual 函数。</p><p>而这种先完全构造好 base class 的行为也是合理的：如果基类初始化时调用了继承类的成员，而这些成员未初始化，则大大增加了不确定性。</p><p>唯一能避免上面的情况的做法就是，确定我们构造函数与析构函数都没有调用 virtual 函数，且它们调用的所有函数也服从这一约束—不调用 virtual 函数。</p><p>那上面这个问题怎么解决呢？也就是如何保证对象创建时能有正确版本的 <code>logTransaction</code> 函数被调用？</p><p>一种做法是，虽然我们没办法把使用 <code>virtual</code> 函数从基类向下调用，但是可以<em>让继承类向上传递足够信息给基类构造函数</em></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Transaction</span> &#123;</span></span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">Transaction</span><span class="params">(<span class="keyword">const</span> std::string&amp; logInfo)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">logTransaction</span><span class="params">(<span class="keyword">const</span> std::string&amp; logInfo)</span> <span class="keyword">const</span></span>; <span class="comment">// non-virtual</span></span><br><span class="line">    ...</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Transaction::<span class="built_in">Transaction</span>(<span class="keyword">const</span> std::string&amp; logInfo) &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="built_in">logTransaction</span>(logInfo);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BuyTransaction</span>:</span> <span class="keyword">public</span> Transaction &#123;</span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">BuyTransaction</span>(parameters) : <span class="built_in">Transaction</span>(<span class="built_in">createLogString</span>(parameters)) </span><br><span class="line">    &#123;...&#125;    \\ 将 log 信息传给基类构造函数</span><br><span class="line">  <span class="keyword">private</span>:</span><br><span class="line">    <span class="function"><span class="keyword">static</span> std::string <span class="title">createLogString</span><span class="params">(parameter)</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>注意到<code>private static</code> 的用法。比起使用成员初值列 (member initialization list) 的基类初始化方法，利用辅助函数传递值给基类的方法更方便。且此函数为 <code>static</code>，就保证了在基类初始化时指向的继承类成员变量是已经初始化好了的。</p><h4 id="Item-10-令赋值操作符返回一个-this-的引用"><a href="#Item-10-令赋值操作符返回一个-this-的引用" class="headerlink" title="Item 10. 令赋值操作符返回一个 *this 的引用"></a>Item 10. 令赋值操作符返回一个 *this 的引用</h4><p><strong>Have assignment operators return a reference to *this</strong></p><p>在赋值时，对于所有内置类型以及 STL 库中提供的类型如 <code>string</code>, <code>vector</code>,<code>complex</code>, <code>tr1::shared_ptr</code>等，我们发现 C++   可以满足连续赋值的形式，比如 </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> x, y, z;</span><br><span class="line">x = y = z = <span class="number">15</span>;</span><br></pre></td></tr></table></figure><p>为了实现这样的连续赋值，赋值操作符需要返回一个指向操作符左边实参的引用，这时一个我们在为 classes 实现赋值操作时应该遵守的协议：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Widget</span> &#123;</span></span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    ...</span><br><span class="line">    Widget&amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> Widget&amp; rhs) &#123;</span><br><span class="line">    <span class="comment">// 返回指向当前对象的引用</span></span><br><span class="line">        ...</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 不仅标准赋值形式适用，还适用于所有赋值相关运算</span></span><br><span class="line">    Widget&amp; <span class="keyword">operator</span>+=(<span class="keyword">const</span> Widget&amp; rhs) &#123;</span><br><span class="line">        ...</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>注意，这个协议不是强制的，因此，即使不遵守，在编译时也能通过，但是因为几乎所有标准类型都遵守这个协议，所以建议在自己定义的时候也遵守。</p><h4 id="Item-11-在-operator-操作符里面处理自赋值"><a href="#Item-11-在-operator-操作符里面处理自赋值" class="headerlink" title="Item 11. 在 operator= 操作符里面处理自赋值"></a>Item 11. 在 <code>operator=</code> 操作符里面处理自赋值</h4><p><strong>Handle assignment to self in operator=</strong></p><p>自赋值，或者自我赋值，是指对象被赋值给自己，典型的场景有如下几个：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 声明一个对象，赋值给自己</span></span><br><span class="line">Widget w;</span><br><span class="line">...</span><br><span class="line">w = w;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 当 i = j 时，自我赋值</span></span><br><span class="line">a[i] = a[j];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 当 px 与 py 指向同一个东西</span></span><br><span class="line">*px = *py;</span><br></pre></td></tr></table></figure><p>这些不明显的自赋值现象，都是 alias 别名带来的结果。一般来说，如果某段代码操作指针或者引用，而它们又被用来”指向多个想同类型的对象”时，就可能出现指向同一个对象的情况。</p><h5 id="自赋值陷阱例子"><a href="#自赋值陷阱例子" class="headerlink" title="自赋值陷阱例子"></a>自赋值陷阱例子</h5><p>如果遵循后面要提到的 Item 13 与 Item 14，我们会运用对象来管理资源，且可以确定资源管理对象在 copy 发生时有正确的行为。此时，赋值操作符自赋值也许是安全的。但是，如果尝试自行管理资源（写一个用于资源管理的 class 时），我们就可能掉进在停止使用资源之前意外释放资源的情况。文中举了一个这样的例子，我们建立一个 class 来保存一个指针，该指针指向一块动态分配的 bitmap：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bitmap</span> &#123;</span>...&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Widget</span> &#123;</span></span><br><span class="line">    ...</span><br><span class="line">  <span class="keyword">private</span>:</span><br><span class="line">    Bitmap* pb;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>我们需要实现一个 <code>operator=</code>赋值操作符，去更新位图 </p><h5 id="Version-1"><a href="#Version-1" class="headerlink" title="Version 1"></a>Version 1</h5><p>最初始的版本，貌似合理，但是如果 *this 和 rhs 是同一个对象，则可能出现问题</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Widget&amp; Widget::<span class="keyword">operator</span>=(<span class="keyword">const</span> Widget&amp; rhs) &#123;</span><br><span class="line">    <span class="keyword">delete</span> pb;</span><br><span class="line">    pb = <span class="keyword">new</span> <span class="built_in">Bitmap</span>(*rhs.pb); <span class="comment">// 可能会因为自赋值而报错</span></span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="Version-2"><a href="#Version-2" class="headerlink" title="Version 2"></a>Version 2</h5><p>修改版本，先判断是否自赋值，再执行。这个保证了自我赋值是安全的，但是如果 <code>new Bitmap</code> 导致异常，会产生一个指向被删除 <code>Bitmap</code> 的指针，我们无法安全删除，也无法安全读取，因此这一版本的 <code>operator=</code> 不具备异常安全性。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Widget&amp; Widget::<span class="keyword">operator</span>=(<span class="keyword">const</span> Widget&amp; rhs) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span> == &amp;rhs) <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">delete</span> pb;</span><br><span class="line">    pb = <span class="keyword">new</span> <span class="built_in">Bitmap</span>(*rhs.pb); <span class="comment">// 可能会因为自赋值而报错</span></span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h5 id="Version-3"><a href="#Version-3" class="headerlink" title="Version 3"></a>Version 3</h5><p>把焦点放在异常安全性上，因为当 <code>operator=</code> 具备异常安全性时，它自然就具备了自赋值安全性。如下</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Widget&amp; Widget::<span class="keyword">operator</span>=(<span class="keyword">const</span> Widget&amp; rhs) &#123;</span><br><span class="line">    Bitmap* pOrig = pb;</span><br><span class="line">    pb = <span class="keyword">new</span> <span class="built_in">Bitmap</span>(*rhs.pb); <span class="comment">// copy assignment;</span></span><br><span class="line">    <span class="keyword">delete</span> pOrig;</span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>需要注意，自赋值的时候，依然需要复制一份原来的值，可能不高效。可以考虑使用 Version 2 的方法加入一个 identity test，但需要考察是否有必要，比如这种自赋值出现的频率是否能 cover 住新增控制流分支与代码的效率降低。</p><h5 id="Version-4"><a href="#Version-4" class="headerlink" title="Version 4"></a>Version 4</h5><p>采用 copy and swap 技术，这个技术在 pb 文件的赋值操作中经常用到。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Widget</span> &#123;</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(Widget&amp; rhs)</span></span>;     <span class="comment">// 交换 *this 和 rhs 数据</span></span><br><span class="line">    ...</span><br><span class="line">&#125;;</span><br><span class="line">Widget&amp; Widget::<span class="keyword">operator</span>=(<span class="keyword">const</span> Widget&amp; rhs) &#123;</span><br><span class="line">    Widget <span class="built_in">temp</span>(rhs);</span><br><span class="line">    <span class="built_in">swap</span>(temp);</span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// or </span></span><br><span class="line">Widget&amp; Widget::<span class="keyword">operator</span>=(<span class="keyword">const</span> Widget rhs) &#123;</span><br><span class="line">    <span class="built_in">swap</span>(rhs);</span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 损失了函数的清晰性。</span></span><br></pre></td></tr></table></figure><h4 id="Item-12-复制对象的每一个成分"><a href="#Item-12-复制对象的每一个成分" class="headerlink" title="Item 12. 复制对象的每一个成分"></a>Item 12. 复制对象的每一个成分</h4><p><strong>Copy all parts of an object</strong></p><p>当我们不用编辑器默认生成的 copying 函数，而自己声明 copying 函数时，即使这个 copying 函数有明显的错误，比如少引入了对象的一部分 private 成员变量时，编辑器依然不会报错。所以，如果我们在 class 中添加一个成员变量，我们必须同时修改 copying 函数。我们需要修改所有构造函数，以及任何非标准形式的 <code>operator=</code>。</p><p>一旦还有继承类，这种潜在的危机就更不容易被察觉。有些继承类，其 copy 构造函数看似copy 了类里所有声明的变量，但是因为没有制定实参传给基类构造函数，所以基类成分会被不带实参的基类 default 构造函数初始化。copy assignment 操作符的整体流程同上。</p><p>在任何时候只要我们为继承类编写 copying 函数，我们就必须小心赋值其基类成分。需要注意这些成分是 private 的，所以无法直接访问它们，而应该用继承类的 copying 函数调用相应的基类函数。</p><p>综上，当我们需要编写一个 copying 函数时，我们需要保证</p><ol><li><p>复制所有的 local 成员变量</p></li><li><p>调用所有基类适当的 copying 函数</p></li></ol><p>需要注意的是，令 copy 赋值操作符调用 copy 构造函数是不合理的，这时在构造一个存在的对象。同样，让 copy 构造函数调用 copy 赋值操作符，同样无意义，我们无法对一个为构造好的对象赋值。</p><p>如果 copy 构造函数和 copy assignment 操作符有相近的代码，最好的处理方式是建立一个成员函数供两者调用，这个函数往往是 private 且常被命名为 <code>init</code>。（是不是很熟悉？）</p>]]></content>
      
      
      <categories>
          
          <category> Coding Language </category>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
            <tag> 书籍笔记 </tag>
            
            <tag> 构造 </tag>
            
            <tag> 析构 </tag>
            
            <tag> 赋值 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Alias Table Sampling</title>
      <link href="/2022/01/23/alias-table-sampling/"/>
      <url>/2022/01/23/alias-table-sampling/</url>
      
        <content type="html"><![CDATA[<h3 id="离散按概率随机抽样算法-Alias-method">离散按概率随机抽样算法 - Alias method</h3><p>因为最近学习图嵌入 graph embedding 的相关操作与算法，发现无论在使用 deepwalk, LINE, node2vec 还是 SDNE 等图嵌入方法时，随机游走选择下一个节点都会用到一种按概率采样的方法，也就是 Alias 方法。第一次学习到这个算法，是在转专业刷知乎是看到的，想来也是很奇妙，果然有些优秀的算法容易被人提起并记住。这种方法因为其 $O(1)$ 的时间复杂度，大幅加速了候选集的生成。接下来的章节将主要讲解一些相关的随机抽样算法，最后再讲到 Alias method。</p><h4 id="问题阐述">问题阐述</h4><p>假设候选集为 $M$ 个事件，用 $1, … ,m$ 对这些时间编号。这些事件互斥，发生的概率为 $p_i, i = 1, …, m$，满足 $\sum^m_{i = 1} p_i = 1$。问，如何产生一个事件发生器，根据发生概率去产生事件呢？</p><h4 id="Solution-1：preSum-方法">Solution 1：preSum 方法</h4><p>步骤：</p><ul><li><p>通过数组 $p_i$ 依照前缀和方法生成 prefix Sum 数组 <code>presum</code>。亦将概率密度函数&quot;积分&quot;成概率分布函数</p></li><li><p>产生 0 - 1 的随机数，判断随机数处于哪个概率区间，返回对应的事件。</p></li></ul><p>复杂度分析：</p><ul><li><p>时间复杂度: 产生 <code>presum</code> 数组 $O(n)$，返回随机事件使用二分法 $(O(logn))$</p></li><li><p>空间复杂度：维护 <code>presum</code> 数组 $O(n)$</p></li></ul><p>代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">preSum_method</span> &#123;</span></span><br><span class="line">  <span class="keyword">private</span>:</span><br><span class="line">    vector&lt;<span class="keyword">float</span>&gt; presum;</span><br><span class="line">    std::random_device rd;</span><br><span class="line">    <span class="function">std::default_random_engine <span class="title">eng</span><span class="params">(rd())</span></span>;</span><br><span class="line">    <span class="function">std::uniform_real_distribution&lt;<span class="keyword">float</span>&gt; <span class="title">distr</span><span class="params">(FLOAT_MIN, FLOAT_MAX)</span></span>;</span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">preSum_method</span>(vector&lt;<span class="keyword">float</span>&gt;&amp; prob) &#123;</span><br><span class="line">        presum.<span class="built_in">reserve</span>(prob.<span class="built_in">size</span>() + <span class="number">1</span>, <span class="number">0.0f</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i != prob.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            presum[i + <span class="number">1</span>] = presum[i] + prob[i];    </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">generate_case</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> left = <span class="number">0</span>, right = presum.<span class="built_in">size</span>() - <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">float</span> random_num = <span class="built_in">distri</span>(eng);</span><br><span class="line">        <span class="keyword">while</span> (left &lt;= right) &#123;</span><br><span class="line">            <span class="keyword">int</span> mid = left + (right - left) / <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span> (random_num &lt; nums[mid + <span class="number">1</span>] &amp;&amp; random_num &gt;= nums[mid]) <span class="keyword">return</span> mid;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (random_num &gt;= nums[mid + <span class="number">1</span>]) left = mid + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> right = mid;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="Solution-2-预设候选集法">Solution 2 : 预设候选集法</h4><p>步骤，</p><ul><li><p>根据概率生成一个很大的候选集</p></li><li><p>通过随机数的值返回对应候选集位置的事件</p></li></ul><p>复杂度分析：</p><ul><li><p>产出候选集的时间复杂度 $O(N)$，$N$ 与精度有关，返回随机事件 $O(1)$</p></li><li><p>空间复杂度 $O(N)$</p></li></ul><p>代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CandidateSet</span> &#123;</span></span><br><span class="line">  <span class="keyword">private</span>:</span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt; candidate_set;</span><br><span class="line">    <span class="keyword">int</span> P;</span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">CandidateSet</span>(vector&lt;<span class="keyword">float</span>&gt;&amp; prob, <span class="keyword">int</span> precision) &#123;</span><br><span class="line">        P = <span class="number">10</span> ** precision;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i != prob.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">temp</span><span class="params">(i, (<span class="keyword">int</span>) (i * P))</span></span>;</span><br><span class="line">            std::<span class="built_in">copy</span>(temp.<span class="built_in">begin</span>(), temp.<span class="built_in">end</span>(), std::<span class="built_in">back_insert</span>(candidate_set));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">generate_case</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> random_number = <span class="built_in">rand</span>() % P;</span><br><span class="line">        <span class="keyword">return</span> candidate_set[random_number];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>这种方法主要的弊端在于需要申请很大一块连续空间来存储候选集。</p><h4 id="Solution-3-Alias-Method">Solution 3 : Alias Method</h4><p>本文的重点。主要的创新点在于建表环节。我们考虑到等概率抽样的时间复杂度为 $O(1)$，而对二项分布的时间进行抽样的时间复杂度也是 $O(1)$。因此，整个时间的思路变成了如何把依概率抽样的时间转变为等概率抽样。</p><p>alias method 考虑维护一个 alias 表，里面有 $M$(事件个数) 个值得数组，对数组中的每个元素，是一个二项分布参数的三元组<code>prob, lower_event, higher_event</code>。通过等概率选取数组的元素，再依概率选择二元事件，我们就可以完成依概率对多元事件的抽样。</p><p>步骤：</p><ul><li><p>制表。两张表：</p><ul><li><p>等概率表，大小为 $M$</p></li><li><p>维护两个队列，small, large 分别存放小于 1 和 大于 1 的时间下标</p></li><li><p>每次从 small，large 中各取一个，用 large 里的值填补 small 的，使 small 的整体概率等于 1，然后根据 large 剩余的整体概率，将元素重新放回 large 或 small 中。</p></li><li><p>所有的概率都等于 1</p></li></ul></li><li><p>采样</p></li></ul><p>代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AliasMethod</span> &#123;</span></span><br><span class="line">  <span class="keyword">private</span>:</span><br><span class="line">    vector&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt; alias_method;</span><br><span class="line">    <span class="keyword">int</span> multiplier;</span><br><span class="line">    std::random_device rd;</span><br><span class="line">    <span class="function">std::default_random_engine <span class="title">eng</span><span class="params">(rd())</span></span>;</span><br><span class="line">    <span class="function">std::uniform_real_distribution&lt;<span class="keyword">float</span>&gt; <span class="title">distr</span><span class="params">(FLOAT_MIN, FLOAT_MAX)</span></span>;</span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">CandidateSet</span>(vector&lt;<span class="keyword">float</span>&gt;&amp; prob, <span class="keyword">int</span> precision) &#123;</span><br><span class="line">        std::queue&lt;<span class="keyword">int</span>&gt; large, small;</span><br><span class="line">        multiplier = prob.<span class="built_in">size</span>();</span><br><span class="line">        alias_method.<span class="built_in">reserve</span>(multiplier);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i != multiplier; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> new_prob = prob[i] * multiplier;</span><br><span class="line">            <span class="keyword">if</span> (new_prob &lt; <span class="number">1</span>) &#123;</span><br><span class="line">                small.<span class="built_in">push</span>(i);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (new_prob &gt; <span class="number">1</span>) &#123;</span><br><span class="line">                large.<span class="built_in">push</span>(i)</span><br><span class="line">            &#125;</span><br><span class="line">            alias_method[i] = new_prob == <span class="number">1</span> ? &#123;new_prob, i&#125; : &#123;new_prob, <span class="number">-1</span>&#125;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (!large.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="keyword">int</span> large_pos = large.<span class="built_in">front</span>();</span><br><span class="line">            <span class="keyword">int</span> small_pos = small.<span class="built_in">front</span>();</span><br><span class="line">            <span class="keyword">auto</span>&amp; l = alias_method[large_pos];</span><br><span class="line">            large.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">auto</span>&amp; s = alias_method[small_pos];</span><br><span class="line">            small.<span class="built_in">pop</span>();</span><br><span class="line">            l.first -= s.first;</span><br><span class="line">            s.second = large_pos;</span><br><span class="line">            <span class="keyword">if</span> (l.first &lt; <span class="number">1</span>) small.<span class="built_in">push</span>(large_pos);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (l.first &gt; <span class="number">1</span>) large.<span class="built_in">push</span>(large_pos);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">generate_case</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> random_case = <span class="built_in">rand</span>() % multiplier;</span><br><span class="line">        <span class="keyword">float</span> random_num = <span class="built_in">distri</span>(eng);</span><br><span class="line">        <span class="keyword">auto</span>&amp; temp = alias_method[random_case];</span><br><span class="line">        <span class="keyword">return</span> temp.first &lt;= random_num ? random_case : temp.second;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Algorithm </category>
          
          <category> Probability </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Algorithm </tag>
            
            <tag> Probability </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Embedding Introduction (VI)</title>
      <link href="/2022/01/22/Embedding-Introduction-VI/"/>
      <url>/2022/01/22/Embedding-Introduction-VI/</url>
      
        <content type="html"><![CDATA[<h4 id="SDNE-Structural-Deep-Network-Embedding">SDNE : Structural Deep Network Embedding</h4><p>DeepWalk, LINE, Node2vec 这几个 Graph Embedding  的方法，在训练 Embedding 的时候使用的都是 skip-gram 的模型结构。这个模型结构只有一层隐藏层，很难学到一些高阶非线性的特征。而 SDNE 为了表达高阶非线性，引入了更深的网络结构。</p><h4 id="训练网络结构">训练网络结构</h4><p>SDNE 使用的训练框架是一种半监督式的深度模型训练框架。其整体的网络结构如下：</p><p><img src="https://jason24-zeng.github.io/img/Embedding-Introduction-VI/SDNE_top.png" alt="SDNE_framework"></p><p>首先搞清楚一边的深层网络结构 ： Autoencoder</p><h5 id="Autoencoder-for-second-order-proximity">Autoencoder for second-order proximity</h5><p><img src="https://jason24-zeng.github.io/img/Embedding-Introduction-VI/autoencoder.png" alt="SDNE_autoencoder"></p><p>如上图，为一个 autoencoder 的基本结构。我们自下往上的看。</p><p>输入层 $x_i \in R^{|V|}$ ， $|V|$ 为所有节点的数量。如果 $(i, j)$ 边存在，则 $x_{ij} &gt; 0$，可以理解为 $x_{ij} = w_{ij}$ 为 edge $(i,j)$ 的边权，否则，$x_{ij} = 0$。</p><p>紫色部分是 encoder，是将稀疏向量 $x_i$ 降维，使之稠密的过程。</p><p>中间蓝色部分就是每个顶点 $i$ 对应的输出 embedding $y_i^{(K)}$ 。</p><p>深蓝色部分则是 decoder，可以认为是紫色部分的 revert，升维，使之稀疏，最终输出向量 $\hat{x_i}$。</p><p>整个 autoencoder 的过程是无监督的。在迭代过程中，我们需要计算输入向量 $x_i$ 与向量 $\hat{x_i}$ 的 loss，认为是二阶近邻关系的目标函数表达。</p><p>这个 loss 表示为：</p><p>$$<br>\begin{aligned}<br>\mathcal{L}_{2nd} &amp;=  \sum^n_i |(\mathbf{\hat{x}}_i - \mathbf{x}_i) \bigodot  \mathbf{b}_i|^2_2  \\<br>&amp;= |(\hat{X}_i - X_i) \bigodot  B |^2_F<br>\end{aligned}<br>$$</p><p>其中 $\bigodot$ 表达 Hadamard 乘积，即按位置相乘之和。如果 $s_{i,j} = 0$，则 $b_{i,j} = 1$。否则 $b_{i,j} = \beta &gt; 1$。因此，通过将临接矩阵 $S$作为输入，使用修改的深层 autoencoder，有相似邻居结构的顶点会在表达空间 embedding 中靠近。</p><h5 id="Supervised-component-for-first-order-proximity">Supervised component for first-order proximity</h5><p>除了 global 的网络结构，我们也需要抓住局部结构，这里的局部结构在文中专指 first-order proximity。损失函数可从网络图中得到：</p><p>$$<br>\begin{aligned}<br>\mathcal{L}_{1st} &amp;= \sum^n_{i,j = 1} s_{i,j}|y^{K}_i - y^{K}_j|^2_2\\<br>&amp;= \sum^n_{i,j = 1} s_{i,j}|y_i - y_j|^2_2<br>\end{aligned}<br>$$</p><p>(这里出现 markdown 与 mathjax 对 _ 的转义出现冲突，导致数学公式显示有问题。需要再 _ 前加下划线解决。)</p><p>这个损失函数表征的是，如果两个节点相连，则存在一定的相似性，如果权重越大，相似性越高。公式中的 $y$ 表示自编码器的中间层输出。</p><h5 id="整个模型损失函数">整个模型损失函数</h5><p>整个模型的损失函数结合了一阶和二阶 proximity 相关的目标函数，同时引入了一个正则项：</p><p>$$<br>\mathcal{L}_{reg} = \frac{1}{2}\sum^K_{k = 1}(|W^{(k)} |^2_F + |\hat{W}^{(k)} |^2_F)<br>$$</p><p>其中 $W^{(k)}$ 与 $\hat{W}^{(k)}$ 分别代表自编码器中 encoder 和 decoder 网络的权重。</p><p>整体损失函数如下：</p><p>$$<br>\begin{aligned}<br>\mathcal{L}_{mix} &amp;= \mathcal{L}_{2nd} + \alpha\mathcal{L}_{1st} + \mu\mathcal{L}_{reg} \\<br>&amp;= |(\hat{X}_i - X_i) \bigodot  B |^2_F + \alpha \sum^n_{i,j = 1} s_{i,j}|y_i - y_j|^2_2 + \mu\mathcal{L}_{reg}<br>\end{aligned}<br>$$</p><p>这个损失函数在实验效果上明显由于 LINE，但是因为网络结构更加复杂，输入输出中又分厂稀疏，因此时间复杂度较高，是一个优化的方向。</p><h4 id="Reference-12">Reference</h4><p><a href="https://www.kdd.org/kdd2016/papers/files/rfp0191-wangAemb.pdf">Structural Deep Network Embedding</a></p>]]></content>
      
      
      <categories>
          
          <category> Machine Learning </category>
          
          <category> Embedding </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Embedding </tag>
            
            <tag> Graph Embedding </tag>
            
            <tag> SDNE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Embedding Introduction (V)</title>
      <link href="/2022/01/21/Embedding-Introduction-V/"/>
      <url>/2022/01/21/Embedding-Introduction-V/</url>
      
        <content type="html"><![CDATA[<h3 id="DeepWalk-的优化-Node2Vec">DeepWalk 的优化 - Node2Vec</h3><p>可以这么理解，deepwalk 主要是基于 DFS 邻域的 graph embedding 算法，而 LINE 则是基于 BFS 邻域的 graph embedding 算法。接下来介绍的 node2vec 则是总和考虑 DFS 与 BFS 的 graph embedding 算法，是结合 DFS 与 BFS 的随机游走的 deep walk。</p><h4 id="算法原理">算法原理</h4><p>定义：</p><ol><li><p>$f(u)$ 为顶点 $u$ 到其对应 embedding 向量的映射</p></li><li><p>$N_S(u)$ 为在采样策略 $S$ 下顶点 $u$ 的近邻顶点集合</p></li></ol><p>而 node2vec 优化的目标比较直接，就是希望找到最优映射 $f(u)$，使近邻顶点出现的概率最大化，即</p><p>$$<br>max_f\sum_{u \in V} \log Pr(N_s(u) | f(u))<br>$$</p><p>为了使该最优化问题可解，文章做了两个假设：</p><ol><li><p>条件独立性假设。即在给定顶点 $u$ 下，其近邻顶点出现的概率，与近邻集合中其他顶点无关。即</p><p>$$<br>Pr(N_s(u) | f(u)) = \prod_{n_i\in N_s(u)} Pr(n_i | f(u))<br>$$</p></li><li><p>特征空间对称性假设。与 LINE 不同，假设一个顶点无论是作为原顶点还是近邻顶点，其共享同一套 embedding 向量。对应表达为</p><p>$$<br>Pr(n_i | f(u)) = \frac{\exp(f(n_i)\cdot f(u))}{\sum_{v\in V} \exp(f(v)\cdot f(u))}<br>$$</p></li></ol><p>最终，根据假设条件，我们的最终目标函数表示为</p><p>$$<br>max_f\sum_{v\in V}\left[-\log Z_u + \sum_{n_i\in N_s(u)} f(n_i) \cdot f(u)\right]<br>$$</p><p>其中 $Z_u = \sum_{n\in N_s(u)} \exp(f(n_i)\cdot f(u))$ 的计算代价高，需要采用负采样技术进行优化。</p><h4 id="采样策略">采样策略</h4><p>相比随机游走 deep walk 中的采样方式， node2vec 也是随机游走，但是是一种依概率随机游走，这种随机游走是有偏的。</p><p>比如给定当前顶点 $v$，访问下一个顶点 $x$ 的概率我们设定为</p><p>$$<br>P(c_i = x | c_{ - 1} = v) = \frac{\pi_{vx}}{Z} \text{, if } (v, x) \in E<br>$$</p><p>$$<br>P(c_i = x | c_{i - 1} = v) = 0  \text{, otherwise}<br>$$</p><p>其中 $\pi_{vx}$ 表示顶点 $v$  与顶点 $x$ 之间的转移概率（未 normalized）， $Z$ 则是归一化常数</p><p>文中 node2vec 引入两个参数 $p$ 与 $q$ 来控制随机游走的策略。</p><p>$$<br>\pi_{vx} = \alpha_{pq}(t, x)\cdot w_{vx}<br>$$</p><p>其中 $w_{vx}$ 表示顶点 $v$ 与 $x$ 之间的边权。而 $\alpha_{pq}$ 则与上一次游走起点 $t$ 和当次游走终点 $x$ 有关，可知两个顶点的距离 $d_{tx}$ 可以有三个取值：</p><ul><li>$d_{tx} = 0$，即两点属于同一个点，此时设定 $\alpha_{pq}(t, x) = \frac{1}{p}$，所以 $p$ 又被称为 return parameter，表示马上重新访问原来 node 的可能性。</li><li>$d_{tx} = 1$，即 $t, x$ 与 $v$ 三点均相邻，此时设定 $\alpha_{pq}(t, x) = 1$</li><li>$d_{tx} = 2$，即 $x$ 远离 $t$ 点，两点不直接相邻，此时设定 $\alpha_{pq}(t, x) = \frac{1}{q}$，所以 $q$ 又被称为 in-out parameter。</li></ul><p>从解释中可以看出， $p, q$ 值的设定，描述了算法对 BFS 与 DFS random walk 的倾向性。具体的取值可以通过下图直观看出:</p><p><img src="https://jason24-zeng.github.io/img/Embedding-Introduction-V/node2vec_pm.png" alt="node2vec_parameter"></p><h4 id="算法策略">算法策略</h4><p>采样顶点序列后，后续的方式与 deepwalk 与 LINE 一致，均通过 word2vec 的方法去学习 embedding 向量。node2vec 与 LINE 一样，是依概率抽取邻接点，同时采用 alias table 算法进行采样。</p><p>其核心算法伪代码如下：</p><p><img src="https://jason24-zeng.github.io/img/Embedding-Introduction-V/node2vec_algorithm.png" alt="node2vec_algorithm"></p><h4 id="Reference-11">Reference</h4><p><a href="https://www.kdd.org/kdd2016/papers/files/rfp0218-groverA.pdf">node2vec: Scalable Feature Learning for Networks</a></p>]]></content>
      
      
      <categories>
          
          <category> Machine Learning </category>
          
          <category> Embedding </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Embedding </tag>
            
            <tag> Graph Embedding </tag>
            
            <tag> Node2Vec </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Embedding-Introduction (IV)</title>
      <link href="/2022/01/21/Embedding-Introduction-IV/"/>
      <url>/2022/01/21/Embedding-Introduction-IV/</url>
      
        <content type="html"><![CDATA[<h4 id="LINE">LINE</h4><p>接 <a href="https://jason24-zeng.github.io/2022/01/20/Embedding-Introduction-III/">上一章节</a></p><p>我们已经定义好处理 LINE 的一阶与二阶 proximity 的目标函数，这一节主要是讨论函数的优化。</p><h4 id="模型优化">模型优化</h4><h6 id="回顾">回顾</h6><p>first-order proximity 目标函数</p><p>$$<br>O_1 = - \sum_{(i, j)\in E} w_{ij}\log p_1(v_i, v_j) \tag{1}<br>$$</p><p>second-order proximity 目标函数</p><p>$$<br>O_2 = - \sum_{(i, j)\in E} w_{ij} \log p_2(v_j|v_i) \tag{2}<br>$$</p><p>计算 second-order proximity 消耗较高，因为需要计算每个顶点的条件概率，然后把这些概率加和。为了解决这个消耗问题，文中采用了负采样的方法，通过每条边的一些噪音分布去采样多条负边。对边 $(i, j)$ 的目标函数变为：</p><p>$$<br>\log\sigma(\vec{u_j}^{1T} \cdot \vec{u_i}) + \sum^K_{i = 1} E_{v_n \sim P_n(v)}\left[\log\sigma(\vec{u}_n^{1T} \cdot \vec{u}_i)\right] \tag{3}<br>$$</p><p>其中，$\sigma(x) = 1 / (1 + \exp(-x))$ 是 sigmod 函数。前一项基于观察的边建模，后一项对从噪音分布采样得到的负边建模。$K$ 表示负边的总数。我们设定 $P_n(v) \propto d_v^{3/4}$，而 $d_v$ 为顶点 $v$ 的出度。</p><p>对于目标函数 $1$， 存在一个平凡解：$\forall i k, u_{ik} = \infty$。为了避免这个问题，我们依然使用方程 $3$ 中的负采样方法，只是把 $\vec{u_j}^{1T}$ 换成 $\vec{u_j}^{T}$ 即可。</p><p>为了最优化方程 $3$，文中采用了异步随机梯度算法（asynchronous stochastic gradient algorithm, ASGD）。每一步，ASGD 算法采样了一 mini-batch 的边，然后更新模型参数。如果一条边 $(i, j)$ 被采样，则梯度 (顶点 $i$ 的embedding 向量 $\vec{u_i}$) 会被使用一下方程计算</p><p>$$<br>\frac{\partial O_2}{\partial \vec{u_i}} = w_{ij}\cdot \frac{\partial \log p_2(v_j|v_i)}{\partial \vec{u_i}}<br>$$</p><p>这样的问题在于梯度会被乘以边权，当边权方差较大时，可能出现问题。</p><p>上面的问题主要出在对于不同的边权，固定的学习率不合适。所以一个简单的解决方法是将边权为 $w$ 的边 unfold 成 $w$ 条 0 - 1 边。这可以解决问题，但是会显著提升内存占用。文中的解决方法实际上是，将 $w$ 作为作为概率分布的权重，随机采样样本边，将取到的样本边作为 0 - 1 边去训练。这个想法与 XGBoost 中的直方图思想如出一辙。</p><p>而随机采样要达到空间时间上的最优还要考虑一些算法上的优化。我们假设 $W = (w_1, w_2, …, w_{|E|})$ 表示一系列边的权重，我们可以通过计算一个 $w_{sum} = \sum_{i = 1}^{|E|}$ 作为随机数的上界，判断这个随机数处于哪个区间，便能 sample 出边，这样的算法时间复杂度是 $O(|E|)$ ，在边很多的情况下时间花销较大。为了解决这个问题，可以考虑使用 <a href="https://blog.csdn.net/haolexiao/article/details/65157026">alias table 方法</a>，这个方法可以再 $O(1)$ 的时间复杂度下从固定的离散分布里根据权重筛选样本。</p><p>由此，我们可知，采样一条边需要 $O(1)$ 的时间复杂度，那么负采样优化后整体的时间花销为 $O(d(K + 1))$ ，$K$ 为负采样数量。因此，每一步迭代会花费 $O(dK)$ 次。而实际情况下，每次消耗的时间正比于边的数量 $|E|$。因此，LINE 的整体时间复杂度是 $O(dK|E|)$，与顶点数量无关。</p><h6 id="总结-2">总结</h6><p>从上面的理论推到可以看出，边的采样策略在不影响整体效果的前提下提升了随机梯度下降的效率。</p><h1></h1>]]></content>
      
      
      <categories>
          
          <category> Machine Learning </category>
          
          <category> Embedding </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Embedding </tag>
            
            <tag> Graph Embedding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Embedding Introduction (III)</title>
      <link href="/2022/01/20/Embedding-Introduction-III/"/>
      <url>/2022/01/20/Embedding-Introduction-III/</url>
      
        <content type="html"><![CDATA[<h3 id="Embedding-在互联网场景的使用-Graph-Embedding">Embedding 在互联网场景的使用 - Graph Embedding</h3><p>之前讲的 word2vec 和 item2vec 实际上都是在一个序列的基础上获得对象的隐式向量表达的。但是在互联网场景下，数据对象之前可能更多得呈现的是图结构，比如使用用户行为生成的物品全局关系图，或者物品属性知识图谱等。这种背景下，传统的序列 embedding 方法无法很好处理，因此，对图结构中节点进行表达的 graph embedding 便成了新的研究方向。随着大数据时代的到来，推荐系统愈发重要，这项技术也因此愈发受到重视。</p><h3 id="Graph-Embedding-早期方法-Deep-Walk">Graph Embedding 早期方法 - Deep Walk</h3><p>基于随机游走生成图结构对应的节点序列，是早期 Graph Embedding 的一种重要方法。其允许重复访问已访问节点，使用深度优先（DFS）进行序列生成。</p><p>其思路是，给定一个节点，通过随机采样的方法，获得该节点相邻节点中的一个，以此作为序列的下一个节点。重复上述步骤，知道序列长度达到预期长度。再使用 skip-gram word2vec 的方法表达向量。使用了 Hierachical Softmax 中构造 Huffman 树的技巧优化了 softmax 的时间复杂度</p><p>其伪代码表示为：</p><p><img src="https://jason24-zeng.github.io/img/Embedding-Introduction-III/fake_coding.png" alt="graph embedding deep walk algorithm"></p><p>使用随机游走的方法创建训练数据，这种方法的特点：</p><ul><li><p>可以实现机器、进程或线程维度的并行</p></li><li><p>适合动态更新，更新时只对新增节点增加</p></li></ul><p>该算法的超参数有：</p><ul><li><p>skip-gram 的窗口大小 $w$</p></li><li><p>生成向量的维度，隐藏层的神经元个数 $d$</p></li><li><p>每个节点的游走次数 $\gamma$</p></li><li><p>游走长度 $t$</p></li></ul><p>可认为 DeepWalk 是 Graph Embedding 的 baseline 方法。</p><p>参考：<a href="https://arxiv.org/pdf/1403.6652.pdf">DeepWalk: Online Learning of Social Representations</a></p><h3 id="Large-scale-Information-Network-Embedding-LINE">Large-scale Information Network Embedding (LINE)</h3><p>LINE 将非常大的信息网络映射到了低维向量空间（embedding）中，对可视化，节点分类等问题都有不错的效果。其相对 DeepWalk 这种纯粹随机游走的序列生成方式有以下两个特点：</p><ol><li><p>可以应用到有向图、无向图以及边有权重的网络</p></li><li><p>使用一阶、二阶的临近关系引入目标函数，从而使最终学出的 node embedding 的分布更加均匀平滑，避免 node embedding 聚集的情况发生</p></li><li><p>适用于大规模 network 上进行应用(Deep Walk 也适用)</p></li></ol><h4 id="问题定义">问题定义</h4><h5 id="Information-Network">Information Network</h5><p>$G = (V, E)$ 其中 $V$ 是 vertex 节点集合，$E$ 是 edge 边集合。定义 $e = (u, v) \in E$ 是一个有序的节点对，边权 $W_{uv} &gt; 0$。如果 $G$ 为无向图 (undirected graph)，则有 $(u, v) = (v, u)$ 与 $W_{uv} =  W_{vu}$。而如果 $G$ 为有向图 (directed graph)，那么有 $(u, v) \neq (v, u)$ 与 $W_{uv} \neq W_{vu}$</p><h5 id="First-order-Proximity-local-network-structure-一阶近邻关系">First-order Proximity (local network structure) 一阶近邻关系</h5><p>边权 $W_{uv}$ 就表示节点 $u$ 与 $v$ 之间的 first-order proximity。两个节点之间相连的边权重越高，则这两个点越相似。若两点之间没有边，则 first-order proximity 为 0</p><h5 id="Second-order-Proximity-global-netword-structure-二阶近邻关系">Second-order Proximity (global netword structure) 二阶近邻关系</h5><p>首先定义一个 $P_u = (W_{u,1},…, W_{u, |V|})$ 便是节点 $u$ 与其他所有节点的 first-order proximity 组成的集合。$u$ 与 $v$ 之间的相似度，则可以通过 $P_u$ 与 $P_v$ 之间的权重重合程度来决定相似度。两个节点的 neighbors 重复得越多，两者越相似。特别的，如果没有节点同时指向 $u$ 与 $v$ 或者 被 $u$ 与 $v$ 所指向，则 $u$ 与 $v$ 之间的 second-order proximity 为 0。</p><p>如下图的一个 Information Netword 的 toy model，可以看出 5 与 6 之间有较高的 second-order proximity，而 6 与 7 之间有较高的 first-order proximity。</p><p><img src="https://jason24-zeng.github.io/img/Embedding-Introduction-III/line_information_network.png" alt="Information Network"></p><h5 id="Large-scale-Information-Network-Embedding">Large-scale Information Network Embedding</h5><p>使用一个低维向量去表示整个 Information Network，即学习一个函数：</p><p>$$<br>f_G : V \rightarrow R^d, where \ d \ll|V|<br>$$</p><h4 id="模型描述">模型描述</h4><p>如前面所说，一个好的 Information Network Embedding 既需要有 first-order proximity 的信息，也不能忽视 second-order proximity。</p><h5 id="考虑-first-order-proximity-进行建模">考虑 first-order proximity 进行建模</h5><p>对于每个无向边 $(i,j)$，我们可以定义点 $v_i$ 与 $v_j$ 的联合概率如下：</p><p>$$<br>p_1(v_i, v_j) = \frac{1}{1 + \exp(-\vec{u_i}^T\cdot\vec{u_j})} \tag{1}<br>$$</p><p>其中，$\vec{u_i}\in R^d$ 是节点 $v_i$ 的低维向量表达。方程 $1$ 定义了一个在空间 $V \times V$ 的分布函数，它的经验概率可以被定义为</p><p>$$<br>\hat{p_1}(i,j) = w_{ij}/W<br>$$</p><p>其中，</p><p>$$<br>W = {\sum_{(i, j)\in E} w_{ij}}<br>$$</p><p>为了维护 first-order proximity，一个直白的想法是最小化目标函数</p><p>$$<br>O_1 = d(\hat{p}_1(\cdot ,\cdot), p_1(\cdot ,\cdot)) \tag{2}<br>$$</p><p>其中 $d(\cdot ,\cdot)$ 为两个分布之间的距离，这个距离我们选择使用 KL 散度来表达，同时取出其中的常数项，我们就有：</p><p>$$<br>O_1 = - \sum_{(i, j)\in E} w_{ij}\log p_1(v_i, v_j) \tag{3}<br>$$</p><p>需要注意到 first-order proximity 只对无向图有用。通过找到集合 ${\vec{u_i}}_{i = 1…|V|}$ ，使方程 $3$目标函数最小化，我们可以在 $d$ 维空间中表示每个节点。</p><h5 id="考虑-second-order-proximity-建模">考虑 second-order proximity 建模</h5><p>second-order proximity 对有向图与无向图都可行。在考虑 second-order proximity  是，节点扮演了两个角色：</p><ul><li><p>节点本身</p></li><li><p>其他节点的上下文 context</p></li></ul><p>为了区分这两个角色，我们引入了两个向量 $\vec{u}_i$ 与 $\vec{u}'_i$，分别对应魔偶个节点 $v_i$ 的上述两种角色的表达。</p><p>首先我们定义一个上下文 $v_j$ 被 $v_i$ 产生的概率:</p><p>$$<br>p_2(v_j|v_i) = \frac{\exp(\vec{u}_i’^T \cdot \vec{u}_j)}{W(\vec{u}_j)} \tag{4}<br>$$</p><p>其中，</p><p>$$<br>W(\vec{u}_j) = \sum \exp(\vec{u}_k’^T \cdot \vec{u}_j)<br>$$</p><p>该方程实际定义了一个网络里所有节点为节点 $v_i$ context 的条件概率。如果 $p2(\cdot | v2)$ 与 $p2(\cdot | v1)$ 的概率分布相似，则这两个点的 second-order proximity 是相似的。</p><p>为了维护 second-order proximity，我们需要逼近经验分布函数 $\hat{p}_2(\cdot | v_i)$，因此，我们需要最小化一下目标函数</p><p>$$<br>O_2 = \sum_{i \in V} \lambda_i d(\hat{p}_2(\cdot|v_i), p_2(\cdot|v_i)) \tag{5}<br>$$</p><p>因为网络中每个节点的重要性不同，我们引入 $\lambda_i$ 表达网络中节点 $i$ 的优先级，它可以通过度数衡量 (需要进一步探讨，应该是图论中的出入度计算) 或者通过一些算法预估 (比如 PageRank)。</p><p>经验分布</p><p>$$<br>\hat{p_2} (\cdot \vert v_i) = w_{ij} / d_i<br>$$</p><p>其中 $w_{ij}$ 为边 $(i,j)$ 的权重， $d_i = \sum_{k\in N(i)}  w_{ik}$ 表示顶点 $i$ 的出度 (out-degree), $N(i)$ 则是节点 $v_i$ 的 out-neighbors。</p><p>在文章中，简单得将 $\lambda_i$ 设成顶点 $i$ 的度数，即 $\lambda_i = d_i$， 同时采用 KL 散度作为距离方程，同时去掉常数项，则最终我们目标函数变为</p><p>$$<br>O_2 = - \sum_{(i, j)\in E} w_{ij} \log p_2(v_j|v_i)<br>$$</p><p>通过学习集合 ${\vec{u_i}}_{i = 1…|V|} $ 与</p><p>$ {\vec{u_i}'}_{i = 1…|V|}$ 最小化目标，我们可以用一个 $d$ 维向量 $\vec{u_i}$ 表达每一个顶点。</p><h5 id="Combine-一阶与二阶-proximity">Combine 一阶与二阶 proximity</h5><p>文章中分别训练一阶 proximity 和 二阶 proximity，然后将得到的 embedding 拼起来作为该顶点的 embedding 表达。一个更原则性的方式是将目标函数联立起来求。</p><p>参考：<a href="https://arxiv.org/pdf/1503.03578.pdf">LINE: Large-scale Information Network Embedding</a></p>]]></content>
      
      
      <categories>
          
          <category> Machine Learning </category>
          
          <category> Embedding </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Embedding </tag>
            
            <tag> Graph Embedding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Embedding Introduction (II)</title>
      <link href="/2022/01/20/Embedding-Introduction-II/"/>
      <url>/2022/01/20/Embedding-Introduction-II/</url>
      
        <content type="html"><![CDATA[<h4 id="生成-Embedding-的方法-II">生成 Embedding 的方法 (II)</h4><h4 id="Item2Vec-Word2Vec-的衍生">Item2Vec : Word2Vec 的衍生</h4><p>Word2Vec 那种用向量 embedding 去表达单词的方法因其 state-of-art 的性能而在 NLP 领域备受关注。同样的，这种技术/技巧在 推荐系统领域也受到了追捧。特别的，通过使用 skip-gram using negative sampling 的 i2i 协同过滤(CF) 算法因为比肩 SVN CF 算法而受到推崇。这边博客，也主要讲解 Item2Vec 中的一些特点。</p><h4 id="Skip-gram-with-negative-sampling-SGNS">Skip-gram with negative sampling (SGNS)</h4><p>Reference: <a href="https://arxiv.org/pdf/1301.3781.pdf%C3%AC%E2%80%94%20%C3%AC%E2%80%9E%C5%93">Efficient estimation of word representations in vector space</a></p><p>SGNS 方法旨在找到单词的表达，使其能够抓住该单词与句子中周围单词的关系。</p><p>我们用 $(w_i)^K_{i = 1}$ 表示一批连续的单词，其中，这些词都来自于一个有限词汇集 $W = {w_i}^W_{i=1}$。 从而，我们可以表达 skip - gram 的目标，最大化：</p><p>$$<br>\frac{1}{K} \sum^K_{i = 1} \sum_{-c &lt;= j &lt;= c, j \neq 0} \log{p(w_{i + j} | w_i)} \tag{1}<br>$$</p><p>其中，$c$ 是上下文的窗口大小，该大小可能取决于 $w_i$。而 $p(w_{i + j} | w_i)$ 则是 softmax 函数：</p><p>$$<br>p(w_{i + j} | w_i) = \frac{\exp(u^T_iv_j)}{\sum_{k\in I_w}\exp(u^T_iv^T_k)}<br>$$</p><p>其中 $u_i\in U(\mathcal{R^m}) $ 和 $v_i \in V(\mathcal{R^m})$ 分别是 $w_i \in W$ 中关于目标和上下文表达的隐向量。$m$ 通常通过经验与数据集的大小去选择。使用 softmax 函数不太现实，因为计算 $\nabla p(w_{i + j} | w_i)$ 的时间复杂度是线性的，与词汇集的大小有关。</p><h5 id="负采样">负采样</h5><p>为了不大幅影响精度的情况下环节上述计算问题。我们将上面的 softmax 函数换成了</p><p>$$<br>p(w_{i + j} | w_i) = \sigma(u^T_iv_j)\prod^N_{k=1} \sigma(u^T_iv^T_k)<br>$$</p><p>其中，$\sigma(x) = \frac{1}{1 + \exp(-x)}$，$N$ 是一个决定每个正样本所需负例样本数的参数。而 $w_i$ 中的负样本原则概率通过一元模型函数（Unigram Distribution） $f(w_i)$ 的 $\frac{3}{4}$ 次方来获得。整个公式为：</p><p>$$<br>P(w_i) = \frac{f(w_i)^{3/4}}{\sum_{j = 0}^n(f(w_i)^{3/4})}<br>$$</p><p>这个一元函数实际上就是将样本中的所有词写到了一个数组中，重复的词重复写到数组的不同位置(使用每个单词的索引填充)，直接通过生成随机数的方式去返回该随机数对应位置的数。如此依赖，如果数组中出现次数多的数，被负采样的概率就更大。</p><p>使用 $\frac{3}{4}$ 次方，更多的是一种经验效果，好于单纯用一元函数模型。</p><h5 id="降采样">降采样</h5><p>除此以外，为了解决稀有与高频词的不平衡问题，文章中提出了一种降采样的方法。</p><p>已知一个输入词序列，我们以一个概率去丢弃每个词：</p><p>$$<br>p(discard | w) = 1 - \sqrt{\frac{\rho}{f(w)}}<br>$$</p><p>其中 $f(w)$ 为该词的词频，$\rho$ 为一个预设阈值。这个操作据报道能提升训练进程，并大幅提升稀有词的表达。</p><p>以上就是<strong>SGNS</strong> 的两大操作 负采样 与 降采样。</p><h4 id="Item2Vec-思路">Item2Vec 思路</h4><p>SGNS 方法被使用到了 item-based 的协同过滤推荐系统中。有些场景，我们没办法达到用户与一系列商品之间的关联信息，这时候，通过商品侧做的协同过滤就尤为重要。使用 SGNS 的想法也很显然，只要我们把一集合的商品认为是一序列的单词，则使用 embedding 去获得商品间的相关性与获得单词之间的相关性就并无不同。</p><p>从序列到集合后，时空信息就丢失了，也就是丢掉了它们之间的相邻关系。而 Item2Vec 就考虑丢掉这部分信息，他们认为在同一个 set 中的商品就应该是相关的，无论用户看到这个 set 的顺序或者时间是如何的。虽然这个假设在其他场景下不成立，不过可以认为在当前场景下是合理的。</p><p>因此，我们认为每对在同一个子集合中的商品是正例。这意味着集合的大小决定了窗口的大小。特别地，对于一个给定集合的商品，方程 $(1)$ 变为</p><p>$$<br>\frac{1}{K} \sum^K_{i = 1} \sum^K_{j \neq i} \log p(w_j | w_i)<br>$$</p><p>整个集合大小为 $K$，计算两两 pair 之间的 log 概率之和。</p><p>另一种方法，则保持方程 $(1)$ 不变，在执行期间 shuffle 每个集合内的商品。实验中发现两种方法最终的表现差不多。</p><p>后面的步骤与上一个 Section 保持一致，这就是 Item2Vec。工作中，我们使用 $u_i$ 作为第 $i$ 个商品的表达，而一对商品的相关性通过 cosine 相关性计算得到。另一种方法是使用 $v_i$，或者 $v_i + u_i$，或者它俩的 concatenation $[u^T_iv^T_i]^T$。最后两种方法优势有更好的效果。</p><h4 id="Item2Vec-效果">Item2Vec 效果</h4><p>将 Item2Vec 生成的 embedding 用作聚类，与基于 SVD 方法的用户 embedding 聚类结果进行比较，向量维度保持一致，即 $m = 40$。对比数据为音乐领域里 web 音乐人根据类别的聚类，同一个颜色的节点表示相同类型的音乐人。对比结果如下</p><p><img src="https://jason24-zeng.github.io/img/Embedding-Introduction-II/item2vec.jpg" alt="item2vec.jpg"></p><p>可以看出，两者差距不大，甚至 Item2Vec 的效果更好。</p><h4 id="Reference-10">Reference</h4><p><a href="https://arxiv.org/pdf/1603.04259v2.pdf">Item2Vec: Neural Item Embedding for Collaborative Filtering</a></p>]]></content>
      
      
      <categories>
          
          <category> Machine Learning </category>
          
          <category> Embedding </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Embedding </tag>
            
            <tag> Item2Vec </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Embedding Introduction (I)</title>
      <link href="/2022/01/19/Embedding-Introduction/"/>
      <url>/2022/01/19/Embedding-Introduction/</url>
      
        <content type="html"><![CDATA[<h4 id="什么是-Embedding">什么是 Embedding ?</h4><p>广义得说， Embedding 就是一种用向量表达某个词汇的方式。其特点就是可以捕捉到文档中单词的上下文、语义与句法相似以及与其他单词的关系等。</p><p>考虑一下我们之前在做类别特征时常用的 one-hot 方法，假设整个上下文的单词量有 L，对任意一个单词，我们将其做 one-hot 转换成一个长度为 L 的向量，其中某个位置为 1，其余位置为 0。这样我们的确可以将单词映射到一个向量表达上。但当前还有一个问题：这样的表达可以表征两个单词的相关性么？</p><p>答案是不能，因为两个单词的计算 cosine 为 0。(在不同位置包含一个 1)</p><p>所以怎么才能体现相关性呢？可以考虑将这些 one-hot 矩阵映射到一个低位空间，使其向量值变稠密，同时保证“相似”词的 embedding 内积接近 1，不相似词的 embedding 内积接近 0，“相反”词的 embedding 内积接近 -1。这样的向量表达，就是我们常说的 embedding。</p><p>但是，这样的 embedding 需要如何生成呢？这篇文章就主要讲讲生成 embedding 的几种方法。</p><h4 id="生成-word-embeddings-的方式-一">生成 word embeddings 的方式 (一)</h4><h5 id="Word2Vec">Word2Vec</h5><p>word2vec 是一种使用浅神经网络训练 word embedding 的一种流行技巧。它主要通过两种包含神经网络的方式获得 embedding:   Skip Gram 和 CBOW (Common Bag Of Words)</p><p>而 embedding 从模型的什么部分获得呢？当模型训练完后，实际上我们得到了神经网络的权重，因为输入层是 one-hot 格式，到隐藏层时，相当于只有这个词对应的 embedding 被激活了，因而可以用这个 embedding 来表达该单词。</p><h6 id="CBOW-模型">CBOW 模型</h6><p>CBOW 模型：使用每个词的上下文作为输入，以预测准确这个词为训练目标，去训练整个神经网络模型。</p><p>只包含一个上下文单词 one-hot 作为输入的神经网络整体实际结构如下：</p><p><img src="https://jason24-zeng.github.io/img/Embedding-Introduction/CBOW_word2vec.png" alt="CBOW_word2vec.png"></p><p>这个输入，或者说这个上下文单词是一个大小为 V 的 one-hot 编码向量。隐藏层包含 N 个神经元，而输出则同样是一个 Size 为 V 的向量，其中的值通过了 Softmax 做归一化。目的是预测目标单词。</p><p>我们可以看到其中有两个权重矩阵 $W_{vn}$ 和 $W’_{nv}$ 。</p><p>这个神经网络中，唯一牵涉到非线性的地方就是输出层的 softmax，而没有用到其他激活函数，比如 sigmoid, tanh 或者 ReLU。</p><p>同样的，如果我们考虑的上下文单词不是一个，而是多个，则可以考虑如下结构：</p><p><img src="https://jason24-zeng.github.io/img/Embedding-Introduction/CBOW_word2vec_2.png" alt="CBOW_word2vec_2.png"></p><p>将 C 个上下文单词考虑入模型，均使用权重矩阵 $W_{vn}$ 计算隐藏层输入，再对所有 C 取平均值得到输出层的输入。这样，我们就可以使用上下文单词产生词表达。</p><h6 id="Skip-Gram-模型">Skip-Gram 模型</h6><p>整体结构如下，从某种意义上，这个结构就像 CBOW 结构翻转过来一样</p><p><img src="https://jason24-zeng.github.io/img/Embedding-Introduction/skip_gram.png" alt="skip_gram.png"></p><p>对每个上下文位置，我们会得到 C 个 向量来预测词的可能性分布，每个向量对应一个单词。</p><p>两种模型都使用 backward propagation 负反馈的方式去迭代学习。</p><h6 id="优势场景">优势场景</h6><p>对于少量数据，skip gram 工作表现得更好，并且更能表达稀有词语。</p><p>CBOW 模型则对更频繁出现的词语表达更好，且更快。</p><h6 id="算法优化">算法优化</h6><p>文章中还提到了使用 Hierachical Softmax 和 Skip Gram 负采样的方式，使计算变得更有效率。详细文章可以参考<a href="https://arxiv.org/abs/1310.4546">原文</a> 或<a href="https://arxiv.org/pdf/1411.2738.pdf">Xin Rong 的论文</a></p><h5 id="总结-3">总结</h5><p>本文主要介绍了一下词表达的一种形式 embedding，并简单地讲述了 embedding 的两种基础训练方法：CBOW 和 skip-gram。</p><p>在学习过程中，发现一个有趣的地方。通过输入层与隐藏层间权重矩阵的某一列来表达某个单词，这个做法和 Factorization Machine 中某个特征的表达所用的矩阵有异曲同工之妙。同时，也希望自己能在一点点积累知识的同时能继续提升自己的写作能力。 并能手动复现这个基础的训练代码。``</p>]]></content>
      
      
      <categories>
          
          <category> Machine Learning </category>
          
          <category> Embedding </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Embedding </tag>
            
            <tag> Word2Vec </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>堆排序代码实现</title>
      <link href="/2022/01/17/heap-sort/"/>
      <url>/2022/01/17/heap-sort/</url>
      
        <content type="html"><![CDATA[<h4 id="什么是堆排序？"><a href="#什么是堆排序？" class="headerlink" title="什么是堆排序？"></a>什么是堆排序？</h4><p>堆排序是一种基于比较的排序算法，需要借助于一种叫做二叉堆（Binary Heap）的数据结构。其操作和选择排序很相似，均可以认为是从某个数据结构中选出最小/最大的数出来。</p><h5 id="什么是二叉堆？"><a href="#什么是二叉堆？" class="headerlink" title="什么是二叉堆？"></a>什么是二叉堆？</h5><p>在定义二叉堆之前，让我们先声明一个满二叉树（完全二叉树）的定义。一个满二叉树是一个除最后一层以外，其他层都被完全占满的二叉树。同时，满二叉树还要求树的节点尽可能地靠近左边。</p><p>而二叉堆，则是一个有特殊排序的满二叉树，他每个父节点的值，都比两个子节点的值大(或者小)。前者，被称为最大堆，后者，则是最小堆。这样的堆我们可以用二叉树或者数组来表达。</p><h5 id="怎么用数组的格式表达二叉堆？"><a href="#怎么用数组的格式表达二叉堆？" class="headerlink" title="怎么用数组的格式表达二叉堆？"></a>怎么用数组的格式表达二叉堆？</h5><p>我们要充分利用好满二叉树每一层个数固定的性质。可以看到，如果一个父节点被存在了 <code>i</code> 位置，则其左子节点的位置为 <code>2 * i + 1</code>，而右子节点的位置为 <code>2 * i + 2</code>。这样的 array-base 的表达相比二叉树充分利用了空间。</p><h4 id="Heapify-过程"><a href="#Heapify-过程" class="headerlink" title="Heapify 过程"></a>Heapify 过程</h4><p>将一个二叉树重构成一个堆数据结构的过程，被称作 heapify。</p><h5 id="增序的堆排序算法"><a href="#增序的堆排序算法" class="headerlink" title="增序的堆排序算法"></a>增序的堆排序算法</h5><p>步骤：</p><ol><li><p>通过输入数据件一个最大堆。</p></li><li><p>最大的元素被放到了堆顶。用这个堆的最后一个值与堆顶交换，并使这个堆的 size 缩小一位。最终 heapify 树的根节点。</p></li><li><p>重复第 2 步，知道堆只剩一个元素。</p></li></ol><h5 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="comment">// heapify 一个根节点在 i 位置的子树，堆的大小为 n</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">heapify</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; arr, <span class="keyword">int</span> n, <span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> largest = i;</span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">2</span> * i + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> r = <span class="number">2</span> * i + <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (l &lt; n &amp;&amp; arr[l] &gt; arr[largest]) largest = l;</span><br><span class="line">    <span class="keyword">if</span> (r &lt; n &amp;&amp; arr[r] &gt; arr[largest]) largest = r;</span><br><span class="line">    <span class="keyword">if</span> (largest != i) &#123;</span><br><span class="line">        <span class="built_in">swap</span>(arr[i], arr[largest]);</span><br><span class="line">        <span class="built_in">heapify</span>(arr, n, largest);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 堆排序过程</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">heapSort</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; arr, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 0x01 建堆, 从第一个有子节点的节点开始 heapify</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n / <span class="number">2</span> - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="built_in">heapify</span>(arr, n, i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 0x02 一个一个从 heap 中取出最大元素，放到最后，直到堆只剩一个元素</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">1</span>; i &gt; <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="built_in">swap</span>(arr[<span class="number">0</span>], arr[i]);</span><br><span class="line">        <span class="built_in">heapify</span>(arr, i, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// test case</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printArray</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; arr)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> num : arr) std::cout &lt;&lt; num &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    std::cout &lt;&lt; std::endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt; arr = &#123;<span class="number">17</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">4</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> n = arr.<span class="built_in">size</span>();</span><br><span class="line">    <span class="built_in">heapSort</span>(arr, n);</span><br><span class="line">    <span class="built_in">printArray</span>(arr);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Algorithm </category>
          
          <category> Sort </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Leetcode </tag>
            
            <tag> Sort </tag>
            
            <tag> Heap </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>股票问题系列--动态规划求解</title>
      <link href="/2022/01/16/stock-problem-dp/"/>
      <url>/2022/01/16/stock-problem-dp/</url>
      
        <content type="html"><![CDATA[<h4 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h4><p>最近刷到多道 Best Time to Buy and Sell Stock 系列的问题，想要探究一下这类题目的通用动态规划解法。为此，特写了此文，找出这类问题的练习，供有面试需求的相关同学学习。</p><h5 id="相关题目"><a href="#相关题目" class="headerlink" title="相关题目"></a>相关题目</h5><ol><li><a href="https://leetcode.com/problems/best-time-to-buy-and-sell-stock/#/description">121. Best Time to Buy and Sell Stock</a></li><li><a href="https://leetcode.com/problems/best-time-to-buy-and-sell-stock-ii/#/description">122. Best Time to Buy and Sell Stock II</a></li><li><a href="https://leetcode.com/problems/best-time-to-buy-and-sell-stock-iii/#/description">123. Best Time to Buy and Sell Stock III</a></li><li><a href="https://leetcode.com/problems/best-time-to-buy-and-sell-stock-iv/#/description">188. Best Time to Buy and Sell Stock IV</a></li><li><a href="https://leetcode.com/problems/best-time-to-buy-and-sell-stock-with-cooldown/#/description">309. Best Time to Buy and Sell Stock with Cooldown</a></li><li><a href="https://leetcode.com/problems/best-time-to-buy-and-sell-stock-with-transaction-fee/description/">714. Best Time to Buy and Sell Stock with Transaction Fee</a></li></ol><h5 id="通用问题描述"><a href="#通用问题描述" class="headerlink" title="通用问题描述"></a>通用问题描述</h5><p>给定一个数组 <code>vector&lt;int&gt;&amp; prices</code> ，这个数组代表了一个序列化的股票价格，在某些限制条件下，求能通过这些天的股票买卖获得的最大收益。</p><p>首先，我们来记录一下可能的限制条件：</p><ul><li><p>交易次数 <code>int k</code></p></li><li><p>交易冷却时间 <code>int time</code></p></li><li><p>交易费用 <code>int fee</code></p></li></ul><p>以及一些注明 (notation)：</p><ul><li>股票价格所处日期<code>int i</code>，第一天为 <code>0</code></li></ul><p>我们可以看到，上述的这类问题，其实都存在很明显的状态转移关系。</p><ul><li><p>当天有两个状态，持有股票与不持有股票</p></li><li><p>当天的状态，会与前面某天的状态有关。比如如果今天持有股票，则要么昨天也持有股票，要么需要再冷却期内不持有股票。</p></li></ul><h4 id="通用问题状态转移关系"><a href="#通用问题状态转移关系" class="headerlink" title="通用问题状态转移关系"></a>通用问题状态转移关系</h4><p>我们定义一个三维矩阵<code>T</code>， 其中 <code>T[i][k][0]</code> 表示累计到第 <code>i</code> 天，进行了最多 <code>k</code> 次交易，并在第 <code>i</code> 天手上不持有股票下的最大收益；同样的，<code>T[i][k][0]</code> 表示累计到第 <code>i</code> 天，进行了最多 <code>k</code> 次交易，并在第 <code>i</code> 天手上持有股票的最大收益。目前我们可以依此写出base 条件与递归条件：</p><ol><li><p>base 情况：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 开始计算股票前一天的初始化，不持有股票认为是合法的，为 0，持有股票认为是不可能</span></span><br><span class="line">T[<span class="number">-1</span>][k][<span class="number">0</span>] = <span class="number">0</span>, T[<span class="number">-1</span>][k][<span class="number">1</span>] = INT_MIN</span><br><span class="line"><span class="comment">// 无可交易次数时的初始化，不持有股票认为是合法的，为 0，持有股票认为是不可能</span></span><br><span class="line">T[i][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>, T[i][<span class="number">0</span>][<span class="number">1</span>] = INT_MIN</span><br></pre></td></tr></table></figure></li><li><p>递归关系：<br>2.1. 不持有股票的状态转移:  </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 当天不持有股票的最大收益，认为是前一天不持有股票的最大收益，与前一天持有当卖出股票的最大收益之间的最大值。</span></span><br><span class="line">T[i][k][<span class="number">0</span>] = <span class="built_in">max</span>(T[i - <span class="number">1</span>][k][<span class="number">0</span>], T[i - <span class="number">1</span>][k][<span class="number">1</span>] + prices[i]);</span><br><span class="line"><span class="comment">// 如果考虑有交易费用，后一项的最大收益需要减去交易费用</span></span><br><span class="line">T[i][k][<span class="number">0</span>] = <span class="built_in">max</span>(T[i - <span class="number">1</span>][k][<span class="number">0</span>], T[i - <span class="number">1</span>][k][<span class="number">1</span>] + prices[i] - fee);</span><br></pre></td></tr></table></figure><p>2.2. 持有股票的状态转移:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 当天持有股票的最大收益，认为是前一天持有股票的最大收益，与前一天不持有而今天买入股票的最大收益</span></span><br><span class="line">T[i][k][<span class="number">1</span>] = <span class="built_in">max</span>(T[i - <span class="number">1</span>][k][<span class="number">1</span>], T[i - <span class="number">1</span>][k - <span class="number">1</span>][<span class="number">0</span>] - prices[i]);</span><br><span class="line"><span class="comment">// 如果考虑交易费用，除了上面 2.1 在卖出时支付交易费用外，还可以考虑是在买入时支付交易费用</span></span><br><span class="line">T[i][k][<span class="number">1</span>] = <span class="built_in">max</span>(T[i - <span class="number">1</span>][k][<span class="number">1</span>], T[i - <span class="number">1</span>][k - <span class="number">1</span>][<span class="number">0</span>] - prices[i] - fee);</span><br><span class="line"><span class="comment">// 如果考虑 cooldown 时间，那么我们能买入的条件也就不是前一天不持有股票，而是 cooldown 时间前不持有股票</span></span><br><span class="line">T[i][k][<span class="number">1</span>] = <span class="built_in">max</span>(T[i - <span class="number">1</span>][k][<span class="number">1</span>], T[i - time][k - <span class="number">1</span>][<span class="number">0</span>] - prices[i]);</span><br></pre></td></tr></table></figure></li></ol><h4 id="特殊-cases-的求解"><a href="#特殊-cases-的求解" class="headerlink" title="特殊 cases 的求解"></a>特殊 cases 的求解</h4><p>有了上述的通用状态转移关系，我们可以比较轻松得求解参数值固定的情况。</p><h5 id="case-I-k-1"><a href="#case-I-k-1" class="headerlink" title="case I : k = 1"></a>case I : <code>k = 1</code></h5><p>当交易次数限制为 <code>k = 1</code> 时，每天 <code>i</code> 我们需要考虑两个状态下的值</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">T[i][<span class="number">1</span>][<span class="number">0</span>] = <span class="built_in">max</span>(T[i - <span class="number">1</span>][<span class="number">1</span>][<span class="number">0</span>], T[i - <span class="number">1</span>][<span class="number">1</span>][<span class="number">1</span>] + prices[i]);</span><br><span class="line">T[i][<span class="number">1</span>][<span class="number">1</span>] = <span class="built_in">max</span>(T[i - <span class="number">1</span>][<span class="number">1</span>][<span class="number">1</span>], T[i - <span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>] - prices[i]) = <span class="built_in">max</span>(T[i - <span class="number">1</span>][<span class="number">1</span>][<span class="number">1</span>], - prices[i]);</span><br></pre></td></tr></table></figure><p>从而，这道题的解法为：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxProfit</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; prices)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> T_10 = <span class="number">0</span>, T_11 = INT_MIN;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> price : prices) &#123;</span><br><span class="line">            <span class="comment">// 每次迭代最多只会修改其中一个值</span></span><br><span class="line">            T_10 = <span class="built_in">max</span>(T_10, T_11 + price);</span><br><span class="line">            T_11 = <span class="built_in">max</span>(T_11, -price);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> T_10;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h5 id="Case-II-k-INT-MAX"><a href="#Case-II-k-INT-MAX" class="headerlink" title="Case II: k = INT_MAX"></a>Case II: <code>k = INT_MAX</code></h5><p>这个时候，其实 <code>T[i-1][k-1][0] = T[i-1][k][0]</code> 且 <code>T[i-1][k-1][1] = T[i-1][k][1]</code></p><p>每天 <code>i</code> ，我们仍然有两个变量未知</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">T[i][k][<span class="number">0</span>] = <span class="built_in">max</span>(T[i<span class="number">-1</span>][k][<span class="number">0</span>], T[i<span class="number">-1</span>][k][<span class="number">1</span>] + prices[i])</span><br><span class="line">T[i][k][<span class="number">1</span>] = <span class="built_in">max</span>(T[i<span class="number">-1</span>][k][<span class="number">1</span>], T[i<span class="number">-1</span>][k<span class="number">-1</span>][<span class="number">0</span>] - prices[i]) = <span class="built_in">max</span>(T[i<span class="number">-1</span>][k][<span class="number">1</span>], T[i<span class="number">-1</span>][k][<span class="number">0</span>] - prices[i])</span><br></pre></td></tr></table></figure><p>从而，这道题的解法为：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxProfit</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; prices)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> T_k0 = <span class="number">0</span>, T_k1 = INT_MIN;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> price : prices) &#123;</span><br><span class="line">            <span class="keyword">int</span> T_k0_old = T_k0;</span><br><span class="line">            T_k0 = <span class="built_in">max</span>(T_k0, T_k1 + price);</span><br><span class="line">            T_k1 = <span class="built_in">max</span>(T_k1, T_k0_old - price);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> T_k0;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h5 id="Case-III-k-2"><a href="#Case-III-k-2" class="headerlink" title="Case III : k = 2"></a>Case III : <code>k = 2</code></h5><p>和 case I 很相似，不过现在每天需要考察四个变量，其状态转移关系为</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">T[i][<span class="number">2</span>][<span class="number">0</span>] = <span class="built_in">max</span>(T[i<span class="number">-1</span>][<span class="number">2</span>][<span class="number">0</span>], T[i<span class="number">-1</span>][<span class="number">2</span>][<span class="number">1</span>] + prices[i])</span><br><span class="line">T[i][<span class="number">2</span>][<span class="number">1</span>] = <span class="built_in">max</span>(T[i<span class="number">-1</span>][<span class="number">2</span>][<span class="number">1</span>], T[i<span class="number">-1</span>][<span class="number">1</span>][<span class="number">0</span>] - prices[i])</span><br><span class="line">T[i][<span class="number">1</span>][<span class="number">0</span>] = <span class="built_in">max</span>(T[i<span class="number">-1</span>][<span class="number">1</span>][<span class="number">0</span>], T[i<span class="number">-1</span>][<span class="number">1</span>][<span class="number">1</span>] + prices[i])</span><br><span class="line">T[i][<span class="number">1</span>][<span class="number">1</span>] = <span class="built_in">max</span>(T[i<span class="number">-1</span>][<span class="number">1</span>][<span class="number">1</span>], - prices[i])</span><br></pre></td></tr></table></figure><p>同理，解法为</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxProfit</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; prices)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> T_10 = <span class="number">0</span>, T_11 = INT_MIN;</span><br><span class="line">        <span class="keyword">int</span> T_20 = <span class="number">0</span>, T_21 = INT_MIN;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> price : prices) &#123;</span><br><span class="line">            T_20 = <span class="built_in">max</span>(T_20, T_21 + price);</span><br><span class="line">            T_21 = <span class="built_in">max</span>(T_21, T_20 - price);</span><br><span class="line">            T_10 = <span class="built_in">max</span>(T_10, T_11 + price);</span><br><span class="line">            T_11 = <span class="built_in">max</span>(T_11, - price);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> T_20;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>通过这样的方法，我们可以解任意 k 的结果。</p><h5 id="Case-IV-k-INT-MAX-但是有冷却"><a href="#Case-IV-k-INT-MAX-但是有冷却" class="headerlink" title="Case IV : k = INT_MAX 但是有冷却"></a>Case IV : <code>k = INT_MAX</code> 但是有冷却</h5><p>我们考虑 cool down 为 1 的情况，也就是如果我们想要在第 <code>i</code> 天买股票，那么我们只能在第 <code>i - 2</code> 前将股票卖出。状态转移方程变为</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">T[i][k][<span class="number">0</span>] = <span class="built_in">max</span>(T[i<span class="number">-1</span>][k][<span class="number">0</span>], T[i<span class="number">-1</span>][k][<span class="number">1</span>] + prices[i])</span><br><span class="line">T[i][k][<span class="number">1</span>] = <span class="built_in">max</span>(T[i<span class="number">-1</span>][k][<span class="number">1</span>], T[i<span class="number">-2</span>][k][<span class="number">0</span>] - prices[i])</span><br></pre></td></tr></table></figure><p>解法修改为</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxProfit</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; prices)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> T_k0 = <span class="number">0</span>, T_k1 = INT_MIN, T_k0_pre = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> price : prices) &#123;</span><br><span class="line">            <span class="keyword">int</span> T_k0_old = T_k0;</span><br><span class="line">            T_k0 = <span class="built_in">max</span>(T_k0, T_k1 + price);</span><br><span class="line">            T_k1 = <span class="built_in">max</span>(T_k1, T_k0_pre - price);</span><br><span class="line">            T_k0_pre = T_k0_old;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> T_k0;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h5 id="Case-V-k-INT-MAX-有交易费用"><a href="#Case-V-k-INT-MAX-有交易费用" class="headerlink" title="Case V : k = INT_MAX 有交易费用"></a>Case V : <code>k = INT_MAX</code> 有交易费用</h5><p>在 case II 的基础上，考虑购买或卖出时收益多减去一个 fee 即可</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">T[i][k][<span class="number">0</span>] = <span class="built_in">max</span>(T[i<span class="number">-1</span>][k][<span class="number">0</span>], T[i<span class="number">-1</span>][k][<span class="number">1</span>] + prices[i])</span><br><span class="line">T[i][k][<span class="number">1</span>] = <span class="built_in">max</span>(T[i<span class="number">-1</span>][k][<span class="number">1</span>], T[i<span class="number">-1</span>][k][<span class="number">0</span>] - prices[i] - fee)</span><br></pre></td></tr></table></figure><p>或者</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">T[i][k][<span class="number">0</span>] = <span class="built_in">max</span>(T[i<span class="number">-1</span>][k][<span class="number">0</span>], T[i<span class="number">-1</span>][k][<span class="number">1</span>] + prices[i] - fee)</span><br><span class="line">T[i][k][<span class="number">1</span>] = <span class="built_in">max</span>(T[i<span class="number">-1</span>][k][<span class="number">1</span>], T[i<span class="number">-1</span>][k][<span class="number">0</span>] - prices[i])</span><br></pre></td></tr></table></figure><h6 id="解法-I-买入时考虑费用"><a href="#解法-I-买入时考虑费用" class="headerlink" title="解法 I : 买入时考虑费用"></a>解法 I : 买入时考虑费用</h6><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxProfit</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; prices)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> T_k0 = <span class="number">0</span>, T_k1 = INT_MIN;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> price : prices) &#123;</span><br><span class="line">            <span class="keyword">int</span> T_k0_old = T_k0;</span><br><span class="line">            T_k0 = <span class="built_in">max</span>(T_k0, T_k1 + price);</span><br><span class="line">            T_k1 = <span class="built_in">max</span>(T_k1, T_k0_old - price - fee);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> T_k0;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h6 id="解法-II-：卖出时考虑费用"><a href="#解法-II-：卖出时考虑费用" class="headerlink" title="解法 II ：卖出时考虑费用"></a>解法 II ：卖出时考虑费用</h6><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxProfit</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; prices)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> T_k0 = <span class="number">0</span>, T_k1 = INT_MIN;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> price : prices) &#123;</span><br><span class="line">            <span class="keyword">int</span> T_k0_old = T_k0;</span><br><span class="line">            T_k0 = <span class="built_in">max</span>(T_k0, T_k1 + price - fee);</span><br><span class="line">            T_k1 = <span class="built_in">max</span>(T_k1, T_k0_old - price);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> T_k0;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h5 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h5><p>对于这一类股票交易相关的问题，动态规划均可求解。</p><p>重点需要关注：</p><ul><li><p>交易日期 <code>i</code></p></li><li><p>最大允许交易次数 <code>k</code></p></li><li><p>每天能有的状态</p></li></ul><p>只要我们弄清楚每天这些状态之间的转移关系，就可以轻松 solve 这一系列问题。同时，弄清楚状态转移关系，还能对空间复杂度进行优化，不再需要使用一个数组去保留每天交易状态的最值。</p>]]></content>
      
      
      <categories>
          
          <category> Algorithm </category>
          
          <category> Dynamic Program </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Leetcode </tag>
            
            <tag> DP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Self Introduction</title>
      <link href="/2022/01/15/self-introduction/"/>
      <url>/2022/01/15/self-introduction/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="499bd81e3739cec7f20344df8f07fc31580b079f6ebb95c1db81d42c3cece553">68a8c3278477baad47ac774912504a9c1bfd1ffdfa94ee256f03556bd03862034cac0e1195b211f513967ad3603a1e467416ec93d1bfeb239465f963cfa2593d4d1851c03907f3dfa769a26099aa688bd6a9c306381083e77a667906c5e12bdf4e30f7c39bcfc8c2d4f11c5bab3e6bcd4e17557281d8abee8f276d96ac7db87abde9e6b7ca12d3178edba6e9c407c9bd3627ee1f814388c6c16cac367c037141259d46b4513948398f4df629227e6498a823392caad5d69ea132e045b3c586fb74323ff44d7ae78ad0952445d2ecaffd3fdf5167d2a23c9907fdac6332a2e4acbe6e1157c0b6c47ec4af1bf3421de776d1a05a023e1de8f67ab4ee331add67d6d52293323a782aa08545876a7646c6ab45c8954d2e0ee99104c4f0a5557ce4f61a56ed25da2a6979ed2457409e769b4806ec2d3e1ceb1735ead6ef9f84ce2fc538ba15198e029d197e775b2465082023758d23093636309f9e4f56523ad4e860c9b98da884f4ed0f8611fbc056c7b00b0016fcbb7d8a621d39d3968b755e17ad77ccbef0c928ac6c0799f24f5916072cb13ae85947f33a907cd0b60242a4eb9fc023f73305d62846ffccb079baa265688ce39e3c8616e8978f7e0bd8144ccc9be4713715c6286bea0332ebb8e29383889ecac5adac5d205d1dfd8b736962c6d94143faa6b2fe6893b0466fb0a2714ff101d2e51fc7212788e61730c55f3a06d472e302cdc42222fa477076ef3ed220138a2036bad7f6af3eee46100712e7d26ef045d656ffd087aa7dd7c721d272e314b416da596d24d45f7d28a17af5a3b8441fd6d6198a7a0d5b0d4724a06dcf33ba4774096efa037650dac307f347d456cc4be59a544897971ba15cb38bcc2409118addebf22bdd738f789e53b7cfa7be89d539cb11ad5c04896925b9c60c75f1c15e1bac2245afa6e1245be3cd95becef7af343be779d07d9f4881e7a9c3d8a96369cb16d2158c1d936d2dcd45b8ec84bb9b8bc233e91d013a5ce9a786eb75fc2575a711afed0d8b983c1e149805849d2e799e01ca4ed7eb674a6957002a24d288c2c012906026a02c9e856dc308d58326aa5dab0548c292123fb9d9576026fbca2d6331a1ea40926d2ce6dd616b7aeb6a7cc907a88301144a16ebd7c8b8c2ec8472276dd16ca0c69143df5ab38ca8a712d6083e5007a27087925a6fe1e37f2a21</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">需要密码辅助查验</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> Resume </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Resume </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>搭建 Hexo 博客</title>
      <link href="/2022/01/14/%E6%90%AD%E5%BB%BAHexo-blog/"/>
      <url>/2022/01/14/%E6%90%AD%E5%BB%BAHexo-blog/</url>
      
        <content type="html"><![CDATA[<h4 id="Mac-安装-Node-js">Mac 安装 Node.js</h4><ul><li>最常用的方法是通过 Homebrew 进行 Node.js 和 npm 的安装。常用指令</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 更新与安装 node</span></span><br><span class="line">brew update</span><br><span class="line">brew install node</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 检查安装版本</span></span><br><span class="line">brew list</span><br><span class="line">node -v</span><br><span class="line">npm -v</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 删除 node</span></span><br><span class="line">brew uninstall node</span><br></pre></td></tr></table></figure><h4 id="安装-Hexo">安装 Hexo</h4><ul><li>使用 npm 命令安装 Hexo</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo-cli </span><br><span class="line"><span class="meta">#</span><span class="bash"> 或者安装 懒人包</span></span><br><span class="line">npm install -g hexo</span><br></pre></td></tr></table></figure><h4 id="初始化-Hexo">初始化 Hexo</h4><ol><li><p>初始化一个 directory: <code>mkdir ~/hexo/dir &amp;&amp; cd ~/hexo/dir</code></p></li><li><p>初始化博客：<code>hexo init</code></p></li><li><p>静态编译博客 : <code>hexo g</code> \ <code>hexo generate</code></p></li><li><p>离线检查博客效果：<code>hexo s</code>\ <code>hexo server</code> 可以通过访问  <code>http://localhost:4000/</code> 本地检查效果</p></li><li><p>修改 config 文件，路径在 <code>~/hexo/dir/_config.yml</code>，需要修改</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">deploy:</span></span><br><span class="line"> <span class="attr">type :</span> <span class="string">git</span></span><br><span class="line"> <span class="attr">repository:</span> <span class="string">git@github.com:username/username.github.io.git</span></span><br><span class="line"> <span class="attr">branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure></li><li><p>推到线上 <code>hexo d</code> \ <code>hexo deploy (-m message)</code></p></li></ol><h4 id="写博客并推到线上">写博客并推到线上</h4><ol><li><p>新建博客：<code>hexo n &quot;your title&quot;</code>\ <code>hexo new &quot;your title&quot;</code></p></li><li><p>进入相应路径修改 md 文件(写博客)： <code>cd ~/hexo/dir/source/_posts/your title.md</code></p></li><li><p>静态编译博客 : <code>hexo g</code> \ <code>hexo generate</code></p></li><li><p>离线检查博客效果：<code>hexo s</code>\ <code>hexo server</code> 可以通过访问 <code>http://localhost:4000/</code> 本地检查效果</p></li><li><p>推到线上 <code>hexo d</code> \ <code>hexo deploy (-m message)</code></p></li></ol><h4 id="个性化-Hexo-博客">个性化 Hexo 博客</h4><ul><li>参考：<a href="https://butterfly.js.org/posts/dc584b87/">Butterfly 安裝文檔</a></li></ul><h5 id="如何对每一篇-post-做相应的修改？">如何对每一篇 post 做相应的修改？</h5><p>可参考 <a href="https://blog.csdn.net/qq_43857095/article/details/108306164"># Hexo butterfly 自定义文章封面 &amp;&amp; 主页顶部图片更改</a></p><p>比较重要的几个参数：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">title:</span> <span class="string">Hexo</span> <span class="string">Blog</span></span><br><span class="line"><span class="attr">tags:</span> [<span class="string">Hexo</span>, <span class="string">Nodejs</span>, <span class="string">git</span>] <span class="comment"># 或者用 - 隔行分隔</span></span><br><span class="line"><span class="attr">categories:</span> <span class="string">Hexo</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">对这篇</span> <span class="string">blog</span> <span class="string">的描述</span></span><br><span class="line"><span class="attr">top_img:</span> <span class="string">/img/avocado.jpeg</span> <span class="comment"># 头部图片</span></span><br><span class="line"><span class="attr">comments:</span> <span class="literal">true</span> <span class="comment"># 是否现实评论</span></span><br><span class="line"><span class="attr">cover:</span> <span class="string">/img/hashtag.jpeg</span> <span class="comment"># 封面图片</span></span><br></pre></td></tr></table></figure><p>如果没有 pug 以及 stylus 的渲染器，请下载安装：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-renderer-pug hexo-renderer-stylus --save</span><br></pre></td></tr></table></figure><h5 id="如何自动生成-categories-页或者-tags-页？">如何自动生成 categories 页或者 tags 页？</h5><ol><li><p>创建 categories page 或者 tags page，这时会在 source 文件夹下生成相应子文件夹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo new page categories</span><br><span class="line">hexo new page tags</span><br></pre></td></tr></table></figure></li><li><p>在相应的子文件夹中会生成 <code>index.md</code> 文件, 修改 <a href="http://index.md">index.md</a> 中的头文件配置如下</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">    <span class="attr">title:</span> <span class="string">categories</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2022-01-14 20:10:25</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">&quot;categories&quot;</span></span><br><span class="line"><span class="attr">cover:</span> <span class="string">/img/category.png</span></span><br><span class="line"><span class="attr">top_img:</span> <span class="string">/img/category.png</span></span><br></pre></td></tr></table></figure></li><li><p>修改 <code>_config.butterfly.yml</code> 文件中的以下 command</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">aside:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">hide:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">button:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">mobile:</span> <span class="literal">true</span> <span class="comment"># display on mobile</span></span><br><span class="line">  <span class="attr">position:</span> <span class="string">right</span> <span class="comment"># left or right</span></span><br><span class="line">  <span class="attr">card_author:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">description:</span></span><br><span class="line">    <span class="attr">button:</span></span><br><span class="line">      <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">icon:</span> <span class="string">fab</span> <span class="string">fa-github</span></span><br><span class="line">      <span class="attr">text:</span> <span class="string">My</span> <span class="string">Github</span></span><br><span class="line">      <span class="attr">link:</span> <span class="string">https://github.com/Jason24-Zeng/Jason24-Zeng.github.io/tree/main</span></span><br><span class="line">  <span class="attr">card_announcement:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">content:</span> <span class="string">This</span> <span class="string">is</span> <span class="string">my</span> <span class="string">Blog</span></span><br><span class="line">  <span class="attr">card_recent_post:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">limit:</span> <span class="number">5</span> <span class="comment"># if set 0 will show all</span></span><br><span class="line">    <span class="attr">sort:</span> <span class="string">date</span> <span class="comment"># date or updated</span></span><br><span class="line">    <span class="attr">sort_order:</span> <span class="comment"># Don&#x27;t modify the setting unless you know how it works</span></span><br><span class="line">  <span class="attr">card_categories:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">limit:</span> <span class="number">8</span> <span class="comment"># if set 0 will show all</span></span><br><span class="line">    <span class="attr">expand:</span> <span class="literal">false</span> <span class="comment"># none/true/false</span></span><br><span class="line">    <span class="attr">sort_order:</span> <span class="comment"># Don&#x27;t modify the setting unless you know how it works</span></span><br><span class="line">  <span class="attr">card_tags:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">limit:</span> <span class="number">40</span> <span class="comment"># if set 0 will show all</span></span><br><span class="line">    <span class="attr">color:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">sort_order:</span> <span class="comment"># Don&#x27;t modify the setting unless you know how it works</span></span><br><span class="line">  <span class="attr">card_archives:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">monthly</span> <span class="comment"># yearly or monthly</span></span><br><span class="line">    <span class="attr">format:</span> <span class="string">MMMM</span> <span class="string">YYYY</span> <span class="comment"># eg: YYYY年MM月</span></span><br><span class="line">    <span class="attr">order:</span> <span class="number">-1</span> <span class="comment"># Sort of order. 1, asc for ascending; -1, desc for descending</span></span><br><span class="line">    <span class="attr">limit:</span> <span class="number">8</span> <span class="comment"># if set 0 will show all</span></span><br><span class="line">    <span class="attr">sort_order:</span> <span class="comment"># Don&#x27;t modify the setting unless you know how it works</span></span><br><span class="line">  <span class="attr">card_webinfo:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">post_count:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">last_push_date:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">sort_order:</span> <span class="comment"># Don&#x27;t modify the setting unless you know how it works</span></span><br></pre></td></tr></table></figure></li><li><p>执行以下执行更新 blog</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> Blog </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
